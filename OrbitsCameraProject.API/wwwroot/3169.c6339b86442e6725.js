"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[3169],{3169:(Mt,_,r)=>{r.r(_),r.d(_,{BranchManagerListComponent:()=>Ct});var l=r(8728),g=r(2200),x=r(8132),b=r(980),c=r(645),u=r(357),v=r(8018),k=r(6053),y=r(6848),P=r(8937),j=r(2709),I=r(7509),B=r(9331),w=r(7753),C=r(9183),m=r(1161),M=r(8834),D=r(7880),O=r(8223),t=r(3664),E=r(9010);const $=()=>({maxHeight:"calc(100vh - 155px)",position:"relative"});function T(n,i){1&n&&(t.j41(0,"div",8),t.nrm(1,"mat-spinner",9),t.j41(2,"div",10),t.EFF(3,"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0645\u062f\u064a\u0631 \u0627\u0644\u0641\u0631\u0639..."),t.k0s()())}function A(n,i){1&n&&t.nrm(0,"i",37)}function N(n,i){if(1&n){const e=t.RV6();t.j41(0,"a",31),t.bIt("click",function(o){return l.eBV(e),l.Njj(o.stopPropagation())}),t.j41(1,"div",32),t.nrm(2,"i"),t.k0s(),t.j41(3,"div",33)(4,"div",34),t.EFF(5),t.k0s(),t.j41(6,"div",35),t.EFF(7),t.k0s()(),t.DNE(8,A,1,0,"i",36),t.k0s()}if(2&n){const e=i.$implicit;t.AVh("is-link",!!e.href),t.Y8G("href",e.href||null,t.B4B),t.R7$(2),t.HbH(e.icon),t.R7$(3),t.JRh(e.label),t.R7$(2),t.JRh(e.value||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631"),t.R7$(),t.Y8G("ngIf",e.href)}}function G(n,i){if(1&n&&(t.j41(0,"section",23)(1,"div",24),t.nrm(2,"i",28),t.EFF(3," \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062a\u0648\u0627\u0635\u0644 "),t.k0s(),t.j41(4,"div",29),t.DNE(5,N,9,8,"a",30),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",e.contactEntries)}}function L(n,i){if(1&n&&(t.j41(0,"div",41)(1,"div",42),t.EFF(2),t.k0s(),t.j41(3,"div",43),t.EFF(4),t.k0s()()),2&n){const e=i.$implicit;t.R7$(2),t.JRh(e.label),t.R7$(2),t.JRh(e.value||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631")}}function S(n,i){if(1&n&&(t.j41(0,"section",23)(1,"div",24),t.nrm(2,"i",38),t.EFF(3," \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0623\u0633\u0627\u0633\u064a\u0629 "),t.k0s(),t.j41(4,"div",39),t.DNE(5,L,5,2,"div",40),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",e.detailEntries)}}function z(n,i){if(1&n){const e=t.RV6();t.j41(0,"a",52),t.bIt("click",function(o){return l.eBV(e),l.Njj(o.stopPropagation())}),t.nrm(1,"i",53),t.j41(2,"span"),t.EFF(3,"\u0648\u0627\u062a\u0633\u0627\u0628"),t.k0s()()}if(2&n){const e=t.XpG().$implicit,a=t.XpG(3);t.Y8G("href",a.buildWhatsAppLink(e.mobile),t.B4B)}}function Y(n,i){if(1&n&&(t.j41(0,"div",47)(1,"div",48)(2,"div",49),t.EFF(3),t.k0s(),t.j41(4,"div",50),t.EFF(5),t.k0s()(),t.DNE(6,z,4,1,"a",51),t.k0s()),2&n){const e=i.$implicit;t.R7$(3),t.JRh(e.fullName||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631"),t.R7$(2),t.JRh(e.mobile||"\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0642\u0645 \u062c\u0648\u0627\u0644"),t.R7$(),t.Y8G("ngIf",e.mobile)}}function J(n,i){if(1&n&&(t.j41(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),t.EFF(3," \u0627\u0644\u0645\u0639\u0644\u0645\u0648\u0646 "),t.j41(4,"span",44),t.EFF(5),t.k0s()()(),t.j41(6,"div",45),t.DNE(7,Y,7,3,"div",46),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(5),t.JRh(e.teachers.length),t.R7$(2),t.Y8G("ngForOf",e.teachers)}}function V(n,i){if(1&n){const e=t.RV6();t.j41(0,"a",52),t.bIt("click",function(o){return l.eBV(e),l.Njj(o.stopPropagation())}),t.nrm(1,"i",53),t.j41(2,"span"),t.EFF(3,"\u0648\u0627\u062a\u0633\u0627\u0628"),t.k0s()()}if(2&n){const e=t.XpG().$implicit,a=t.XpG(3);t.Y8G("href",a.buildWhatsAppLink(e.mobile),t.B4B)}}function X(n,i){if(1&n&&(t.j41(0,"div",47)(1,"div",48)(2,"div",49),t.EFF(3),t.k0s(),t.j41(4,"div",50),t.EFF(5),t.k0s()(),t.DNE(6,V,4,1,"a",51),t.k0s()),2&n){const e=i.$implicit;t.R7$(3),t.JRh(e.fullName||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631"),t.R7$(2),t.JRh(e.mobile||"\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0642\u0645 \u062c\u0648\u0627\u0644"),t.R7$(),t.Y8G("ngIf",e.mobile)}}function W(n,i){if(1&n&&(t.j41(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),t.EFF(3," \u0627\u0644\u0637\u0644\u0627\u0628 "),t.j41(4,"span",44),t.EFF(5),t.k0s()()(),t.j41(6,"div",45),t.DNE(7,X,7,3,"div",46),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(5),t.JRh(e.students.length),t.R7$(2),t.Y8G("ngForOf",e.students)}}function H(n,i){if(1&n&&(t.j41(0,"div",47)(1,"div",48)(2,"div",49),t.EFF(3),t.k0s()()()),2&n){const e=i.$implicit;t.R7$(3),t.JRh(e.circle||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631")}}function Q(n,i){if(1&n&&(t.j41(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),t.EFF(3," \u0627\u0644\u062d\u0644\u0642\u0627\u062a "),t.j41(4,"span",44),t.EFF(5),t.k0s()()(),t.j41(6,"div",45),t.DNE(7,H,4,1,"div",46),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(5),t.JRh(e.managerCircles.length),t.R7$(2),t.Y8G("ngForOf",e.managerCircles)}}function U(n,i){if(1&n&&(t.j41(0,"app-scrollbar",11)(1,"div",12)(2,"section",13)(3,"div",14)(4,"div",15),t.nrm(5,"i",16),t.k0s(),t.j41(6,"div",17)(7,"div",18),t.EFF(8),t.k0s(),t.j41(9,"div",19)(10,"span",20),t.nrm(11,"i",21),t.EFF(12),t.k0s()()()()(),t.DNE(13,G,6,1,"section",22)(14,S,6,1,"section",22),t.j41(15,"section",23)(16,"div",24),t.nrm(17,"i",25),t.EFF(18," \u0627\u0644\u0627\u0631\u062a\u0628\u0627\u0637\u0627\u062a "),t.k0s(),t.j41(19,"mat-accordion",26),t.DNE(20,J,8,2,"mat-expansion-panel",27)(21,W,8,2,"mat-expansion-panel",27)(22,Q,8,2,"mat-expansion-panel",27),t.k0s()()()()),2&n){const e=i.ngIf,a=t.XpG();t.Y8G("customStyle",t.lJ4(8,$)),t.R7$(8),t.JRh(e.fullName||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631"),t.R7$(4),t.SpI(" ",a.getBranchLabel(e.branchId)||"\u0641\u0631\u0639 \u063a\u064a\u0631 \u0645\u062d\u062f\u062f"," "),t.R7$(),t.Y8G("ngIf",a.contactEntries.length),t.R7$(),t.Y8G("ngIf",a.detailEntries.length),t.R7$(6),t.Y8G("ngIf",a.teachers.length),t.R7$(),t.Y8G("ngIf",a.students.length),t.R7$(),t.Y8G("ngIf",a.managerCircles.length)}}let K=(()=>{class n{constructor(){this.loading=!0,this.teachers=[],this.students=[],this.managerCircles=[],this.contactEntries=[],this.detailEntries=[],this.Branch=[{id:O.E.Mens,label:"\u0627\u0644\u0631\u062c\u0627\u0644"},{id:O.E.Women,label:"\u0627\u0644\u0646\u0633\u0627\u0621"}],this.labelMap={id:"\u0627\u0644\u0645\u0639\u0631\u0651\u0641",fullName:"\u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u0643\u0627\u0645\u0644",email:"\u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0625\u0644\u0643\u062a\u0631\u0648\u0646\u064a",mobile:"\u0631\u0642\u0645 \u0627\u0644\u062c\u0648\u0627\u0644",secondMobile:"\u062c\u0648\u0627\u0644 \u0625\u0636\u0627\u0641\u064a",nationality:"\u0627\u0644\u062c\u0646\u0633\u064a\u0629",nationalityId:"\u0645\u0639\u0631\u0651\u0641 \u0627\u0644\u062c\u0646\u0633\u064a\u0629",resident:"\u0627\u0644\u0625\u0642\u0627\u0645\u0629",residentId:"\u0645\u0639\u0631\u0651\u0641 \u0627\u0644\u0625\u0642\u0627\u0645\u0629",governorate:"\u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629",governorateId:"\u0645\u0639\u0631\u0651\u0641 \u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629",branchId:"\u0627\u0644\u0641\u0631\u0639",teacherId:"\u0645\u0639\u0631\u0651\u0641 \u0627\u0644\u0645\u0639\u0644\u0645",teacherName:"\u0627\u0633\u0645 \u0627\u0644\u0645\u0639\u0644\u0645",managerId:"\u0645\u0639\u0631\u0651\u0641 \u0627\u0644\u0645\u0634\u0631\u0641",managerName:"\u0627\u0633\u0645 \u0627\u0644\u0645\u0634\u0631\u0641",circleId:"\u0645\u0639\u0631\u0651\u0641 \u0627\u0644\u062d\u0644\u0642\u0629",circleName:"\u0627\u0633\u0645 \u0627\u0644\u062d\u0644\u0642\u0629",inactive:"\u0627\u0644\u062d\u0627\u0644\u0629"};const e=(0,l.WQX)(u.e);this.setData(e&&"object"==typeof e&&"data"in e?e.data:e)}setData(e){if(this.vm=void 0,this.loading=!e,this.teachers=[],this.students=[],this.managerCircles=[],this.contactEntries=[],this.detailEntries=[],!e)return;this.vm=e,this.loading=!1,this.teachers=Array.isArray(e.teachers)?e.teachers:[],this.students=Array.isArray(e.students)?e.students:[],this.managerCircles=Array.isArray(e.managerCircles)?e.managerCircles:[],this.contactEntries=["email","mobile","secondMobile"].map(s=>{const p=(e[s]??"").toString().trim();if(!p)return null;const h=this.getContactIcon(s);return{key:s,label:this.labelMap[s]??this.humanizeKey(s),value:p,icon:h,href:"email"===s?`mailto:${p}`:"mobile"===s||"secondMobile"===s?this.buildWhatsAppLink(p):void 0}}).filter(Boolean);const o=new Set(["teachers","students","managers","managerCircles","email","mobile","secondMobile","fullName","residentId","governorateId","teacherId","managerId","teacherName","managerName","circleName","nationalityId","residentId","governorateId","teacherId","managerId","circleId","id","inactive","identityNumber","branchId"]),d=["nationality","resident","governorate"],F=Object.entries(e).filter(([s])=>!o.has(s)).filter(([,s])=>null!=s).filter(([,s])=>"object"!=typeof s&&!Array.isArray(s)).map(([s,p])=>({key:s,label:this.labelMap[s]??this.humanizeKey(s),value:this.formatValue(s,p)}));this.detailEntries=F.sort((s,p)=>{const h=d.indexOf(s.key),f=d.indexOf(p.key);return(-1===h?999:h)-(-1===f?999:f)})}getBranchLabel(e){const a=this.Branch.find(o=>o.id===e);return a?a.label:null==e?"\u2014":String(e)}formatValue(e,a){return"inactive"===e?a?"\u063a\u064a\u0631 \u0646\u0634\u0637":"\u0646\u0634\u0637":String(a)}humanizeKey(e){return e.replace(/([A-Z])/g," $1").replace(/_/g," ").trim()}getContactIcon(e){return{email:"ti ti-mail",mobile:"ti ti-brand-whatsapp",secondMobile:"ti ti-brand-whatsapp"}[e]??"ti ti-circle"}buildWhatsAppLink(e){const a=e.replace(/[^\d]/g,"");return a?`https://wa.me/${a}`:void 0}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-branch-manager-details"]],decls:9,vars:2,consts:[["mat-dialog-title","",1,"dialog-head"],[1,"head-row"],[1,"title"],["mat-icon-button","","mat-dialog-close","","aria-label","\u0625\u063a\u0644\u0627\u0642",1,"close-btn"],[1,"ti","ti-x"],[1,"dialog-content"],["class","loading-state",4,"ngIf"],[3,"customStyle",4,"ngIf"],[1,"loading-state"],["diameter","48"],[1,"loading-text"],[3,"customStyle"],[1,"wrap"],[1,"card","hero"],[1,"hero-left"],[1,"avatar"],[1,"ti","ti-user"],[1,"hero-meta"],[1,"name"],[1,"sub"],[1,"pill"],[1,"ti","ti-building-store"],["class","card",4,"ngIf"],[1,"card"],[1,"card-title"],[1,"ti","ti-list-details"],[1,"acc"],[4,"ngIf"],[1,"ti","ti-address-book"],[1,"contact-grid"],["class","contact-item",3,"href","is-link","click",4,"ngFor","ngForOf"],[1,"contact-item",3,"click","href"],[1,"c-ico"],[1,"c-body"],[1,"c-label"],[1,"c-value"],["class","ti ti-external-link hint",4,"ngIf"],[1,"ti","ti-external-link","hint"],[1,"ti","ti-id"],[1,"kv-grid"],["class","kv",4,"ngFor","ngForOf"],[1,"kv"],[1,"k"],[1,"v"],[1,"count"],[1,"rows"],["class","row",4,"ngFor","ngForOf"],[1,"row"],[1,"row-main"],[1,"row-title"],[1,"row-sub"],["class","row-action",3,"href","click",4,"ngIf"],[1,"row-action",3,"click","href"],[1,"ti","ti-brand-whatsapp"]],template:function(a,o){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3,"\u062a\u0641\u0627\u0635\u064a\u0644 \u0645\u062f\u064a\u0631 \u0627\u0644\u0641\u0631\u0639"),t.k0s(),t.j41(4,"button",3),t.nrm(5,"i",4),t.k0s()()(),t.j41(6,"mat-dialog-content",5),t.DNE(7,T,4,0,"div",6)(8,U,23,9,"app-scrollbar",7),t.k0s()),2&a&&(t.R7$(7),t.Y8G("ngIf",o.loading),t.R7$(),t.Y8G("ngIf",!o.loading&&o.vm))},dependencies:[g.MD,g.Sq,g.bT,u.l,u.a,u.b,u.c,C.D6,C.LG,M.Hl,E.M,m.MY,m.BS,m.GK,m.Z2,m.WN,D.o],styles:['@charset "UTF-8";[_nghost-%COMP%]{direction:rtl;text-align:right;--text-primary: #111827;--text-secondary: #6b7280;--card-bg: #ffffff;--muted-bg: #fafafa;--border-color: #e5e7eb;--divider-color: #f1f1f1;--accent-border: #ececec}.dark[_nghost-%COMP%], .dark   [_nghost-%COMP%], [data-theme=dark][_nghost-%COMP%], [data-theme=dark]   [_nghost-%COMP%]{--text-primary: #f3f4f6;--text-secondary: #9ca3af;--card-bg: #0f172a;--muted-bg: #111827;--border-color: #1f2937;--divider-color: #1f2937;--accent-border: #1f2937}.dialog-head[_ngcontent-%COMP%]{padding:14px 16px}.head-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px}.title[_ngcontent-%COMP%]{font-weight:900;font-size:16px;color:var(--text-primary)}.close-btn[_ngcontent-%COMP%]{width:38px;height:38px;border-radius:10px}.close-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}.dialog-content[_ngcontent-%COMP%]{padding:0}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;padding:40px 20px;color:var(--text-secondary)}.loading-state[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{font-weight:800;font-size:14px}.wrap[_ngcontent-%COMP%]{padding:14px}.card[_ngcontent-%COMP%]{background:var(--card-bg);border:1px solid var(--border-color);border-radius:14px;padding:14px;margin-bottom:12px;box-shadow:0 6px 18px #0000000a}.card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-weight:900;font-size:14px;margin-bottom:12px;color:var(--text-primary)}.card-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}.hero[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:12px}.hero-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.avatar[_ngcontent-%COMP%]{width:54px;height:54px;border-radius:16px;border:1px solid var(--accent-border);display:grid;place-items:center}.avatar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:22px}.hero-meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:16px;font-weight:900;line-height:1.2;color:var(--text-primary)}.sub[_ngcontent-%COMP%]{margin-top:8px;display:flex;flex-wrap:wrap;gap:8px}.pill[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--border-color);font-size:12px;font-weight:800;background:var(--muted-bg)}.pill[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.pill.is-inactive[_ngcontent-%COMP%]{border-color:#ffd8d8;background:#fff5f5}.hero-right[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}.mini[_ngcontent-%COMP%]{border:1px dashed var(--border-color);border-radius:12px;padding:10px;background:var(--muted-bg)}.mini-k[_ngcontent-%COMP%]{font-size:11px;font-weight:900;color:var(--text-secondary);margin-bottom:6px}.mini-v[_ngcontent-%COMP%]{font-size:12px;font-weight:800;word-break:break-word;color:var(--text-primary)}.contact-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:10px}.contact-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px;border:1px solid var(--border-color);border-radius:12px;text-decoration:none;color:inherit;background:var(--card-bg);transition:background .15s ease,transform .15s ease,box-shadow .15s ease}.contact-item.is-link[_ngcontent-%COMP%]{cursor:pointer}.contact-item[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 10px 20px #0f172a0f}.c-ico[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:12px;border:1px solid var(--border-color);display:grid;place-items:center}.c-ico[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}.c-body[_ngcontent-%COMP%]{flex:1;min-width:0}.c-label[_ngcontent-%COMP%]{font-size:11px;font-weight:900;color:var(--text-secondary);margin-bottom:4px}.c-value[_ngcontent-%COMP%]{font-size:13px;font-weight:800;color:var(--text-primary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.hint[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:16px}.kv-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}.kv[_ngcontent-%COMP%]{border:1px solid var(--border-color);border-radius:12px;padding:10px;background:var(--card-bg)}.k[_ngcontent-%COMP%]{font-size:11px;font-weight:900;color:var(--text-secondary);margin-bottom:6px}.v[_ngcontent-%COMP%]{font-size:13px;font-weight:800;color:var(--text-primary);word-break:break-word}.acc[_ngcontent-%COMP%]{margin-top:6px}.count[_ngcontent-%COMP%]{margin-right:8px;font-size:11px;font-weight:900;padding:2px 8px;border-radius:999px;border:1px solid var(--border-color);background:var(--muted-bg)}.rows[_ngcontent-%COMP%]{padding:6px 0 10px}.row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 0;border-bottom:1px solid var(--divider-color)}.row[_ngcontent-%COMP%]:last-child{border-bottom:none}.row-main[_ngcontent-%COMP%]{flex:1 1 auto;min-width:0}.row-title[_ngcontent-%COMP%]{font-weight:900;font-size:13px;color:var(--text-primary)}.row-sub[_ngcontent-%COMP%]{font-weight:800;font-size:12px;color:var(--text-secondary);margin-top:4px}.row-action[_ngcontent-%COMP%]{flex:0 0 auto;display:inline-flex;align-items:center;gap:6px;font-weight:900;font-size:12px;padding:7px 10px;border-radius:10px;border:1px solid var(--border-color);background:var(--muted-bg);text-decoration:none;color:var(--text-primary);white-space:nowrap}.row-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}@media (max-width: 768px){.wrap[_ngcontent-%COMP%]{padding:12px}.hero[_ngcontent-%COMP%]{gap:10px}.hero-left[_ngcontent-%COMP%]{align-items:flex-start}.hero-right[_ngcontent-%COMP%]{grid-template-columns:1fr}.card[_ngcontent-%COMP%]{padding:12px}.row[_ngcontent-%COMP%]{align-items:flex-start;flex-direction:column}.row-action[_ngcontent-%COMP%]{align-self:flex-start}}@media (max-width: 480px){.title[_ngcontent-%COMP%]{font-size:15px}.wrap[_ngcontent-%COMP%]{padding:10px}.kv-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.avatar[_ngcontent-%COMP%]{width:48px;height:48px}.hero-meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:15px}.card-title[_ngcontent-%COMP%]{font-size:13px}.row-title[_ngcontent-%COMP%]{font-size:12.5px}.row-sub[_ngcontent-%COMP%]{font-size:11.5px}}']})}return n})();var Z=r(3746),q=r(4507),tt=r(5747),et=r(6735);const nt=["loadMoreTrigger"],at=()=>["/online-course/branch-manager/add"],it=n=>["/online-course/branch-manager/edit",n],ot=n=>({user:n}),rt=n=>({value:n});function st(n,i){1&n&&(t.j41(0,"div",29)(1,"button",30)(2,"div",31),t.nrm(3,"i",32),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()),2&n&&(t.R7$(),t.Y8G("routerLink",t.lJ4(4,at)),t.R7$(3),t.SpI(" ",t.bMT(5,2,"Add Branch Manager")," "))}function lt(n,i){1&n&&(t.j41(0,"th",33),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Name")))}function ct(n,i){if(1&n&&(t.j41(0,"td",34),t.EFF(1),t.k0s()),2&n){const e=i.$implicit;t.R7$(),t.JRh(e.fullName)}}function dt(n,i){1&n&&(t.j41(0,"th",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Email")))}function pt(n,i){if(1&n&&(t.j41(0,"td",36),t.EFF(1),t.k0s()),2&n){const e=i.$implicit;t.R7$(),t.JRh(e.email)}}function ut(n,i){1&n&&(t.j41(0,"th",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Mobile")))}function mt(n,i){if(1&n&&(t.j41(0,"td",36),t.EFF(1),t.k0s()),2&n){const e=i.$implicit;t.R7$(),t.JRh(e.mobile)}}function gt(n,i){1&n&&(t.j41(0,"th",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Nationality")))}function ht(n,i){if(1&n&&(t.j41(0,"td",36),t.EFF(1),t.k0s()),2&n){const e=i.$implicit;t.R7$(),t.JRh(e.nationality)}}function ft(n,i){1&n&&(t.j41(0,"th",37),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Actions")))}function _t(n,i){if(1&n){const e=t.RV6();t.j41(0,"td",36)(1,"div",38)(2,"ul",39)(3,"li",40),t.nI1(4,"translate"),t.bIt("click",function(){const o=l.eBV(e).$implicit,d=t.XpG();return l.Njj(d.branchManagerDetails(o))}),t.j41(5,"a",41),t.nrm(6,"i",42),t.k0s()(),t.j41(7,"li",43),t.nI1(8,"translate"),t.j41(9,"a",44),t.nrm(10,"i",45),t.k0s()(),t.j41(11,"li",43),t.nI1(12,"translate"),t.j41(13,"a",46),t.bIt("click",function(){const o=l.eBV(e).$implicit,d=t.XpG();return l.Njj(d.confirmDisable(o))}),t.nrm(14,"i",47),t.k0s()()()()()}if(2&n){const e=i.$implicit,a=t.XpG();t.R7$(3),t.Y8G("matTooltip",t.bMT(4,6,"\u0639\u0631\u0636")),t.R7$(4),t.Y8G("matTooltip",t.bMT(8,8,"\u062a\u0639\u062f\u064a\u0644")),t.R7$(2),t.Y8G("routerLink",t.eq3(12,it,e.id))("state",t.eq3(14,ot,e)),t.R7$(2),t.Y8G("matTooltip",t.bMT(12,10,"\u062d\u0630\u0641")),t.R7$(2),t.Y8G("disabled",a.isProcessing(e.id))}}function xt(n,i){1&n&&t.nrm(0,"tr",48)}function bt(n,i){1&n&&t.nrm(0,"tr",49)}function vt(n,i){if(1&n&&(t.j41(0,"tr",50)(1,"td",51),t.EFF(2),t.nI1(3,"translate"),t.k0s()()),2&n){t.XpG();const e=t.sdS(12);t.R7$(2),t.SpI(" ",t.i5U(3,1,'No data matching the filter "{{ value }}"',t.eq3(4,rt,e.value))," ")}}let Ct=(()=>{class n{constructor(){this.lookupService=(0,l.WQX)(y.s),this.userService=(0,l.WQX)(j.D),this.toast=(0,l.WQX)(I.f),this.translate=(0,l.WQX)(v.c$),this.dialog=(0,l.WQX)(u.h),this.isLoading=!1,this.displayedColumns=["fullName","email","mobile","nationality","action"],this.dataSource=new c.I6,this.totalCount=0,this.filter={skipCount:0,maxResultCount:10},this.pageIndex=0,this.pageSize=10,this.pendingBranchManagerIds=new Set,this.isLoadingMore=!1}set loadMoreTrigger(e){this.loadMoreElement=e,this.setupIntersectionObserver()}applyFilter(e){this.filter.searchTerm=e.target.value.trim().toLowerCase(),this.pageIndex=0,this.filter.skipCount=0,this.loadBranchManagers()}ngOnInit(){this.loadBranchManagers()}ngOnDestroy(){this.intersectionObserver?.disconnect()}loadBranchManagers(e=!1){this.isLoading=!e,this.isLoadingMore=e,this.lookupService.getUsersForSelects(this.filter,Number(P.m.BranchLeader),0,0,0).pipe((0,b.j)(()=>{this.isLoading=!1,this.isLoadingMore=!1})).subscribe({next:a=>{a.isSuccess&&a.data?.items?(this.dataSource.data=e?[...this.dataSource.data,...a.data.items]:a.data.items,this.totalCount=a.data.totalCount):(e||(this.dataSource.data=[]),this.totalCount=0)},error:()=>{e||(this.dataSource.data=[]),this.totalCount=0}})}confirmDisable(e){this.isProcessing(e.id)||this.dialog.open(B.x,{data:{fullName:e.fullName}}).afterClosed().subscribe(o=>{o&&this.disableBranchManager(e)})}isProcessing(e){return this.pendingBranchManagerIds.has(e)}disableBranchManager(e){this.pendingBranchManagerIds.has(e.id)||(this.pendingBranchManagerIds.add(e.id),this.userService.disableUser(e.id,!1).pipe((0,b.j)(()=>this.pendingBranchManagerIds.delete(e.id))).subscribe({next:a=>{if(a.isSuccess)return this.dataSource.data=this.dataSource.data.filter(o=>o.id!==e.id),this.totalCount=Math.max(this.totalCount-1,0),void this.toast.success(this.translate.instant("Branch manager disabled successfully"));a.errors?.length?a.errors.forEach(o=>this.toast.error(o.message)):this.toast.error(this.translate.instant("Failed to disable branch manager"))},error:()=>this.toast.error(this.translate.instant("Failed to disable branch manager"))}))}setupIntersectionObserver(){this.loadMoreElement&&(this.intersectionObserver?.disconnect(),this.intersectionObserver=new IntersectionObserver(e=>{e.some(a=>a.isIntersecting)&&this.loadNextPage()},{root:null,rootMargin:"0px 0px 20% 0px"}),this.intersectionObserver.observe(this.loadMoreElement.nativeElement))}loadNextPage(){this.isLoading||this.isLoadingMore||this.hasMoreResults()&&(this.pageIndex+=1,this.filter.skipCount=this.pageIndex*this.pageSize,this.filter.maxResultCount=this.pageSize,this.loadBranchManagers(!0))}hasMoreResults(){return this.dataSource.data.length<this.totalCount}branchManagerDetails(e){const a=this.dialog.open(K,{width:"800px",maxWidth:"95vw"});this.lookupService.getUserDetails(e.id).subscribe({next:o=>{o.isSuccess&&o.data?a.componentInstance?.setData(o.data):(a.close(),this.toast.error(this.translate.instant("Failed to load branch manager details")))},error:()=>{a.close(),this.toast.error(this.translate.instant("Failed to load branch manager details"))}})}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-branch-manager-list"]],viewQuery:function(a,o){if(1&a&&t.GBs(nt,5),2&a){let d;t.mGM(d=t.lsd())&&(o.loadMoreTrigger=d.first)}},decls:39,vars:15,consts:[["headerOptionsTemplate",""],["input",""],["loadMoreTrigger",""],[3,"isLoading"],[1,"row","p-t-25"],[1,"col-12"],["padding","0","cardClass","sm-block",3,"cardTitle"],[1,"p-b-15"],[1,"table-containe","table-reponsive"],[1,"table-search","p-t-15","p-x-15"],["appearance","outline",1,"w-100"],["matInput","",3,"keyup","placeholder"],[1,"table-responsive"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","fullName"],["mat-header-cell","","class","p-l-25",4,"matHeaderCellDef"],["mat-cell","","class","p-l-25 text-nowrap",4,"matCellDef"],["matColumnDef","email"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-nowrap",4,"matCellDef"],["matColumnDef","mobile"],["matColumnDef","nationality"],["matColumnDef","action"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"app-paginator"],[1,"text-muted"],[1,"table-options"],["mat-flat-button","","color","primary",3,"routerLink"],[1,"flex","align-item-center"],[1,"ti","ti-plus","f-18","m-r-5"],["mat-header-cell","",1,"p-l-25"],["mat-cell","",1,"p-l-25","text-nowrap"],["mat-header-cell",""],["mat-cell","",1,"text-nowrap"],["mat-header-cell","",1,"text-center"],[1,"text-center","text-nowrap"],[1,"list-inline","p-l-0"],[1,"list-inline-item","m-r-10",3,"click","matTooltip"],["href","javascript:",1,"avatar","avatar-xs","text-muted"],[1,"ti","ti-eye","f-18"],[1,"list-inline-item","m-r-10",3,"matTooltip"],[1,"avatar","avatar-xs","text-muted",3,"routerLink","state"],[1,"ti","ti-edit","f-18"],["type","button",1,"avatar","avatar-xs","text-muted",3,"click","disabled"],[1,"ti","ti-trash","f-18"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","5",1,"mat-cell"]],template:function(a,o){if(1&a){const d=t.RV6();t.j41(0,"app-loading-overlay",3)(1,"div",4)(2,"div",5)(3,"app-card",6),t.nI1(4,"translate"),t.DNE(5,st,6,5,"ng-template",null,0,t.C5r),t.j41(7,"div",7)(8,"div",8)(9,"div",9)(10,"mat-form-field",10)(11,"input",11,1),t.nI1(13,"translate"),t.bIt("keyup",function(s){return l.eBV(d),l.Njj(o.applyFilter(s))}),t.k0s()()(),t.j41(14,"div",12)(15,"table",13),t.qex(16,14),t.DNE(17,lt,3,3,"th",15)(18,ct,2,1,"td",16),t.bVm(),t.qex(19,17),t.DNE(20,dt,3,3,"th",18)(21,pt,2,1,"td",19),t.bVm(),t.qex(22,20),t.DNE(23,ut,3,3,"th",18)(24,mt,2,1,"td",19),t.bVm(),t.qex(25,21),t.DNE(26,gt,3,3,"th",18)(27,ht,2,1,"td",19),t.bVm(),t.qex(28,22),t.DNE(29,ft,3,3,"th",23)(30,_t,15,16,"td",19),t.bVm(),t.DNE(31,xt,1,0,"tr",24)(32,bt,1,0,"tr",25)(33,vt,4,6,"tr",26),t.k0s(),t.j41(34,"div",27,2)(36,"span",28),t.EFF(37),t.nI1(38,"translate"),t.k0s()()()()()()()()()}2&a&&(t.Y8G("isLoading",o.isLoading),t.R7$(3),t.Y8G("cardTitle",t.bMT(4,9,"Branch Manager List")),t.R7$(8),t.Y8G("placeholder",t.bMT(13,11,"Search...")),t.R7$(4),t.Y8G("dataSource",o.dataSource),t.R7$(16),t.Y8G("matHeaderRowDef",o.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",o.displayedColumns),t.R7$(2),t.AVh("d-none",!o.hasMoreResults()),t.R7$(3),t.SpI(" ",t.bMT(38,13,o.isLoadingMore?"Loading more...":"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644")," "))},dependencies:[g.MD,k.G,M.$z,Z.fg,q.j,tt.e,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,c.ky,et.i,v.D9,x.iI,x.Wk,u.l,w.q],styles:[".table-options[_ngcontent-%COMP%]{display:flex;align-items:center}@media (max-width: 575px){.table-options[_ngcontent-%COMP%]{display:block}.table-options[_ngcontent-%COMP%]   .mdc-button[_ngcontent-%COMP%]{margin-top:10px}}"]})}return n})()}}]);