"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[4962],{74962:(A,h,a)=>{a.r(h),a.d(h,{CoursesAddComponent:()=>W});var i=a(48728),p=a(72200),o=a(89417),c=a(56147),C=a(76848),u=a(42986),d=a(87509),_=a(88937),f=a(85972),v=a(11227),t=a(73664),D=a(88834),F=a(9010),O=a(81074),T=a(33746),E=a(5404),I=a(72923),M=a(25079),b=a(16735);function k(r,l){if(1&r&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&r){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.JRh(e.fullName)}}function P(r,l){if(1&r&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&r){const e=l.$implicit;t.Y8G("value",e.value),t.R7$(),t.JRh(e.label)}}function R(r,l){if(1&r){const e=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){i.eBV(e);const n=t.XpG().index,m=t.XpG();return i.Njj(m.removeDay(n))}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s()()}}function B(r,l){if(1&r){const e=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){i.eBV(e);const n=t.XpG(2);return i.Njj(n.addDay())}),t.j41(1,"mat-icon"),t.EFF(2,"add"),t.k0s()()}}function j(r,l){if(1&r&&(t.qex(0),t.j41(1,"div",15)(2,"div",16)(3,"mat-form-field",5)(4,"mat-label"),t.EFF(5,"Day"),t.k0s(),t.j41(6,"mat-select",17),t.DNE(7,P,2,2,"mat-option",8),t.k0s()()(),t.j41(8,"div",16)(9,"mat-form-field",5)(10,"mat-label"),t.EFF(11,"Start Time"),t.k0s(),t.nrm(12,"input",18),t.k0s()(),t.j41(13,"div",19),t.DNE(14,R,3,0,"button",20)(15,B,3,0,"button",21),t.k0s()(),t.bVm()),2&r){const e=l.index,s=t.XpG();t.R7$(),t.Y8G("formGroupName",e),t.R7$(6),t.Y8G("ngForOf",s.days),t.R7$(7),t.Y8G("ngIf",s.daysArray.length>1),t.R7$(),t.Y8G("ngIf",e===s.daysArray.length-1)}}function U(r,l){if(1&r&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&r){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.JRh(e.fullName)}}function G(r,l){if(1&r&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&r){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.JRh(e.fullName)}}let W=(()=>{class r{constructor(){this.fb=(0,i.WQX)(o.ok),this.lookup=(0,i.WQX)(C.s),this.circle=(0,i.WQX)(u.K),this.toast=(0,i.WQX)(d.f),this.teachers=[],this.managers=[],this.students=[],this.days=f.Ep}ngOnInit(){this.circleForm=this.fb.group({name:["",o.k0.required],teacherId:[null,o.k0.required],days:this.fb.array([this.createDayGroup()]),managers:[[]],studentsIds:[[]]});const e={skipCount:0,maxResultCount:100};this.lookup.getUsersForSelects(e,Number(_.m.Teacher)).subscribe(s=>{s.isSuccess&&(this.teachers=s.data.items)}),this.lookup.getUsersForSelects(e,Number(_.m.Manager)).subscribe(s=>{s.isSuccess&&(this.managers=s.data.items)}),this.lookup.getUsersForSelects(e,Number(_.m.Student)).subscribe(s=>{s.isSuccess&&(this.students=s.data.items)})}get daysArray(){return this.circleForm.get("days")}addDay(){this.daysArray.push(this.createDayGroup()),this.daysArray.markAsDirty(),this.daysArray.markAsTouched(),this.daysArray.updateValueAndValidity()}removeDay(e){if(this.daysArray.length<=1)return this.daysArray.at(0).reset({dayId:null,startTime:""}),this.daysArray.markAsDirty(),this.daysArray.markAsTouched(),void this.daysArray.updateValueAndValidity();this.daysArray.removeAt(e),this.daysArray.markAsDirty(),this.daysArray.markAsTouched(),this.daysArray.updateValueAndValidity()}trackByIndex(e){return e}createDayGroup(e){return this.fb.group({dayId:[e?.dayId??null,o.k0.required],startTime:[e?.startTime??"",o.k0.required]})}onSubmit(){if(this.circleForm.invalid)return void this.circleForm.markAllAsTouched();const e=this.circleForm.getRawValue(),s=Array.isArray(e.days)?e.days.reduce((m,y)=>{const g=(0,f.lX)(y?.dayId??void 0);if(void 0===g)return m;const N=(0,v.C8)(y?.startTime);return m.push({dayId:g,time:N??null}),m},[]):[];this.circle.create({name:e.name,teacherId:e.teacherId,days:s.length?s:null,managers:e.managers,studentsIds:e.studentsIds}).subscribe({next:m=>{m.isSuccess?(this.toast.success("Circle created successfully"),this.resetForm()):m.errors?.length?m.errors.forEach(y=>this.toast.error(y.message)):this.toast.error("Error creating circle")},error:()=>this.toast.error("Error creating circle")})}resetForm(){for(;this.daysArray.length>1;)this.daysArray.removeAt(0);this.daysArray.length||this.daysArray.push(this.createDayGroup()),this.daysArray.at(0).reset({dayId:null,startTime:""}),this.circleForm.reset({name:"",teacherId:null,managers:[],studentsIds:[],days:this.daysArray.value}),this.circleForm.markAsPristine(),this.circleForm.markAsUntouched()}static#t=this.\u0275fac=function(s){return new(s||r)};static#e=this.\u0275cmp=t.VBU({type:r,selectors:[["app-courses-add"]],decls:33,vars:6,consts:[[1,"row"],[1,"col-12"],["cardTitle","Course Add"],[1,"row",3,"ngSubmit","formGroup"],[1,"col-md-6"],["appearance","outline",1,"w-100"],["matInput","","formControlName","name","placeholder","Enter Circle Name"],["formControlName","teacherId"],[3,"value",4,"ngFor","ngForOf"],["formArrayName","days"],[4,"ngFor","ngForOf","ngForTrackBy"],["formControlName","managers","multiple",""],["formControlName","studentsIds","multiple",""],["mat-flat-button","","color","primary","type","submit"],[3,"value"],[1,"row",3,"formGroupName"],[1,"col-md-5"],["formControlName","dayId"],["matInput","","type","time","formControlName","startTime","placeholder","Select Start Time"],[1,"col-md-2","d-flex","align-items-center"],["mat-icon-button","","color","warn","type","button","class","m-r-10","aria-label","Remove day",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","type","button","aria-label","Add day",3,"click",4,"ngIf"],["mat-icon-button","","color","warn","type","button","aria-label","Remove day",1,"m-r-10",3,"click"],["mat-icon-button","","color","primary","type","button","aria-label","Add day",3,"click"]],template:function(s,n){1&s&&(t.j41(0,"div",0)(1,"div",1)(2,"app-card",2)(3,"form",3),t.bIt("ngSubmit",function(){return n.onSubmit()}),t.j41(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),t.EFF(7,"Circle Name"),t.k0s(),t.nrm(8,"input",6),t.k0s()(),t.j41(9,"div",4)(10,"mat-form-field",5)(11,"mat-label"),t.EFF(12,"Teacher"),t.k0s(),t.j41(13,"mat-select",7),t.DNE(14,k,2,2,"mat-option",8),t.k0s()()(),t.j41(15,"div",1)(16,"div",9),t.DNE(17,j,16,4,"ng-container",10),t.k0s()(),t.j41(18,"div",4)(19,"mat-form-field",5)(20,"mat-label"),t.EFF(21,"Managers"),t.k0s(),t.j41(22,"mat-select",11),t.DNE(23,U,2,2,"mat-option",8),t.k0s()()(),t.j41(24,"div",4)(25,"mat-form-field",5)(26,"mat-label"),t.EFF(27,"Students"),t.k0s(),t.j41(28,"mat-select",12),t.DNE(29,G,2,2,"mat-option",8),t.k0s()()(),t.j41(30,"div",1)(31,"button",13),t.EFF(32,"Create"),t.k0s()()()()()()),2&s&&(t.R7$(3),t.Y8G("formGroup",n.circleForm),t.R7$(11),t.Y8G("ngForOf",n.teachers),t.R7$(3),t.Y8G("ngForOf",n.daysArray.controls)("ngForTrackBy",n.trackByIndex),t.R7$(6),t.Y8G("ngForOf",n.managers),t.R7$(6),t.Y8G("ngForOf",n.students))},dependencies:[c.G,p.Sq,p.bT,D.$z,F.M,O.An,T.fg,E.j,E.M,I.g,M.M,o.qT,o.me,o.BC,o.cb,o.j4,o.JD,o.$R,o.v8,b.i,p.MD],styles:[".upload-list{overflow:hidden}  .dark .file-upload{background:transparent}.overlay[_ngcontent-%COMP%]{position:relative}.overlay[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{background-color:#fafafa;position:absolute;top:-6px;right:-6px;cursor:pointer;z-index:10;width:40px;height:40px;text-align:center;font-size:20px;line-height:40px}  .dark .overlay .delete-button{background-color:var(--accent-50)!important}"]})}return r})()},87509:(A,h,a)=>{a.d(h,{f:()=>o});var i=a(48728),p=a(95416);let o=(()=>{class c{constructor(){this.snackBar=(0,i.WQX)(p.UG)}success(u,d="Close",_=3e3){this.snackBar.open(u,d,{duration:_,panelClass:["toast-success"]})}error(u,d="Close",_=3e3){this.snackBar.open(u,d,{duration:_,panelClass:["toast-error"]})}static#t=this.\u0275fac=function(d){return new(d||c)};static#e=this.\u0275prov=i.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()}}]);