"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[604,6460,8223],{2709:(W,w,S)=>{S.d(w,{D:()=>s});var P=S(9330),p=S(8728),I=S(8810),f=S(9437),R=S(2525);let s=(()=>{class C{constructor(){this.http=(0,p.WQX)(P.Qq)}createUser(E){return this.http.post(`${R.c.apiUrl}/api/User/Create`,E)}updateUser(E){return this.http.post(`${R.c.apiUrl}/api/User/Update`,E)}disableUser(E,N){const U=(new P.Nl).set("id",E.toString()).set("statue",N.toString());return this.http.get(`${R.c.apiUrl}/api/User/DisableUser`,{params:U})}getProfile(){const N=`${R.c.apiUrl}/api/User/GetProfile`;return this.http.get(`${R.c.apiUrl}/api/User/Profile`).pipe((0,f.W)(U=>{const m=U?.status;return 404===m||405===m?this.http.get(N):(0,I.$)(()=>U)}))}updateProfile(E){return this.http.put(`${R.c.apiUrl}/api/User/Profile`,E)}static#e=this.\u0275fac=function(N){return new(N||C)};static#t=this.\u0275prov=p.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},2754:(W,w,S)=>{S.d(w,{a:()=>p,w:()=>P});const P=[{value:"all",translationKey:"\u0643\u0644 \u0627\u0645\u0627\u0643\u0646 \u0627\u0644\u0627\u0642\u0627\u0645\u0629"},{value:"egyptian",translationKey:"\u0645\u0635\u0631\u064a\u064a\u0646"},{value:"arab",translationKey:"\u0639\u0631\u0628"},{value:"foreign",translationKey:"\u0627\u062c\u0627\u0646\u0628"}];function p(I){return!(!I||"all"===I)}},3964:(W,w,S)=>{S.d(w,{o:()=>f});var P=S(9330),p=S(8728),I=S(6354);let f=(()=>{class R{constructor(){this.http=(0,p.WQX)(P.Qq)}getCountries(){return this.http.get("https://restcountries.com/v3.1/all?fields=name,cca2,idd").pipe((0,I.T)(C=>C.filter(g=>g?.idd?.root).map(g=>({name:g.name.common,code:g.cca2,dialCode:`${g.idd.root}${g.idd.suffixes?.[0]??""}`})).sort((g,E)=>g.name.localeCompare(E.name))))}static#e=this.\u0275fac=function(g){return new(g||R)};static#t=this.\u0275prov=p.jDH({token:R,factory:R.\u0275fac,providedIn:"root"})}return R})()},6109:(W,w,S)=>{S.d(w,{JY:()=>s,QO:()=>R,rJ:()=>C});const P=20,p=["egypt","\u0645\u0635\u0631"],I=new Set([971,966,965,974,973,968,967,962,961,963,964,970,249,218,213,212,216,222,252,253,269]),f=["saudi","\u0627\u0644\u0633\u0639\u0648\u062f","emirates","\u0627\u0644\u0625\u0645\u0627\u0631\u0627\u062a","kuwait","\u0627\u0644\u0643\u0648\u064a\u062a","bahrain","\u0627\u0644\u0628\u062d\u0631\u064a\u0646","qatar","\u0642\u0637\u0631","oman","\u0639\u0645\u0627\u0646","yemen","\u0627\u0644\u064a\u0645\u0646","jordan","\u0627\u0644\u0623\u0631\u062f\u0646","lebanon","\u0644\u0628\u0646\u0627\u0646","syria","\u0633\u0648\u0631\u064a\u0627","iraq","\u0627\u0644\u0639\u0631\u0627\u0642","palestine","\u0641\u0644\u0633\u0637\u064a\u0646","sudan","\u0627\u0644\u0633\u0648\u062f\u0627\u0646","libya","\u0644\u064a\u0628\u064a\u0627","algeria","\u0627\u0644\u062c\u0632\u0627\u0626\u0631","morocco","\u0627\u0644\u0645\u063a\u0631\u0628","tunisia","\u062a\u0648\u0646\u0633","mauritania","\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627","somalia","\u0627\u0644\u0635\u0648\u0645\u0627\u0644","djibouti","\u062c\u064a\u0628\u0648\u062a\u064a","comoros","\u062c\u0632\u0631 \u0627\u0644\u0642\u0645\u0631"];function R(g){if(!g)return!1;const E=Number(g.telCode);if(Number.isFinite(E)&&E===P)return!0;const N=String(g.name??"").toLowerCase();return p.some(U=>N.includes(U))}function s(g){if(!g||R(g))return!1;const E=Number(g.telCode);if(Number.isFinite(E)&&I.has(E))return!0;const N=String(g.name??"").toLowerCase();return f.some(U=>N.includes(U))}function C(g,E){switch(E){case"egyptian":return R(g);case"arab":return s(g);case"foreign":return!g||!R(g)&&!s(g);default:return!0}}},6848:(W,w,S)=>{S.d(w,{_:()=>g,s:()=>E});var P=S(9330),p=S(8728),I=S(6354),f=S(2525),R=S(5366),s=S(8937),C=S(2754);function g(N,U={}){const m=N.data,y=Array.isArray(m)?m:null,O=m&&!Array.isArray(m)?m:{totalCount:y?.length??0,items:y??[]},X=O.items,Z=Array.isArray(X)?X:y??[],K=l=>{const o=Number(l);return Number.isFinite(o)?o:void 0},te=[U.skipCount,O.skipCount].map(K).filter(l=>void 0!==l),t=Math.max(0,Math.trunc(te.length>0?te[0]:0))+Z.length,r=[O.totalCount,O.total,O.count,O.totalItems,O.totalRecords,N.totalCount,N.total,N.count].map(K).find(l=>void 0!==l),i=void 0!==r?Math.max(Math.trunc(r),t):t;return{...N,data:{...O,items:Z,totalCount:i}}}let E=(()=>{class N{constructor(){this.http=(0,p.WQX)(P.Qq),this.auth=(0,p.WQX)(R.k)}getUsersForSelects(m,y,O=0,X=0,Z=0,K,J=!1){const h=this.auth.getRole()===s.m.Admin?0:Z,H=this.resolveLookupMode(m),t=!H;let e=(new P.Nl).set("UserTypeId",y.toString()).set("managerId",O.toString()).set("teacherId",X.toString()).set("branchId",h.toString());t&&void 0!==m.skipCount&&(e=e.set("SkipCount",m.skipCount.toString())),t&&void 0!==m.maxResultCount&&(e=e.set("MaxResultCount",m.maxResultCount.toString()));const r=m.searchWord??m.searchTerm;m.searchTerm&&(e=e.set("SearchTerm",m.searchTerm)),r&&(e=e.set("SearchWord",r));const i=[];return m.filter&&i.push(m.filter),H&&i.push(`${H}=true`),i.length&&(e=e.set("Filter",i.join("&"))),m.lang&&(e=e.set("Lang",m.lang)),m.sortingDirection&&(e=e.set("SortingDirection",m.sortingDirection)),m.sortBy&&(e=e.set("SortBy",m.sortBy)),K&&K>0&&(e=e.set("residentId",K.toString())),(0,C.a)(m.residentGroup)&&(e=e.set("residentGroup",m.residentGroup)),J&&(e=e.set("includeRelations","true")),this.http.get(`${f.c.apiUrl}/api/UsersForGroups/GetUsersForSelects`,{params:e}).pipe((0,I.T)(l=>g(l,{skipCount:m.skipCount})))}getUserDetails(m){const y=(new P.Nl).set("id",m.toString());return this.http.get(`${f.c.apiUrl}/api/UsersForGroups/GetUserDetails`,{params:y})}resolveLookupMode(m){return m.lookupOnly?"lookupOnly":m.lookup?"lookup":m.idsOnly?"idsOnly":null}getAllNationalities(){return this.http.get(`${f.c.apiUrl}/api/LookUp/GetAllNationality`)}getAllGovernorates(){return this.http.get(`${f.c.apiUrl}/api/LookUp/GetAllGovernorate`)}getSubscribesByTypeId(m,y){let O=new P.Nl;return null!=m&&(O=O.set("id",m.toString())),null!=y&&y>0&&(O=O.set("studentId",y.toString())),this.http.get(`${f.c.apiUrl}/api/LookUp/GetAllSubscribesByTypeId`,{params:O})}static#e=this.\u0275fac=function(y){return new(y||N)};static#t=this.\u0275prov=p.jDH({token:N,factory:N.\u0275fac,providedIn:"root"})}return N})()},7509:(W,w,S)=>{S.d(w,{f:()=>I});var P=S(8728),p=S(5416);let I=(()=>{class f{constructor(){this.snackBar=(0,P.WQX)(p.UG)}success(s,C="Close",g=3e3){this.snackBar.open(s,C,{duration:g,panelClass:["toast-success"]})}error(s,C="Close",g=3e3){this.snackBar.open(s,C,{duration:g,panelClass:["toast-error"]})}static#e=this.\u0275fac=function(C){return new(C||f)};static#t=this.\u0275prov=P.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},8223:(W,w,S)=>{S.d(w,{E:()=>P});var P=function(p){return p[p.Mens=1]="Mens",p[p.Women=2]="Women",p}(P||{})},9830:(W,w,S)=>{S.d(w,{Dw:()=>Z,Zr:()=>J});var P=S(467),p=S(8728),I=S(3664),f=S(7705),R=S(9417),s=function(h){return h.SEPARATOR="separator",h.PERCENT="percent",h.IP="IP",h.CPF_CNPJ="CPF_CNPJ",h.MONTH="M",h.MONTHS="M0",h.MINUTE="m",h.HOUR="h",h.HOURS="H",h.MINUTES="m0",h.HOURS_HOUR="Hh",h.SECONDS="s0",h.HOURS_MINUTES_SECONDS="Hh:m0:s0",h.EMAIL_MASK="A*@A*.A*",h.HOURS_MINUTES="Hh:m0",h.MINUTES_SECONDS="m0:s0",h.DAYS_MONTHS_YEARS="d0/M0/0000",h.DAYS_MONTHS="d0/M0",h.DAYS="d0",h.DAY="d",h.SECOND="s",h.LETTER_S="S",h.DOT=".",h.COMMA=",",h.CURLY_BRACKETS_LEFT="{",h.CURLY_BRACKETS_RIGHT="}",h.MINUS="-",h.OR="||",h.HASH="#",h.EMPTY_STRING="",h.SYMBOL_STAR="*",h.SYMBOL_QUESTION="?",h.SLASH="/",h.WHITE_SPACE=" ",h.NUMBER_ZERO="0",h.NUMBER_NINE="9",h.BACKSPACE="Backspace",h.DELETE="Delete",h.ARROW_LEFT="ArrowLeft",h.ARROW_UP="ArrowUp",h.DOUBLE_ZERO="00",h}(s||{});const C=new p.nKC("ngx-mask config"),g=new p.nKC("new ngx-mask config"),E=new p.nKC("initial ngx-mask config"),N={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showMaskTyped:!1,instantPrefix:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:!1,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:h=>h,outputTransformFn:h=>h,maskFilled:new I.bkB,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},U=[s.HOURS_MINUTES_SECONDS,s.HOURS_MINUTES,s.MINUTES_SECONDS],m=[s.PERCENT,s.HOURS_HOUR,s.SECONDS,s.MINUTES,s.SEPARATOR,s.DAYS_MONTHS_YEARS,s.DAYS_MONTHS,s.DAYS,s.MONTHS];let y=(()=>{class h{_config=(0,p.WQX)(C);dropSpecialCharacters=this._config.dropSpecialCharacters;hiddenInput=this._config.hiddenInput;clearIfNotMatch=this._config.clearIfNotMatch;specialCharacters=this._config.specialCharacters;patterns=this._config.patterns;prefix=this._config.prefix;suffix=this._config.suffix;thousandSeparator=this._config.thousandSeparator;decimalMarker=this._config.decimalMarker;customPattern;showMaskTyped=this._config.showMaskTyped;placeHolderCharacter=this._config.placeHolderCharacter;validation=this._config.validation;separatorLimit=this._config.separatorLimit;allowNegativeNumbers=this._config.allowNegativeNumbers;leadZeroDateTime=this._config.leadZeroDateTime;leadZero=this._config.leadZero;apm=this._config.apm;inputTransformFn=this._config.inputTransformFn;outputTransformFn=this._config.outputTransformFn;keepCharacterPositions=this._config.keepCharacterPositions;instantPrefix=this._config.instantPrefix;triggerOnMaskChange=this._config.triggerOnMaskChange;_shift=new Set;plusOnePosition=!1;maskExpression="";actualValue="";showKeepCharacterExp="";shownMaskExpression=this._config.shownMaskExpression;deletedSpecialCharacter=!1;ipError;cpfCnpjError;applyMask(t,e,r=0,i=!1,l=!1,o=()=>{}){if(!e||"string"!=typeof t)return s.EMPTY_STRING;let n=0,c="",_=!1,k=!1,v=1,x=!1,a=t,d=r;a.slice(0,this.prefix.length)===this.prefix&&(a=a.slice(this.prefix.length,a.length)),this.suffix&&a.length>0&&(a=this.checkAndRemoveSuffix(a)),"("===a&&this.prefix&&(a="");const V=a.toString().split(s.EMPTY_STRING);if(this.allowNegativeNumbers&&a.slice(n,n+1)===s.MINUS&&(c+=a.slice(n,n+1)),e===s.IP){const M=a.split(s.DOT);this.ipError=this._validIP(M),e="099.099.099.099"}const $=[];for(let M=0;M<a.length;M++)a[M]?.match("\\d")&&$.push(a[M]??s.EMPTY_STRING);if(e===s.CPF_CNPJ&&(this.cpfCnpjError=11!==$.length&&14!==$.length,e=$.length>11?"00.000.000/0000-00":"000.000.000-00"),e.startsWith(s.PERCENT)){if(a.match("[a-z]|[A-Z]")||a.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!l){a=this._stripToDecimal(a);const B=this.getPrecision(e);a=this.checkInputPrecision(a,B,this.decimalMarker)}const M="string"==typeof this.decimalMarker?this.decimalMarker:s.DOT;if(a.indexOf(M)>0&&!this.percentage(a.substring(0,a.indexOf(M)))){let B=a.substring(0,a.indexOf(M)-1);this.allowNegativeNumbers&&a.slice(n,n+1)===s.MINUS&&!l&&(B=a.substring(0,a.indexOf(M))),a=`${B}${a.substring(a.indexOf(M),a.length)}`}let u="";u=this.allowNegativeNumbers&&a.slice(n,n+1)===s.MINUS?`${s.MINUS}${a.slice(n+1,n+a.length)}`:a,c=this.percentage(u)?this._splitPercentZero(a):this._splitPercentZero(a.substring(0,a.length-1))}else if(e.startsWith(s.SEPARATOR)){(a.match("[w\u0430-\u044f\u0410-\u042f]")||a.match("[\u0401\u0451\u0410-\u044f]")||a.match("[a-z]|[A-Z]")||a.match(/[-@#!$%\\^&*()_\xa3\xac'+|~=`{}\]:";<>.?/]/)||a.match("[^A-Za-z0-9,]"))&&(a=this._stripToDecimal(a));const M=this.getPrecision(e);let u=this.decimalMarker;if(Array.isArray(this.decimalMarker)&&(u=this.actualValue.includes(this.decimalMarker[0])||this.actualValue.includes(this.decimalMarker[1])?this.actualValue.includes(this.decimalMarker[0])?this.decimalMarker[0]:this.decimalMarker[1]:this.decimalMarker.find(T=>T!==this.thousandSeparator)),l){const{decimalMarkerIndex:T,nonZeroIndex:A}=this._findFirstNonZeroAndDecimalIndex(a,u),F=a[0]===s.MINUS;(a[0]===u&&!A||F&&a[1]===u&&!A||a[0]===s.NUMBER_ZERO&&!T&&!A)&&(a=s.NUMBER_ZERO),T&&A&&F&&1===d&&(T<A||T>A)&&(a=s.MINUS+a.slice(A)),!T&&A&&a.length>A&&(a=F?s.MINUS+a.slice(A):a.slice(A)),T&&A&&0===d&&(T<A&&(a=a.slice(T-1)),T>A&&(a=a.slice(A)))}0===M?a=this.allowNegativeNumbers?a.length>2&&a[0]===s.MINUS&&a[1]===s.NUMBER_ZERO&&a[2]!==this.thousandSeparator&&a[2]!==s.COMMA&&a[2]!==s.DOT?"-"+a.slice(2,a.length):a[0]===s.NUMBER_ZERO&&a.length>1&&a[1]!==this.thousandSeparator&&a[1]!==s.COMMA&&a[1]!==s.DOT?a.slice(1,a.length):a:a.length>1&&a[0]===s.NUMBER_ZERO&&a[1]!==this.thousandSeparator&&a[1]!==s.COMMA&&a[1]!==s.DOT?a.slice(1,a.length):a:(a[0]===u&&a.length>1&&!l&&(a=s.NUMBER_ZERO+a.slice(0,a.length+1),this.plusOnePosition=!0),a[0]===s.NUMBER_ZERO&&a[1]!==u&&a[1]!==this.thousandSeparator&&!l&&(a=a.length>1?a.slice(0,1)+u+a.slice(1,a.length+1):a,this.plusOnePosition=!0),this.allowNegativeNumbers&&!l&&a[0]===s.MINUS&&(a[1]===u||a[1]===s.NUMBER_ZERO)&&(a=a[1]===u&&a.length>2?a.slice(0,1)+s.NUMBER_ZERO+a.slice(1,a.length):a[1]===s.NUMBER_ZERO&&a.length>2&&a[2]!==u?a.slice(0,2)+u+a.slice(2,a.length):a,this.plusOnePosition=!0));const B=this._charToRegExpExpression(this.thousandSeparator);let D='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(B,"");if(Array.isArray(this.decimalMarker))for(const T of this.decimalMarker)D=D.replace(this._charToRegExpExpression(T),s.EMPTY_STRING);else D=D.replace(this._charToRegExpExpression(this.decimalMarker),"");const b=new RegExp("["+D+"]");a.match(b)&&(a=a.substring(0,a.length-1)),a=this.checkInputPrecision(a,M,this.decimalMarker);const L=a.replace(new RegExp(B,"g"),"");c=this._formatWithSeparators(L,this.thousandSeparator,this.decimalMarker,M);const ae=c.indexOf(s.COMMA)-a.indexOf(s.COMMA),Y=c.length-a.length;if((c[d-1]===this.thousandSeparator||c[d-this.prefix.length])&&this.prefix&&l)d-=1;else if(Y>0&&c[d]!==this.thousandSeparator||l&&c.length<t.length&&this.separatorLimit){k=!0;let T=0;do{this._shift.add(d+T),T++}while(T<Y)}else c[d-1]===this.thousandSeparator||-4===Y||-3===Y||c[d]===this.thousandSeparator?(this._shift.clear(),this._shift.add(d-1)):0!==ae&&d>0&&!(c.indexOf(s.COMMA)>=d&&d>3)||!(c.indexOf(s.DOT)>=d&&d>3)&&Y<=0?(this._shift.clear(),k=!0,v=Y,d+=Y,this._shift.add(d)):this._shift.clear()}else for(let M=0,u=V[0];M<V.length&&n!==e.length;M++,u=V[M]??s.EMPTY_STRING){const B=s.SYMBOL_STAR in this.patterns;if(this._checkSymbolMask(u,e[n]??s.EMPTY_STRING)&&e[n+1]===s.SYMBOL_QUESTION)c+=u,n+=2;else if(e[n+1]===s.SYMBOL_STAR&&_&&this._checkSymbolMask(u,e[n+2]??s.EMPTY_STRING))c+=u,n+=3,_=!1;else if(this._checkSymbolMask(u,e[n]??s.EMPTY_STRING)&&e[n+1]===s.SYMBOL_STAR&&!B)c+=u,_=!0;else if(e[n+1]===s.SYMBOL_QUESTION&&this._checkSymbolMask(u,e[n+2]??s.EMPTY_STRING))c+=u,n+=3;else if(this._checkSymbolMask(u,e[n]??s.EMPTY_STRING)){if(e[n]===s.HOURS&&(this.apm?Number(u)>9:Number(u)>2)){d=this.leadZeroDateTime?d:d+1,n+=1,this._shiftStep(n),M--,this.leadZeroDateTime&&(c+="0");continue}if(e[n]===s.HOUR&&(this.apm?1===c.length&&Number(c)>1||"1"===c&&Number(u)>2||1===a.slice(n-1,n).length&&Number(a.slice(n-1,n))>2||"1"===a.slice(n-1,n)&&Number(u)>2:"2"===c&&Number(u)>3||("2"===c.slice(n-2,n)||"2"===c.slice(n-3,n)||"2"===c.slice(n-4,n)||"2"===c.slice(n-1,n))&&Number(u)>3&&n>10)){d+=1,n+=1,M--;continue}if((e[n]===s.MINUTE||e[n]===s.SECOND)&&Number(u)>5){d=this.leadZeroDateTime?d:d+1,n+=1,this._shiftStep(n),M--,this.leadZeroDateTime&&(c+="0");continue}const D=31,b=a[n],L=a[n+1],ae=a[n+2],Y=a[n-1],se=a[n-2],T=a.slice(n-3,n-1),A=a.slice(n-1,n+1),F=a.slice(n,n+2),ie=a.slice(n-2,n);if(e[n]===s.DAY){const re=e.slice(0,2)===s.MONTHS,ee=e.slice(0,2)===s.MONTHS&&this.specialCharacters.includes(se);if(Number(u)>3&&this.leadZeroDateTime||!re&&(Number(F)>D||Number(A)>D||this.specialCharacters.includes(L))||(ee?Number(A)>D||!this.specialCharacters.includes(b)&&this.specialCharacters.includes(ae)||this.specialCharacters.includes(b):Number(F)>D||this.specialCharacters.includes(L)&&!l)){d=this.leadZeroDateTime?d:d+1,n+=1,this._shiftStep(n),M--,this.leadZeroDateTime&&(c+="0");continue}}if(e[n]===s.MONTH){const ee=0===n&&(Number(u)>2||Number(F)>12||this.specialCharacters.includes(L)&&!l),ne=e.slice(n+2,n+3),le=T.includes(ne)&&e.includes("d0")&&(this.specialCharacters.includes(se)&&Number(A)>12&&!this.specialCharacters.includes(b)||this.specialCharacters.includes(b)),ce=Number(T)<=D&&!this.specialCharacters.includes(T)&&this.specialCharacters.includes(Y)&&(Number(F)>12||this.specialCharacters.includes(L)),he=Number(F)>12&&5===n||this.specialCharacters.includes(L)&&5===n,oe=Number(T)>D&&!this.specialCharacters.includes(T)&&!this.specialCharacters.includes(ie)&&Number(ie)>12&&e.includes("d0"),ue=Number(T)<=D&&!this.specialCharacters.includes(T)&&!this.specialCharacters.includes(Y)&&Number(A)>12;if(Number(u)>1&&this.leadZeroDateTime||ee||le||ue||oe||ce||he&&!this.leadZeroDateTime){d=this.leadZeroDateTime?d:d+1,n+=1,this._shiftStep(n),M--,this.leadZeroDateTime&&(c+="0");continue}}c+=u,n++}else this.specialCharacters.includes(u)&&e[n]===u?(c+=u,n++):-1!==this.specialCharacters.indexOf(e[n]??s.EMPTY_STRING)?(c+=e[n],n++,this._shiftStep(n),M--):e[n]===s.NUMBER_NINE&&this.showMaskTyped?this._shiftStep(n):this.patterns[e[n]??s.EMPTY_STRING]&&this.patterns[e[n]??s.EMPTY_STRING]?.optional?(V[n]&&"099.099.099.099"!==e&&"000.000.000-00"!==e&&"00.000.000/0000-00"!==e&&!e.match(/^9+\.0+$/)&&!this.patterns[e[n]??s.EMPTY_STRING]?.optional&&(c+=V[n]),e.includes(s.NUMBER_NINE+s.SYMBOL_STAR)&&e.includes(s.NUMBER_ZERO+s.SYMBOL_STAR)&&n++,n++,M--):this.maskExpression[n+1]===s.SYMBOL_STAR&&this._findSpecialChar(this.maskExpression[n+2]??s.EMPTY_STRING)&&this._findSpecialChar(u)===this.maskExpression[n+2]&&_||this.maskExpression[n+1]===s.SYMBOL_QUESTION&&this._findSpecialChar(this.maskExpression[n+2]??s.EMPTY_STRING)&&this._findSpecialChar(u)===this.maskExpression[n+2]&&_?(n+=3,c+=u):this.showMaskTyped&&this.specialCharacters.indexOf(u)<0&&u!==this.placeHolderCharacter&&1===this.placeHolderCharacter.length&&(x=!0)}c[d-1]&&c.length+1===e.length&&-1!==this.specialCharacters.indexOf(e[e.length-1]??s.EMPTY_STRING)&&(c+=e[e.length-1]);let G=d+1;for(;this._shift.has(G);)v++,G++;let j=i&&!e.startsWith(s.SEPARATOR)?n:this._shift.has(d)?v:0;x&&j--,o(j,k),v<0&&this._shift.clear();let Q=!1;l&&(Q=V.every(M=>this.specialCharacters.includes(M)));let z=`${this.prefix}${Q?s.EMPTY_STRING:c}${this.showMaskTyped?"":this.suffix}`;0===c.length&&(z=this.instantPrefix?`${this.prefix}${c}`:`${c}`);const q=1===a.length&&this.specialCharacters.includes(e[0])&&a!==e[0];if(!this._checkSymbolMask(a,e[1])&&q)return"";if(c.includes(s.MINUS)&&this.prefix&&this.allowNegativeNumbers){if(l&&c===s.MINUS)return"";z=`${s.MINUS}${this.prefix}${c.split(s.MINUS).join(s.EMPTY_STRING)}${this.suffix}`}return z}_findDropSpecialChar(t){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find(e=>e===t):this._findSpecialChar(t)}_findSpecialChar(t){return this.specialCharacters.find(e=>e===t)}_checkSymbolMask(t,e){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[e]?.pattern&&this.patterns[e]?.pattern.test(t))??!1}_formatWithSeparators=(t,e,r,i)=>{let l=[],o="";if(Array.isArray(r)){const v=new RegExp(r.map(x=>"[\\^$.|?*+()".indexOf(x)>=0?`\\${x}`:x).join("|"));l=t.split(v),o=t.match(v)?.[0]??s.EMPTY_STRING}else l=t.split(r),o=r;const n=l.length>1?`${o}${l[1]}`:s.EMPTY_STRING;let c=l[0]??s.EMPTY_STRING;const _=this.separatorLimit.replace(/\s/g,s.EMPTY_STRING);_&&+_&&(c=c[0]===s.MINUS?`-${c.slice(1,c.length).slice(0,_.length)}`:c.slice(0,_.length));const k=/(\d+)(\d{3})/;for(;e&&k.test(c);)c=c.replace(k,"$1"+e+"$2");return typeof i>"u"?c+n:0===i?c:c+n.substring(0,i+1)};percentage=t=>{const e=t.replace(",","."),r=Number(this.allowNegativeNumbers&&t.includes(s.MINUS)?e.slice(1,t.length):e);return!isNaN(r)&&r>=0&&r<=100};getPrecision=t=>{const e=t.split(s.DOT);return e.length>1?Number(e[e.length-1]):1/0};checkAndRemoveSuffix=t=>{for(let e=this.suffix?.length-1;e>=0;e--){const r=this.suffix.substring(e,this.suffix?.length);if(t.includes(r)&&e!==this.suffix?.length-1&&(e-1<0||!t.includes(this.suffix.substring(e-1,this.suffix?.length))))return t.replace(r,s.EMPTY_STRING)}return t};checkInputPrecision=(t,e,r)=>{let i=t,l=r;if(e<1/0){if(Array.isArray(l)){const _=l.find(k=>k!==this.thousandSeparator);l=_||l[0]}const o=new RegExp(this._charToRegExpExpression(l)+`\\d{${e}}.*$`),n=i.match(o),c=(n&&n[0]?.length)??0;c-1>e&&(i=i.substring(0,i.length-(c-1-e))),0===e&&this._compareOrIncludes(i[i.length-1],l,this.thousandSeparator)&&(i=i.substring(0,i.length-1))}return i};_stripToDecimal(t){return t.split(s.EMPTY_STRING).filter((e,r)=>{const i="string"==typeof this.decimalMarker?e===this.decimalMarker:this.decimalMarker.includes(e);return e.match("^-?\\d")||e===this.thousandSeparator||i||e===s.MINUS&&0===r&&this.allowNegativeNumbers}).join(s.EMPTY_STRING)}_charToRegExpExpression(t){return t&&(" "===t?"\\s":"[\\^$.|?*+()".indexOf(t)>=0?`\\${t}`:t)}_shiftStep(t){this._shift.add(t+this.prefix.length||0)}_compareOrIncludes(t,e,r){return Array.isArray(e)?e.filter(i=>i!==r).includes(t):t===e}_validIP(t){return!(4===t.length&&!t.some((e,r)=>t.length!==r+1?e===s.EMPTY_STRING||Number(e)>255:e===s.EMPTY_STRING||Number(e.substring(0,3))>255))}_splitPercentZero(t){if(t===s.MINUS&&this.allowNegativeNumbers)return t;const e=t.indexOf("string"==typeof this.decimalMarker?this.decimalMarker:s.DOT),r=this.allowNegativeNumbers&&t.includes(s.MINUS)?"-":"";if(-1===e){const i=parseInt(r?t.slice(1,t.length):t,10);return isNaN(i)?s.EMPTY_STRING:`${r}${i}`}{const i=parseInt(t.replace("-","").substring(0,e),10),l=t.substring(e+1),o=isNaN(i)?"":i.toString();return o===s.EMPTY_STRING?s.EMPTY_STRING:`${r}${o}${"string"==typeof this.decimalMarker?this.decimalMarker:s.DOT}${l}`}}_findFirstNonZeroAndDecimalIndex(t,e){let r=null,i=null;for(let l=0;l<t.length;l++){const o=t[l];if(o===e&&null===r&&(r=l),o&&o>="1"&&o<="9"&&null===i&&(i=l),null!==r&&null!==i)break}return{decimalMarkerIndex:r,nonZeroIndex:i}}static \u0275fac=function(e){return new(e||h)};static \u0275prov=p.jDH({token:h,factory:h.\u0275fac})}return h})(),O=(()=>{class h extends y{isNumberValue=!1;maskIsShown="";selStart=null;selEnd=null;maskChanged=!1;maskExpressionArray=[];previousValue="";currentValue="";writingValue=!1;_emitValue=!1;_start;_end;onChange=t=>{};_elementRef=(0,p.WQX)(I.aKT,{optional:!0});document=(0,p.WQX)(p.qQL);_config=(0,p.WQX)(C);_renderer=(0,p.WQX)(I.sFG,{optional:!0});applyMask(t,e,r=0,i=!1,l=!1,o=()=>{}){if(!e)return t!==this.actualValue?this.actualValue:t;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():s.EMPTY_STRING,this.maskExpression===s.IP&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||s.HASH)),this.maskExpression===s.CPF_CNPJ&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||s.HASH)),!t&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;const n=t&&"number"==typeof this.selStart?t[this.selStart]??s.EMPTY_STRING:s.EMPTY_STRING;let c="",_=r;if((this.hiddenInput||t&&t.indexOf(s.SYMBOL_STAR)>=0)&&!this.writingValue){let a=t&&1===t.length?t.split(s.EMPTY_STRING):this.actualValue.split(s.EMPTY_STRING);l&&(a=a.slice(0,r).concat(a.slice(r+1))),this.showMaskTyped&&(t=this.removeMask(t),a=this.removeMask(a.join("")).split(s.EMPTY_STRING)),"object"==typeof this.selStart&&"object"==typeof this.selEnd?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):t!==s.EMPTY_STRING&&a.length?"number"==typeof this.selStart&&"number"==typeof this.selEnd&&(t.length>a.length?a.splice(this.selStart,0,n):t.length<a.length&&(a.length-t.length===1?a.splice(l?this.selStart-1:t.length-1,1):a.splice(this.selStart,this.selEnd-this.selStart))):a=[],this.showMaskTyped&&!this.hiddenInput&&(c=this.removeMask(t)),c=this.actualValue.length?a.length<t.length?this.shiftTypedSymbols(a.join(s.EMPTY_STRING)):a.length===t.length?a.join(s.EMPTY_STRING):t:t}if(i&&(this.hiddenInput||!this.hiddenInput)&&(c=t),l&&-1!==this.specialCharacters.indexOf(this.maskExpression[_]??s.EMPTY_STRING)&&this.showMaskTyped&&!this.prefix&&(c=this.currentValue),this.deletedSpecialCharacter&&_&&(this.specialCharacters.includes(this.actualValue.slice(_,_+1))?_+=1:e.slice(_-1,_+1)!==s.MONTHS&&(_-=2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&1===this.placeHolderCharacter.length&&!this.leadZeroDateTime&&(c=this.removeMask(c)),c=this.maskChanged?t:c&&c.length?c:t,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!i&&!this.writingValue){const a=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(a),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}const k=super.applyMask(c,e,_,i,l,o);if(this.actualValue=this.getActualValue(k),this.thousandSeparator===s.DOT&&this.decimalMarker===s.DOT&&(this.decimalMarker=s.COMMA),this.maskExpression.startsWith(s.SEPARATOR)&&!0===this.dropSpecialCharacters&&(this.specialCharacters=this.specialCharacters.filter(a=>!this._compareOrIncludes(a,this.decimalMarker,this.thousandSeparator))),(k||""===k)&&(this.previousValue=this.currentValue,this.currentValue=k,this._emitValue=this.previousValue!==this.currentValue||c!==this.currentValue&&this.writingValue||this.previousValue===this.currentValue&&i),this._emitValue&&this.formControlResult(k),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?`${this.hideInput(k,this.maskExpression)}${this.maskIsShown.slice(k.length)}`:k;const v=k.length,x=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes(s.HOURS)){const a=this._numberSkipedSymbols(k);return`${k}${x.slice(v+a)}`}return this.maskExpression===s.IP||this.maskExpression===s.CPF_CNPJ?`${k}${x}`:`${k}${x.slice(v)}`}_numberSkipedSymbols(t){const e=/(^|\D)(\d\D)/g;let r=e.exec(t),i=0;for(;null!=r;)i+=1,r=e.exec(t);return i}applyValueChanges(t,e,r,i=()=>{}){const l=this._elementRef?.nativeElement;l&&(l.value=this.applyMask(l.value,this.maskExpression,t,e,r,i),l!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(t,e){return t.split(s.EMPTY_STRING).map((r,i)=>this.patterns&&this.patterns[e[i]??s.EMPTY_STRING]&&this.patterns[e[i]??s.EMPTY_STRING]?.symbol?this.patterns[e[i]??s.EMPTY_STRING]?.symbol:r).join(s.EMPTY_STRING)}getActualValue(t){const e=t.split(s.EMPTY_STRING).filter((r,i)=>{const l=this.maskExpression[i]??s.EMPTY_STRING;return this._checkSymbolMask(r,l)||this.specialCharacters.includes(l)&&r===l});return e.join(s.EMPTY_STRING)===t?e.join(s.EMPTY_STRING):t}shiftTypedSymbols(t){let e="";return(t&&t.split(s.EMPTY_STRING).map((i,l)=>{if(this.specialCharacters.includes(t[l+1]??s.EMPTY_STRING)&&t[l+1]!==this.maskExpression[l+1])return e=i,t[l+1];if(e.length){const o=e;return e=s.EMPTY_STRING,o}return i})||[]).join(s.EMPTY_STRING)}numberToString(t){return!t&&0!==t||this.maskExpression.startsWith(s.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith(s.SEPARATOR)&&this.separatorLimit.length>14&&String(t).length>14?String(t):Number(t).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace(`/${s.MINUS}/`,s.MINUS)}showMaskInInput(t){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}if(this.showMaskTyped){if(t){if(this.maskExpression===s.IP)return this._checkForIp(t);if(this.maskExpression===s.CPF_CNPJ)return this._checkForCpfCnpj(t)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){const t=this._elementRef?.nativeElement;t&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==t.value.replace(this.placeHolderCharacter,s.EMPTY_STRING).length&&(this.formElementProperty=["value",s.EMPTY_STRING],this.applyMask("",this.maskExpression))}set formElementProperty([t,e]){!this._renderer||!this._elementRef||Promise.resolve().then(()=>this._renderer?.setProperty(this._elementRef?.nativeElement,t,e))}checkDropSpecialCharAmount(t){return t.split(s.EMPTY_STRING).filter(r=>this._findDropSpecialChar(r)).length}removeMask(t){return this._removeMask(this._removeSuffix(this._removePrefix(t)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(t){if(t===s.HASH)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;const e=[];for(let r=0;r<t.length;r++){const i=t[r]??s.EMPTY_STRING;i&&i.match("\\d")&&e.push(i)}return e.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>3&&e.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>6&&e.length<=9?this.placeHolderCharacter:""}_checkForCpfCnpj(t){const e=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,r=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if(t===s.HASH)return e;const i=[];for(let l=0;l<t.length;l++){const o=t[l]??s.EMPTY_STRING;o&&o.match("\\d")&&i.push(o)}return i.length<=3?e.slice(i.length,e.length):i.length>3&&i.length<=6?e.slice(i.length+1,e.length):i.length>6&&i.length<=9?e.slice(i.length+2,e.length):i.length>9&&i.length<11?e.slice(i.length+3,e.length):11===i.length?"":12===i.length?r.slice(17===t.length?16:15,r.length):i.length>12&&i.length<=14?r.slice(i.length+4,r.length):""}_getActiveElement(t=this.document){const e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}formControlResult(t){const e=this.outputTransformFn?this.outputTransformFn:r=>r;this.writingValue=!1,this.maskChanged=!1,Array.isArray(this.dropSpecialCharacters)?this.onChange(e(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(t)),this.dropSpecialCharacters))))):this.onChange(e(this._toNumber(this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===t?this._checkSymbols(this._removeSuffix(this._removePrefix(t))):t)))}_toNumber(t){if(!this.isNumberValue||t===s.EMPTY_STRING||this.maskExpression.startsWith(s.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters))return t;if(String(t).length>14&&this.maskExpression.startsWith(s.SEPARATOR))return String(t);const e=Number(t);if(this.maskExpression.startsWith(s.SEPARATOR)&&Number.isNaN(e)){const r=String(t).replace(",",".");return Number(r)}return Number.isNaN(e)?t:e}_removeMask(t,e){return this.maskExpression.startsWith(s.PERCENT)&&t.includes(s.DOT)?t:t&&t.replace(this._regExpForRemove(e),s.EMPTY_STRING)}_removePrefix(t){return this.prefix?t&&t.replace(this.prefix,s.EMPTY_STRING):t}_removeSuffix(t){return this.suffix?t&&t.replace(this.suffix,s.EMPTY_STRING):t}_retrieveSeparatorValue(t){let e=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter(r=>this.dropSpecialCharacters.includes(r)):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&t.includes(s.WHITE_SPACE)&&this.maskExpression.includes(s.SYMBOL_STAR)&&(e=e.filter(r=>r!==s.WHITE_SPACE)),this._removeMask(t,e)}_regExpForRemove(t){return new RegExp(t.map(e=>`\\${e}`).join("|"),"gi")}_replaceDecimalMarkerToDot(t){const e=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return t.replace(this._regExpForRemove(e),s.DOT)}_checkSymbols(t){let e=t;if(e===s.EMPTY_STRING)return e;this.maskExpression.startsWith(s.PERCENT)&&this.decimalMarker===s.COMMA&&(e=e.replace(s.COMMA,s.DOT));const r=this._retrieveSeparatorPrecision(this.maskExpression),i=0===this.specialCharacters.length?this._retrieveSeparatorValue(e):this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(e));return this.isNumberValue&&r?e===this.decimalMarker?null:i.length>14?String(i):this._checkPrecision(this.maskExpression,i):i}_checkPatternForSpace(){for(const t in this.patterns)if(this.patterns[t]&&this.patterns[t]?.hasOwnProperty("pattern")){const e=this.patterns[t]?.pattern.toString(),r=this.patterns[t]?.pattern;if(e?.includes(s.WHITE_SPACE)&&r?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(t){const e=t.match(new RegExp("^separator\\.([^d]*)"));return e?Number(e[1]):null}_checkPrecision(t,e){const r=this.getPrecision(t);let i=e;return t.indexOf("2")>0||this.leadZero&&Number(r)>0?(this.decimalMarker===s.COMMA&&this.leadZero&&(i=i.replace(",",".")),this.leadZero?Number(i).toFixed(Number(r)):Number(i).toFixed(2)):this.numberToString(i)}_repeatPatternSymbols(t){return t.match(/{[0-9]+}/)&&t.split(s.EMPTY_STRING).reduce((e,r,i)=>{if(this._start=r===s.CURLY_BRACKETS_LEFT?i:this._start,r!==s.CURLY_BRACKETS_RIGHT)return this._findSpecialChar(r)?e+r:e;this._end=i;const l=Number(t.slice(this._start+1,this._end)),o=new Array(l+1).join(t[this._start-1]);if(t.slice(0,this._start).length>1&&t.includes(s.LETTER_S)){const n=t.slice(0,this._start-1);return n.includes(s.CURLY_BRACKETS_LEFT)?e+o:n+e+o}return e+o},"")||t}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=I.xGo(h)))(r||h)}})();static \u0275prov=p.jDH({token:h,factory:h.\u0275fac})}return h})();function X(){const h=(0,p.WQX)(E),H=(0,p.WQX)(g);return H instanceof Function?{...h,...H()}:{...h,...H}}function Z(h){return[{provide:g,useValue:h},{provide:E,useValue:N},{provide:C,useFactory:X},O]}let J=(()=>{class h{mask=(0,f.hFB)("");specialCharacters=(0,f.hFB)([]);patterns=(0,f.hFB)({});prefix=(0,f.hFB)("");suffix=(0,f.hFB)("");thousandSeparator=(0,f.hFB)(" ");decimalMarker=(0,f.hFB)(".");dropSpecialCharacters=(0,f.hFB)(null);hiddenInput=(0,f.hFB)(null);showMaskTyped=(0,f.hFB)(null);placeHolderCharacter=(0,f.hFB)(null);shownMaskExpression=(0,f.hFB)(null);clearIfNotMatch=(0,f.hFB)(null);validation=(0,f.hFB)(null);separatorLimit=(0,f.hFB)("");allowNegativeNumbers=(0,f.hFB)(null);leadZeroDateTime=(0,f.hFB)(null);leadZero=(0,f.hFB)(null);triggerOnMaskChange=(0,f.hFB)(null);apm=(0,f.hFB)(null);inputTransformFn=(0,f.hFB)(null);outputTransformFn=(0,f.hFB)(null);keepCharacterPositions=(0,f.hFB)(null);instantPrefix=(0,f.hFB)(null);maskFilled=(0,f.CGW)();_maskValue=(0,p.vPA)("");_inputValue=(0,p.vPA)("");_position=(0,p.vPA)(null);_code=(0,p.vPA)("");_maskExpressionArray=(0,p.vPA)([]);_justPasted=(0,p.vPA)(!1);_isFocused=(0,p.vPA)(!1);_isComposing=(0,p.vPA)(!1);_maskService=(0,p.WQX)(O,{self:!0});document=(0,p.WQX)(p.qQL);_config=(0,p.WQX)(C);onChange=t=>{};onTouch=()=>{};ngOnChanges(t){const{mask:e,specialCharacters:r,patterns:i,prefix:l,suffix:o,thousandSeparator:n,decimalMarker:c,dropSpecialCharacters:_,hiddenInput:k,showMaskTyped:v,placeHolderCharacter:x,shownMaskExpression:a,clearIfNotMatch:d,validation:V,separatorLimit:$,allowNegativeNumbers:G,leadZeroDateTime:j,leadZero:Q,triggerOnMaskChange:z,apm:q,inputTransformFn:M,outputTransformFn:u,keepCharacterPositions:B,instantPrefix:D}=t;if(e&&(e.currentValue!==e.previousValue&&!e.firstChange&&(this._maskService.maskChanged=!0),e.currentValue&&e.currentValue.split(s.OR).length>1?(this._maskExpressionArray.set(e.currentValue.split(s.OR).sort((b,L)=>b.length-L.length)),this._setMask()):(this._maskExpressionArray.set([]),this._maskValue.set(e.currentValue||s.EMPTY_STRING),this._maskService.maskExpression=this._maskValue())),r){if(!r.currentValue||!Array.isArray(r.currentValue))return;this._maskService.specialCharacters=r.currentValue||[]}if(G&&(this._maskService.allowNegativeNumbers=G.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.specialCharacters=this._maskService.specialCharacters.filter(b=>b!==s.MINUS))),i&&i.currentValue&&(this._maskService.patterns=i.currentValue),q&&q.currentValue&&(this._maskService.apm=q.currentValue),D&&(this._maskService.instantPrefix=D.currentValue),l&&(this._maskService.prefix=l.currentValue),o&&(this._maskService.suffix=o.currentValue),n&&(this._maskService.thousandSeparator=n.currentValue,n.previousValue&&n.currentValue)){const b=this._maskService.decimalMarker;n.currentValue===this._maskService.decimalMarker&&(this._maskService.decimalMarker=n.currentValue===s.COMMA?s.DOT:s.COMMA),!0===this._maskService.dropSpecialCharacters&&(this._maskService.specialCharacters=this._config.specialCharacters),"string"==typeof b&&"string"==typeof this._maskService.decimalMarker&&(this._inputValue.set(this._inputValue().split(n.previousValue).join("").replace(b,this._maskService.decimalMarker)),this._maskService.actualValue=this._inputValue()),this._maskService.writingValue=!0}c&&(this._maskService.decimalMarker=c.currentValue),_&&(this._maskService.dropSpecialCharacters=_.currentValue),k&&(this._maskService.hiddenInput=k.currentValue,!0===k.previousValue&&!1===k.currentValue&&this._inputValue.set(this._maskService.actualValue)),v&&(this._maskService.showMaskTyped=v.currentValue,!1===v.previousValue&&!0===v.currentValue&&this._isFocused()&&requestAnimationFrame(()=>{this._maskService._elementRef?.nativeElement.click()})),x&&(this._maskService.placeHolderCharacter=x.currentValue),a&&(this._maskService.shownMaskExpression=a.currentValue),d&&(this._maskService.clearIfNotMatch=d.currentValue),V&&(this._maskService.validation=V.currentValue),$&&(this._maskService.separatorLimit=$.currentValue),j&&(this._maskService.leadZeroDateTime=j.currentValue),Q&&(this._maskService.leadZero=Q.currentValue),z&&(this._maskService.triggerOnMaskChange=z.currentValue),M&&(this._maskService.inputTransformFn=M.currentValue),u&&(this._maskService.outputTransformFn=u.currentValue),B&&(this._maskService.keepCharacterPositions=B.currentValue),this._applyMask()}validate({value:t}){const e="number"==typeof t?String(t):t,r=this._maskValue();if(!this._maskService.validation||!r)return null;if(this._maskService.ipError)return this._createValidationError(e);if(this._maskService.cpfCnpjError)return this._createValidationError(e);if(r.startsWith(s.SEPARATOR)||m.includes(r)||this._maskService.clearIfNotMatch)return null;if(U.includes(r))return this._validateTime(e);if(r===s.EMAIL_MASK)return!/^[^@]+@[^@]+\.[^@]+$/.test(e)&&e?this._createValidationError(e):null;if(e&&e.length>=1){let i=0;if(r.includes(s.CURLY_BRACKETS_LEFT)&&r.includes(s.CURLY_BRACKETS_RIGHT))return r.slice(r.indexOf(s.CURLY_BRACKETS_LEFT)+1,r.indexOf(s.CURLY_BRACKETS_RIGHT))===String(e.length)?null:this._createValidationError(e);if(r.startsWith(s.PERCENT))return null;for(const l in this._maskService.patterns)if(this._maskService.patterns[l]?.optional&&(r.indexOf(l)!==r.lastIndexOf(l)?i+=r.split(s.EMPTY_STRING).filter(n=>n===l).join(s.EMPTY_STRING).length:-1!==r.indexOf(l)&&i++,-1!==r.indexOf(l)&&e.length>=r.indexOf(l)||i===r.length))return null;if(r.indexOf(s.SYMBOL_STAR)>1&&e.length<r.indexOf(s.SYMBOL_STAR)||r.indexOf(s.SYMBOL_QUESTION)>1&&e.length<r.indexOf(s.SYMBOL_QUESTION))return this._createValidationError(e);if(-1===r.indexOf(s.SYMBOL_STAR)||-1===r.indexOf(s.SYMBOL_QUESTION)){const l=r.split("*"),o=this._maskService.dropSpecialCharacters?r.length-this._maskService.checkDropSpecialCharAmount(r)-i:this.prefix()?r.length+this.prefix().length-i:r.length-i;if(1===l.length&&e.length<o)return this._createValidationError(e);if(l.length>1){const n=l[l.length-1];if(n&&this._maskService.specialCharacters.includes(n[0])&&String(e).includes(n[0]??"")&&!this.dropSpecialCharacters()){const c=t.split(n[0]);return c[c.length-1].length===n.length-1?null:this._createValidationError(e)}return(n&&!this._maskService.specialCharacters.includes(n[0])||!n||this._maskService.dropSpecialCharacters)&&e.length>=o-1?null:this._createValidationError(e)}}if(1===r.indexOf(s.SYMBOL_STAR)||1===r.indexOf(s.SYMBOL_QUESTION))return null}return t&&this.maskFilled.emit(),null}onPaste(){this._justPasted.set(!0)}onFocus(){this._isFocused.set(!0)}onModelChange(t){(t===s.EMPTY_STRING||null===t||typeof t>"u")&&this._maskService.actualValue&&(this._maskService.actualValue=this._maskService.getActualValue(s.EMPTY_STRING))}onInput(t){if(this._isComposing())return;const e=t.target,r=this._maskService.inputTransformFn?this._maskService.inputTransformFn(e.value):e.value;if("number"!==e.type)if("string"==typeof r||"number"==typeof r){if(e.value=r.toString(),this._inputValue.set(e.value),this._setMask(),!this._maskValue())return void this.onChange(e.value);let i=1===e.selectionStart?e.selectionStart+this._maskService.prefix.length:e.selectionStart;if(this.showMaskTyped()&&this.keepCharacterPositions()&&1===this._maskService.placeHolderCharacter.length){const c=this.suffix(),_=this.prefix(),k=e.value.slice(i-1,i),v=_.length,x=this._maskService._checkSymbolMask(k,this._maskService.maskExpression[i-1-v]??s.EMPTY_STRING),a=this._maskService._checkSymbolMask(k,this._maskService.maskExpression[i+1-v]??s.EMPTY_STRING),d=this._maskService.selStart===this._maskService.selEnd,V=Number(this._maskService.selStart)-v,$=Number(this._maskService.selEnd)-v,G=this._code()===s.BACKSPACE||this._code()===s.DELETE;if(G){if(d){if(!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(i-v,i+1-v))&&d)if(1===V&&_)this._maskService.actualValue=`${_}${this._maskService.placeHolderCharacter}${e.value.split(_).join("").split(c).join("")}${c}`,i-=1;else{const j=e.value.substring(0,i),Q=e.value.substring(i);this._maskService.actualValue=`${j}${this._maskService.placeHolderCharacter}${Q}`}}else this._maskService.actualValue=this._maskService.selStart===v?`${_}${this._maskService.maskIsShown.slice(0,$)}${this._inputValue().split(_).join("")}`:this._maskService.selStart===this._maskService.maskIsShown.length+v?`${this._inputValue()}${this._maskService.maskIsShown.slice(V,$)}`:`${_}${this._inputValue().split(_).join("").slice(0,V)}${this._maskService.maskIsShown.slice(V,$)}${this._maskService.actualValue.slice($+v,this._maskService.maskIsShown.length+v)}${c}`;i=this._code()===s.DELETE?i+1:i}G||(x||a||!d?this._maskService.specialCharacters.includes(e.value.slice(i,i+1))&&a&&!this._maskService.specialCharacters.includes(e.value.slice(i+1,i+2))?(this._maskService.actualValue=`${e.value.slice(0,i-1)}${e.value.slice(i,i+1)}${k}${e.value.slice(i+2)}`,i+=1):x?this._maskService.actualValue=1===e.value.length&&1===i?`${_}${k}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${c}`:`${e.value.slice(0,i-1)}${k}${e.value.slice(i+1).split(c).join("")}${c}`:_&&1===e.value.length&&i-v===1&&this._maskService._checkSymbolMask(e.value,this._maskService.maskExpression[i-1-v]??s.EMPTY_STRING)&&(this._maskService.actualValue=`${_}${e.value}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${c}`):i=Number(e.selectionStart)-1)}let l=0,o=!1;if(this._code()===s.DELETE&&s.SEPARATOR&&(this._maskService.deletedSpecialCharacter=!0),this._inputValue().length>=this._maskService.maskExpression.length-1&&this._code()!==s.BACKSPACE&&this._maskService.maskExpression===s.DAYS_MONTHS_YEARS&&i<10){const c=this._inputValue().slice(i-1,i);e.value=this._inputValue().slice(0,i-1)+c+this._inputValue().slice(i+1)}if(this._maskService.maskExpression===s.DAYS_MONTHS_YEARS&&this.leadZeroDateTime()&&(i<3&&Number(e.value)>31&&Number(e.value)<40||5===i&&Number(e.value.slice(3,5))>12)&&(i+=2),this._maskService.maskExpression===s.HOURS_MINUTES_SECONDS&&this.apm()&&(this._justPasted()&&e.value.slice(0,2)===s.DOUBLE_ZERO&&(e.value=e.value.slice(1,2)+e.value.slice(2,e.value.length)),e.value=e.value===s.DOUBLE_ZERO?s.NUMBER_ZERO:e.value),this._maskService.applyValueChanges(i,this._justPasted(),this._code()===s.BACKSPACE||this._code()===s.DELETE,(c,_)=>{this._justPasted.set(!1),l=c,o=_}),this._getActiveElement()!==e)return;if(this._maskService.plusOnePosition&&(i+=1,this._maskService.plusOnePosition=!1),this._maskExpressionArray().length)if(this._code()===s.BACKSPACE){const c=this.specialCharacters().includes(this._maskService.actualValue.slice(i-1,i)),_=this._maskService.removeMask(this._inputValue())?.length===this._maskService.removeMask(this._maskService.maskExpression)?.length,k=this.specialCharacters().includes(this._maskService.actualValue.slice(i,i+1));i=_&&!k?e.selectionStart+1:c?i-1:i}else i=1===e.selectionStart?e.selectionStart+this._maskService.prefix.length:e.selectionStart;this._position.set(1===this._position()&&1===this._inputValue().length?null:this._position());let n=this._position()?this._inputValue().length+i+l:i+(this._code()!==s.BACKSPACE||o?l:0);n>this._getActualInputLength()&&(n=e.value===this._maskService.decimalMarker&&1===e.value.length?this._getActualInputLength()+1:this._getActualInputLength()),n<0&&(n=0),e.setSelectionRange(n,n),this._position.set(null)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof r);else{if(!this._maskValue())return void this.onChange(e.value);this._maskService.applyValueChanges(e.value.length,this._justPasted(),this._code()===s.BACKSPACE||this._code()===s.DELETE)}}onCompositionStart(){this._isComposing.set(!0)}onCompositionEnd(t){this._isComposing.set(!1),this._justPasted.set(!0),this.onInput(t)}onBlur(t){if(this._maskValue()){const e=t.target;if(this._maskService.leadZero&&e.value.length>0&&"string"==typeof this._maskService.decimalMarker){const r=this._maskService.maskExpression,i=this._maskService.decimalMarker,l=this._maskService.suffix,o=Number(this._maskService.maskExpression.slice(r.length-1,r.length));if(o>0){e.value=l?e.value.split(l).join(""):e.value;const n=e.value.split(i)[1];e.value=e.value.includes(i)?e.value+s.NUMBER_ZERO.repeat(o-n.length)+l:e.value+i+s.NUMBER_ZERO.repeat(o)+l,this._maskService.actualValue=e.value}}this._maskService.clearIfNotMatchFn()}this._isFocused.set(!1),this.onTouch()}onClick(t){if(!this._maskValue())return;const e=t.target;null!==e&&null!==e.selectionStart&&e.selectionStart===e.selectionEnd&&e.selectionStart>this._maskService.prefix.length&&38!==t.keyCode&&this._maskService.showMaskTyped&&!this.keepCharacterPositions()&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),e.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===e.value?(e.focus(),e.setSelectionRange(0,0)):e.selectionStart>this._maskService.actualValue.length&&e.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));const l=e&&(e.value===this._maskService.prefix?this._maskService.prefix+this._maskService.maskIsShown:e.value);if(e&&e.value!==l&&(e.value=l),e&&"number"!==e.type&&(e.selectionStart||e.selectionEnd)<=this._maskService.prefix.length){const o=this._maskService.maskExpression.match(new RegExp(`^[${this._maskService.specialCharacters.map(n=>`\\${n}`).join("")}]+`))?.[0].length||0;e.selectionStart=this._maskService.prefix.length+o}else e&&e.selectionEnd>this._getActualInputLength()&&(e.selectionEnd=this._getActualInputLength())}onKeyDown(t){if(!this._maskValue())return;if(this._isComposing())return void("Enter"===t.key&&this.onCompositionEnd(t));this._code.set(t.code?t.code:t.key);const e=t.target;if(this._inputValue.set(e.value),this._setMask(),"number"!==e.type){if(t.key===s.ARROW_UP&&t.preventDefault(),t.key===s.ARROW_LEFT||t.key===s.BACKSPACE||t.key===s.DELETE){if(t.key===s.BACKSPACE&&0===e.value.length&&(e.selectionStart=e.selectionEnd),t.key===s.BACKSPACE&&0!==e.selectionStart){const i=this.prefix().length,l=this.specialCharacters().length?this.specialCharacters():this._config.specialCharacters;if(i>1&&e.selectionStart<=i)e.setSelectionRange(i,e.selectionEnd);else if(this._inputValue().length!==e.selectionStart&&1!==e.selectionStart)for(;l.includes((this._inputValue()[e.selectionStart-1]??s.EMPTY_STRING).toString())&&(i>=1&&e.selectionStart>i||0===i);)e.setSelectionRange(e.selectionStart-1,e.selectionEnd)}this.checkSelectionOnDeletion(e),this._maskService.prefix.length&&e.selectionStart<=this._maskService.prefix.length&&e.selectionEnd<=this._maskService.prefix.length&&t.preventDefault(),t.key===s.BACKSPACE&&!e.readOnly&&0===e.selectionStart&&e.selectionEnd===e.value.length&&0!==e.value.length&&(this._position.set(this._maskService.prefix?this._maskService.prefix.length:0),this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position()))}this.suffix()&&this.suffix().length>1&&this._inputValue().length-this.suffix().length<e.selectionStart?e.setSelectionRange(this._inputValue().length-this.suffix().length,this._inputValue().length):("KeyA"===t.code&&t.ctrlKey||"KeyA"===t.code&&t.metaKey)&&(e.setSelectionRange(0,this._getActualInputLength()),t.preventDefault()),this._maskService.selStart=e.selectionStart,this._maskService.selEnd=e.selectionEnd}}writeValue(t){var e=this;return(0,P.A)(function*(){let r=t;const i=e._maskService.inputTransformFn;if("object"==typeof r&&null!==r&&"value"in r&&("disable"in r&&e.setDisabledState(!!r.disable),r=r.value),null!==r&&(r=i?i(r):r),"string"==typeof r||"number"==typeof r||null===r||typeof r>"u"){(null===r||typeof r>"u"||""===r)&&(e._maskService.currentValue="",e._maskService.previousValue="");let l=r;if("number"==typeof l||e._maskValue().startsWith(s.SEPARATOR)){l=String(l);const o=e._maskService.currentLocaleDecimalMarker();Array.isArray(e._maskService.decimalMarker)||(l=e._maskService.decimalMarker!==o?l.replace(o,e._maskService.decimalMarker):l),e._maskService.leadZero&&l&&e.mask()&&!1!==e.dropSpecialCharacters()&&(l=e._maskService._checkPrecision(e._maskService.maskExpression,l)),(e._maskService.decimalMarker===s.COMMA||Array.isArray(e._maskService.decimalMarker)&&e._maskService.thousandSeparator===s.DOT)&&(l=l.toString().replace(s.DOT,s.COMMA)),e.mask()?.startsWith(s.SEPARATOR)&&e.leadZero()&&requestAnimationFrame(()=>{e._maskService.applyMask(l?.toString()??"",e._maskService.maskExpression)}),e._maskService.isNumberValue=!0}("string"!=typeof l||null===r||typeof r>"u")&&(l=""),e._inputValue.set(l),e._setMask(),l&&e._maskService.maskExpression||e._maskService.maskExpression&&(e._maskService.prefix||e._maskService.showMaskTyped)?(e._maskService.writingValue=!0,e._maskService.formElementProperty=["value",e._maskService.applyMask(l,e._maskService.maskExpression)],e._maskService.writingValue=!1):e._maskService.formElementProperty=["value",l],e._inputValue.set(l)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof r)})()}registerOnChange(t){this._maskService.onChange=this.onChange=t}registerOnTouched(t){this.onTouch=t}_getActiveElement(t=this.document){const e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}checkSelectionOnDeletion(t){const e=this.prefix().length,r=this.suffix().length,i=this._inputValue().length;t.selectionStart=Math.min(Math.max(e,t.selectionStart),i-r),t.selectionEnd=Math.min(Math.max(e,t.selectionEnd),i-r)}setDisabledState(t){this._maskService.formElementProperty=["disabled",t]}_applyMask(){this._maskService.maskExpression=this._maskService._repeatPatternSymbols(this._maskValue()||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue(),this._maskService.maskExpression)]}_validateTime(t){const e=this._maskValue().split(s.EMPTY_STRING).filter(r=>":"!==r).length;return t&&(0==+(t[t.length-1]??-1)&&t.length<e||t.length<=e-2)?this._createValidationError(t):null}_getActualInputLength(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}_createValidationError(t){return{mask:{requiredMask:this._maskValue(),actualValue:t}}}_setMask(){this._maskExpressionArray().some(t=>{if(t.split(s.EMPTY_STRING).some(r=>this._maskService.specialCharacters.includes(r))&&this._inputValue()&&this._areAllCharactersInEachStringSame(this._maskExpressionArray())||t.includes(s.CURLY_BRACKETS_LEFT)){const r=this._maskService.removeMask(this._inputValue())?.length<=this._maskService.removeMask(t)?.length;if(r){const i=t.includes(s.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(t):t;return this._maskValue.set(i),this._maskService.maskExpression=i,r}{const i=this._maskExpressionArray()[this._maskExpressionArray().length-1]??s.EMPTY_STRING,l=i.includes(s.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(i):i;this._maskValue.set(l),this._maskService.maskExpression=l}}else{const r=this._maskService.removeMask(t),i=this._maskService.removeMask(this._inputValue())?.split(s.EMPTY_STRING).every((l,o)=>{const n=r.charAt(o);return this._maskService._checkSymbolMask(l,n)});if(i||this._justPasted())return this._maskValue.set(t),this._maskService.maskExpression=t,i}})}_areAllCharactersInEachStringSame(t){const e=this._maskService.specialCharacters;return t.map(function r(l){const o=new RegExp(`[${e.map(n=>`\\${n}`).join("")}]`,"g");return l.replace(o,"")}).every(l=>1===new Set(l).size)}static \u0275fac=function(e){return new(e||h)};static \u0275dir=I.FsC({type:h,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function(e,r){1&e&&I.bIt("paste",function(){return r.onPaste()})("focus",function(l){return r.onFocus(l)})("ngModelChange",function(l){return r.onModelChange(l)})("input",function(l){return r.onInput(l)})("compositionstart",function(l){return r.onCompositionStart(l)})("compositionend",function(l){return r.onCompositionEnd(l)})("blur",function(l){return r.onBlur(l)})("click",function(l){return r.onClick(l)})("keydown",function(l){return r.onKeyDown(l)})},inputs:{mask:[1,"mask"],specialCharacters:[1,"specialCharacters"],patterns:[1,"patterns"],prefix:[1,"prefix"],suffix:[1,"suffix"],thousandSeparator:[1,"thousandSeparator"],decimalMarker:[1,"decimalMarker"],dropSpecialCharacters:[1,"dropSpecialCharacters"],hiddenInput:[1,"hiddenInput"],showMaskTyped:[1,"showMaskTyped"],placeHolderCharacter:[1,"placeHolderCharacter"],shownMaskExpression:[1,"shownMaskExpression"],clearIfNotMatch:[1,"clearIfNotMatch"],validation:[1,"validation"],separatorLimit:[1,"separatorLimit"],allowNegativeNumbers:[1,"allowNegativeNumbers"],leadZeroDateTime:[1,"leadZeroDateTime"],leadZero:[1,"leadZero"],triggerOnMaskChange:[1,"triggerOnMaskChange"],apm:[1,"apm"],inputTransformFn:[1,"inputTransformFn"],outputTransformFn:[1,"outputTransformFn"],keepCharacterPositions:[1,"keepCharacterPositions"],instantPrefix:[1,"instantPrefix"]},outputs:{maskFilled:"maskFilled"},exportAs:["mask","ngxMask"],features:[I.Jv_([{provide:R.kq,useExisting:h,multi:!0},{provide:R.cz,useExisting:h,multi:!0},O]),I.OA$]})}return h})()}}]);