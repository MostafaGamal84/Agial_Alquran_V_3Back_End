"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[6775],{2709:(B,S,n)=>{n.d(S,{D:()=>I});var u=n(9330),h=n(8728),r=n(8810),g=n(9437),f=n(2525);let I=(()=>{class C{constructor(){this.http=(0,h.WQX)(u.Qq)}createUser(_){return this.http.post(`${f.c.apiUrl}/api/User/Create`,_)}updateUser(_){return this.http.post(`${f.c.apiUrl}/api/User/Update`,_)}disableUser(_,l){const v=(new u.Nl).set("id",_.toString()).set("statue",l.toString());return this.http.get(`${f.c.apiUrl}/api/User/DisableUser`,{params:v})}getProfile(){const l=`${f.c.apiUrl}/api/User/GetProfile`;return this.http.get(`${f.c.apiUrl}/api/User/Profile`).pipe((0,g.W)(v=>{const e=v?.status;return 404===e||405===e?this.http.get(l):(0,r.$)(()=>v)}))}updateProfile(_){return this.http.put(`${f.c.apiUrl}/api/User/Profile`,_)}static#t=this.\u0275fac=function(l){return new(l||C)};static#e=this.\u0275prov=h.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},2754:(B,S,n)=>{n.d(S,{a:()=>h,w:()=>u});const u=[{value:"all",translationKey:"\u0643\u0644 \u0627\u0645\u0627\u0643\u0646 \u0627\u0644\u0627\u0642\u0627\u0645\u0629"},{value:"egyptian",translationKey:"\u0645\u0635\u0631\u064a\u064a\u0646"},{value:"arab",translationKey:"\u0639\u0631\u0628"},{value:"foreign",translationKey:"\u0627\u062c\u0627\u0646\u0628"}];function h(r){return!(!r||"all"===r)}},6775:(B,S,n)=>{n.r(S),n.d(S,{StudentApplyComponent:()=>j});var u=n(8728),h=n(2200),r=n(645),g=n(6053),f=n(6848),I=n(2709),C=n(8937),t=n(3664),_=n(3746),l=n(4507),v=n(5747),e=n(6735),c=n(8018);const p=["loadMoreTrigger"];function T(a,d){1&a&&(t.j41(0,"th",27),t.EFF(1,"NAME"),t.k0s())}function U(a,d){if(1&a&&(t.j41(0,"td",28),t.EFF(1),t.k0s()),2&a){const s=d.$implicit;t.R7$(),t.SpI(" ",s.fullName," ")}}function M(a,d){1&a&&(t.j41(0,"th",29),t.EFF(1,"EMAIL"),t.k0s())}function R(a,d){if(1&a&&(t.j41(0,"td",30),t.EFF(1),t.k0s()),2&a){const s=d.$implicit;t.R7$(),t.SpI(" ",s.email," ")}}function L(a,d){1&a&&(t.j41(0,"th",29),t.EFF(1,"MOBILE"),t.k0s())}function x(a,d){if(1&a&&(t.j41(0,"td",30),t.EFF(1),t.k0s()),2&a){const s=d.$implicit;t.R7$(),t.SpI(" ",s.mobile," ")}}function P(a,d){1&a&&(t.j41(0,"th",29),t.EFF(1,"NATIONALITY"),t.k0s())}function A(a,d){if(1&a&&(t.j41(0,"td",30),t.EFF(1),t.k0s()),2&a){const s=d.$implicit;t.R7$(),t.SpI(" ",s.nationality," ")}}function i(a,d){1&a&&(t.j41(0,"th",31),t.EFF(1,"ACTIONS"),t.k0s())}function O(a,d){if(1&a){const s=t.RV6();t.j41(0,"td",30)(1,"div",32)(2,"ul",33)(3,"li",34),t.bIt("click",function(){const m=u.eBV(s).$implicit,E=t.XpG();return u.Njj(E.changeStatus(m,!0))}),t.j41(4,"a",35),t.nrm(5,"i",36),t.k0s()(),t.j41(6,"li",37),t.bIt("click",function(){const m=u.eBV(s).$implicit,E=t.XpG();return u.Njj(E.changeStatus(m,!1))}),t.j41(7,"a",38),t.nrm(8,"i",39),t.k0s()()()()()}}function y(a,d){1&a&&t.nrm(0,"tr",40)}function D(a,d){1&a&&t.nrm(0,"tr",41)}function k(a,d){if(1&a&&(t.j41(0,"tr",42)(1,"td",43),t.EFF(2),t.k0s()()),2&a){t.XpG();const s=t.sdS(8);t.R7$(2),t.SpI('No data matching the filter "',s.value,'"')}}let j=(()=>{class a{constructor(){this.lookupService=(0,u.WQX)(f.s),this.userService=(0,u.WQX)(I.D),this.displayedColumns=["fullName","email","mobile","nationality","action"],this.dataSource=new r.I6,this.totalCount=0,this.filter={skipCount:0,maxResultCount:10,filter:"inactive=true"},this.pageIndex=0,this.pageSize=10,this.isLoading=!1,this.isLoadingMore=!1}set loadMoreTrigger(s){this.loadMoreElement=s,this.setupIntersectionObserver()}applyFilter(s){this.filter.searchTerm=s.target.value.trim().toLowerCase(),this.pageIndex=0,this.filter.skipCount=0,this.loadStudents()}ngOnInit(){this.loadStudents()}ngOnDestroy(){this.intersectionObserver?.disconnect()}loadStudents(s=!1){this.isLoading=!s,this.isLoadingMore=s,this.lookupService.getUsersForSelects(this.filter,Number(C.m.Student),0,0,0).subscribe({next:o=>{o.isSuccess&&o.data?.items?(this.dataSource.data=s?[...this.dataSource.data,...o.data.items]:o.data.items,this.totalCount=o.data.totalCount):(s||(this.dataSource.data=[]),this.totalCount=0),this.isLoading=!1,this.isLoadingMore=!1},error:()=>{s||(this.dataSource.data=[]),this.totalCount=0,this.isLoading=!1,this.isLoadingMore=!1}})}changeStatus(s,o){this.userService.disableUser(s.id,o).subscribe(m=>{m.isSuccess&&(this.dataSource.data=this.dataSource.data.filter(E=>E.id!==s.id),this.totalCount--)})}setupIntersectionObserver(){this.loadMoreElement&&(this.intersectionObserver?.disconnect(),this.intersectionObserver=new IntersectionObserver(s=>{s.some(o=>o.isIntersecting)&&this.loadNextPage()},{root:null,rootMargin:"0px 0px 20% 0px"}),this.intersectionObserver.observe(this.loadMoreElement.nativeElement))}loadNextPage(){this.isLoading||this.isLoadingMore||this.hasMoreResults()&&(this.pageIndex+=1,this.filter.skipCount=this.pageIndex*this.pageSize,this.filter.maxResultCount=this.pageSize,this.loadStudents(!0))}hasMoreResults(){return this.dataSource.data.length<this.totalCount}static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-student-apply"]],viewQuery:function(o,m){if(1&o&&t.GBs(p,5),2&o){let E;t.mGM(E=t.lsd())&&(m.loadMoreTrigger=E.first)}},decls:34,vars:8,consts:[["input",""],["loadMoreTrigger",""],[1,"row","p-t-25"],[1,"col-12"],["cardTitle","Apply Student List","padding","0"],[1,"p-b-15"],[1,"table-containe","table-reponsive"],[1,"table-search","p-t-15","p-x-15"],["appearance","outline",1,"w-100"],["matInput","","placeholder","\u0627\u0628\u062d\u062b....",3,"keyup"],[1,"table-responsive"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","fullName"],["mat-header-cell","","class","p-l-25",4,"matHeaderCellDef"],["mat-cell","","class","p-l-25 text-nowrap",4,"matCellDef"],["matColumnDef","email"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-nowrap",4,"matCellDef"],["matColumnDef","mobile"],["matColumnDef","nationality"],["matColumnDef","action"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"app-paginator"],[1,"text-muted"],["mat-header-cell","",1,"p-l-25"],["mat-cell","",1,"p-l-25","text-nowrap"],["mat-header-cell",""],["mat-cell","",1,"text-nowrap"],["mat-header-cell","",1,"text-center"],[1,"text-center","text-nowrap"],[1,"list-inline","p-l-0"],["matTooltip","Accept",1,"list-inline-item","m-r-10",3,"click"],["href","javascript:",1,"avatar","avatar-xs","bg-success-50","text-success-500"],[1,"ti","ti-check","f-20"],["matTooltip","Reject",1,"list-inline-item","m-r-10",3,"click"],["href","javascript:",1,"avatar","avatar-xs","bg-warn-50","text-warn-500"],[1,"ti","ti-x","f-20"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","5",1,"mat-cell"]],template:function(o,m){if(1&o){const E=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"app-card",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"mat-form-field",8)(7,"input",9,0),t.bIt("keyup",function(F){return u.eBV(E),u.Njj(m.applyFilter(F))}),t.k0s()()(),t.j41(9,"div",10)(10,"table",11),t.qex(11,12),t.DNE(12,T,2,0,"th",13)(13,U,2,1,"td",14),t.bVm(),t.qex(14,15),t.DNE(15,M,2,0,"th",16)(16,R,2,1,"td",17),t.bVm(),t.qex(17,18),t.DNE(18,L,2,0,"th",16)(19,x,2,1,"td",17),t.bVm(),t.qex(20,19),t.DNE(21,P,2,0,"th",16)(22,A,2,1,"td",17),t.bVm(),t.qex(23,20),t.DNE(24,i,2,0,"th",21)(25,O,9,0,"td",17),t.bVm(),t.DNE(26,y,1,0,"tr",22)(27,D,1,0,"tr",23)(28,k,3,1,"tr",24),t.k0s(),t.j41(29,"div",25,1)(31,"span",26),t.EFF(32),t.nI1(33,"translate"),t.k0s()()()()()()()()}2&o&&(t.R7$(10),t.Y8G("dataSource",m.dataSource),t.R7$(16),t.Y8G("matHeaderRowDef",m.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",m.displayedColumns),t.R7$(2),t.AVh("d-none",!m.hasMoreResults()),t.R7$(3),t.SpI(" ",t.bMT(33,6,m.isLoadingMore?"Loading more...":"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644")," "))},dependencies:[g.G,_.fg,l.j,v.e,r.Zl,r.tL,r.ji,r.cC,r.YV,r.iL,r.KS,r.$R,r.YZ,r.NB,r.ky,e.i,c.D9,h.MD],encapsulation:2})}return a})()},6848:(B,S,n)=>{n.d(S,{_:()=>t,s:()=>_});var u=n(9330),h=n(8728),r=n(6354),g=n(2525),f=n(5366),I=n(8937),C=n(2754);function t(l,v={}){const e=l.data,c=Array.isArray(e)?e:null,p=e&&!Array.isArray(e)?e:{totalCount:c?.length??0,items:c??[]},T=p.items,U=Array.isArray(T)?T:c??[],M=D=>{const k=Number(D);return Number.isFinite(k)?k:void 0},L=[v.skipCount,p.skipCount].map(M).filter(D=>void 0!==D),A=Math.max(0,Math.trunc(L.length>0?L[0]:0))+U.length,O=[p.totalCount,p.total,p.count,p.totalItems,p.totalRecords,l.totalCount,l.total,l.count].map(M).find(D=>void 0!==D),y=void 0!==O?Math.max(Math.trunc(O),A):A;return{...l,data:{...p,items:U,totalCount:y}}}let _=(()=>{class l{constructor(){this.http=(0,h.WQX)(u.Qq),this.auth=(0,h.WQX)(f.k)}getUsersForSelects(e,c,p=0,T=0,U=0,M,R=!1){const x=this.auth.getRole()===I.m.Admin?0:U,P=this.resolveLookupMode(e),A=!P;let i=(new u.Nl).set("UserTypeId",c.toString()).set("managerId",p.toString()).set("teacherId",T.toString()).set("branchId",x.toString());A&&void 0!==e.skipCount&&(i=i.set("SkipCount",e.skipCount.toString())),A&&void 0!==e.maxResultCount&&(i=i.set("MaxResultCount",e.maxResultCount.toString()));const O=e.searchWord??e.searchTerm;e.searchTerm&&(i=i.set("SearchTerm",e.searchTerm)),O&&(i=i.set("SearchWord",O));const y=[];return e.filter&&y.push(e.filter),P&&y.push(`${P}=true`),y.length&&(i=i.set("Filter",y.join("&"))),e.lang&&(i=i.set("Lang",e.lang)),e.sortingDirection&&(i=i.set("SortingDirection",e.sortingDirection)),e.sortBy&&(i=i.set("SortBy",e.sortBy)),M&&M>0&&(i=i.set("residentId",M.toString())),(0,C.a)(e.residentGroup)&&(i=i.set("residentGroup",e.residentGroup)),R&&(i=i.set("includeRelations","true")),this.http.get(`${g.c.apiUrl}/api/UsersForGroups/GetUsersForSelects`,{params:i}).pipe((0,r.T)(D=>t(D,{skipCount:e.skipCount})))}getUserDetails(e){const c=(new u.Nl).set("id",e.toString());return this.http.get(`${g.c.apiUrl}/api/UsersForGroups/GetUserDetails`,{params:c})}resolveLookupMode(e){return e.lookupOnly?"lookupOnly":e.lookup?"lookup":e.idsOnly?"idsOnly":null}getAllNationalities(){return this.http.get(`${g.c.apiUrl}/api/LookUp/GetAllNationality`)}getAllGovernorates(){return this.http.get(`${g.c.apiUrl}/api/LookUp/GetAllGovernorate`)}getSubscribesByTypeId(e,c){let p=new u.Nl;return null!=e&&(p=p.set("id",e.toString())),null!=c&&c>0&&(p=p.set("studentId",c.toString())),this.http.get(`${g.c.apiUrl}/api/LookUp/GetAllSubscribesByTypeId`,{params:p})}static#t=this.\u0275fac=function(c){return new(c||l)};static#e=this.\u0275prov=h.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})()}}]);