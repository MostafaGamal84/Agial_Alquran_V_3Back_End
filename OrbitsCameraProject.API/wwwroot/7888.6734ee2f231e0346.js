"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[7888],{37888:(v,f,l)=>{l.r(f),l.d(f,{CourseParticipantsDialogComponent:()=>M,CoursesViewComponent:()=>dt,DeleteConfirmDialogComponent:()=>T});var r=l(48728),h=l(17705),g=l(38132),u=l(72200),m=l(90645),d=l(96695),c=l(30357),p=l(88834),R=l(56147),x=l(42986),y=l(87509),I=l(75366),C=l(88937),E=l(85972),D=l(11227),t=l(73664),P=l(33746),O=l(5404),$=l(75747),F=l(16735),k=l(68018);const w=()=>[5,10,25,100],V=()=>["/online-course/courses/add"],S=n=>["/online-course/courses/details",n],b=n=>({course:n}),L=n=>["/online-course/courses/edit",n],j=n=>({value:n});function N(n,s){1&n&&(t.j41(0,"div",30)(1,"button",31)(2,"div",32),t.nrm(3,"i",33),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()),2&n&&(t.R7$(),t.Y8G("routerLink",t.lJ4(4,V)),t.R7$(3),t.SpI(" ",t.bMT(5,2,"Add Course")," "))}function B(n,s){1&n&&(t.j41(0,"th",34),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Name")))}function G(n,s){if(1&n&&(t.j41(0,"td",35),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(e.name)}}function A(n,s){1&n&&(t.j41(0,"th",36),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Teacher")))}function U(n,s){if(1&n&&(t.j41(0,"td",37),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.SpI(" ",(null==e.teacher?null:e.teacher.fullName)||e.teacherName||e.teacherId," ")}}function W(n,s){1&n&&(t.j41(0,"th",36),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Schedule")))}function Y(n,s){if(1&n&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&n){const e=s.$implicit,i=t.XpG(3);t.R7$(),t.SpI(" ",i.formatSchedule(e)," ")}}function K(n,s){if(1&n&&(t.qex(0),t.j41(1,"ul",40),t.nI1(2,"translate"),t.DNE(3,Y,2,1,"li",41),t.k0s(),t.bVm()),2&n){const e=t.XpG().$implicit,i=t.XpG();t.R7$(),t.BMQ("aria-label",t.bMT(2,3,"Course schedule")),t.R7$(2),t.Y8G("ngForOf",e.scheduleEntries)("ngForTrackBy",i.trackBySchedule)}}function X(n,s){1&n&&t.EFF(0,"-")}function z(n,s){if(1&n&&(t.j41(0,"td",38),t.DNE(1,K,4,5,"ng-container",39)(2,X,1,0,"ng-template",null,2,t.C5r),t.k0s()),2&n){const e=s.$implicit,i=t.sdS(3);t.R7$(),t.Y8G("ngIf",null==e.scheduleEntries?null:e.scheduleEntries.length)("ngIfElse",i)}}function J(n,s){1&n&&(t.j41(0,"th",42),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Managers")))}function Q(n,s){if(1&n){const e=t.RV6();t.j41(0,"td",43)(1,"button",44),t.nI1(2,"translate"),t.bIt("click",function(){const a=r.eBV(e).$implicit,o=t.XpG();return r.Njj(o.openParticipantsDialog(a,{showStudents:!1}))}),t.nrm(3,"i",45),t.k0s()()}if(2&n){const e=s.$implicit;t.R7$(),t.Y8G("matTooltip",t.bMT(2,2,"View Managers"))("disabled",!(null!=e.managerLabels&&e.managerLabels.length||null!=e.managers&&e.managers.length))}}function H(n,s){1&n&&(t.j41(0,"th",42),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Students")))}function Z(n,s){if(1&n){const e=t.RV6();t.j41(0,"td",43)(1,"button",44),t.nI1(2,"translate"),t.bIt("click",function(){const a=r.eBV(e).$implicit,o=t.XpG();return r.Njj(o.openParticipantsDialog(a,{showManagers:!1}))}),t.nrm(3,"i",46),t.k0s()()}if(2&n){const e=s.$implicit;t.R7$(),t.Y8G("matTooltip",t.bMT(2,2,"View Students"))("disabled",!(null!=e.studentLabels&&e.studentLabels.length||null!=e.students&&e.students.length))}}function q(n,s){1&n&&(t.j41(0,"th",42),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,"Actions")))}function tt(n,s){if(1&n&&(t.j41(0,"li",49),t.nI1(1,"translate"),t.j41(2,"a",50),t.nrm(3,"i",55),t.k0s()()),2&n){const e=t.XpG().$implicit;t.Y8G("matTooltip",t.bMT(1,3,"Edit")),t.R7$(2),t.Y8G("routerLink",t.eq3(5,L,e.id))("state",t.eq3(7,b,e))}}function et(n,s){if(1&n){const e=t.RV6();t.j41(0,"td",37)(1,"div",47)(2,"ul",48)(3,"li",49),t.nI1(4,"translate"),t.j41(5,"a",50),t.nrm(6,"i",51),t.k0s()(),t.DNE(7,tt,4,9,"li",52),t.j41(8,"li",49),t.nI1(9,"translate"),t.j41(10,"a",53),t.bIt("click",function(){const a=r.eBV(e).$implicit,o=t.XpG();return r.Njj(o.deleteCircle(a.id))}),t.nrm(11,"i",54),t.k0s()()()()()}if(2&n){const e=s.$implicit,i=t.XpG();t.R7$(3),t.Y8G("matTooltip",t.bMT(4,5,"View")),t.R7$(2),t.Y8G("routerLink",t.eq3(9,S,e.id))("state",t.eq3(11,b,e)),t.R7$(2),t.Y8G("ngIf",!i.isTeacherOrStudent),t.R7$(),t.Y8G("matTooltip",t.bMT(9,7,"Delete"))}}function nt(n,s){1&n&&t.nrm(0,"tr",56)}function at(n,s){1&n&&t.nrm(0,"tr",57)}function it(n,s){if(1&n&&(t.j41(0,"tr",58)(1,"td",59),t.EFF(2),t.nI1(3,"translate"),t.k0s()()),2&n){t.XpG();const e=t.sdS(11);t.R7$(2),t.SpI(" ",t.i5U(3,1,'No data matching the filter "{{ value }}"',t.eq3(4,j,e.value))," ")}}function st(n,s){if(1&n&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(e)}}function ot(n,s){if(1&n&&(t.qex(0),t.j41(1,"ul"),t.DNE(2,st,2,1,"li",9),t.k0s(),t.bVm()),2&n){const e=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",e.data.managers)}}function lt(n,s){1&n&&(t.j41(0,"p",10),t.EFF(1,"No managers assigned."),t.k0s())}function rt(n,s){if(1&n&&(t.j41(0,"section",7)(1,"h3"),t.EFF(2,"Managers"),t.k0s(),t.DNE(3,ot,3,1,"ng-container",8)(4,lt,2,0,"ng-template",null,0,t.C5r),t.k0s()),2&n){const e=t.sdS(5),i=t.XpG();t.R7$(3),t.Y8G("ngIf",i.data.managers.length)("ngIfElse",e)}}function ct(n,s){if(1&n&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(e)}}function mt(n,s){if(1&n&&(t.qex(0),t.j41(1,"ul"),t.DNE(2,ct,2,1,"li",9),t.k0s(),t.bVm()),2&n){const e=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",e.data.students)}}function ut(n,s){1&n&&(t.j41(0,"p",10),t.EFF(1,"No students enrolled."),t.k0s())}function _t(n,s){if(1&n&&(t.j41(0,"section",7)(1,"h3"),t.EFF(2,"Students"),t.k0s(),t.DNE(3,mt,3,1,"ng-container",8)(4,ut,2,0,"ng-template",null,1,t.C5r),t.k0s()),2&n){const e=t.sdS(5),i=t.XpG();t.R7$(3),t.Y8G("ngIf",i.data.students.length)("ngIfElse",e)}}let dt=(()=>{class n{constructor(){this.circleService=(0,r.WQX)(x.K),this.dialog=(0,r.WQX)(c.h),this.toast=(0,r.WQX)(y.f),this.auth=(0,r.WQX)(I.k),this.displayedColumns=["name","teacher","schedule","managers","students","action"],this.dataSource=new m.I6,this.totalCount=0,this.filter={skipCount:0,maxResultCount:10},this.paginator=h.ebz.required(d.iy),this.isTeacherOrStudent=[C.m.Teacher,C.m.Student].includes(this.auth.getRole())}ngOnInit(){this.loadCircles()}loadCircles(){this.circleService.getAll(this.filter).subscribe(e=>{if(e.isSuccess&&e.data?.items){const a=e.data.items.map(o=>this.buildViewModel(o));this.dataSource.data=a,this.totalCount=e.data.totalCount}else this.dataSource.data=[],this.totalCount=0})}buildViewModel(e){return{...e,scheduleEntries:this.buildScheduleEntries(e),managerLabels:this.buildManagerLabels(e.managers),studentLabels:this.buildStudentLabels(e.students)}}applyFilter(e){this.filter.searchTerm=e.target.value.trim().toLowerCase(),this.filter.skipCount=0,this.paginator()?.firstPage(),this.loadCircles()}ngAfterViewInit(){this.paginator().page.subscribe(()=>{this.filter.skipCount=this.paginator().pageIndex*this.paginator().pageSize,this.filter.maxResultCount=this.paginator().pageSize,this.loadCircles()})}deleteCircle(e){this.dialog.open(T).afterClosed().subscribe(a=>{a&&this.circleService.delete(e).subscribe({next:()=>{this.toast.success("Course deleted successfully"),this.loadCircles()},error:()=>this.toast.error("Error deleting course")})})}openParticipantsDialog(e,{showManagers:i=!0,showStudents:a=!0}={}){!i&&!a||this.dialog.open(M,{width:"480px",data:{name:e.name,managers:i?e.managerLabels??[]:[],students:a?e.studentLabels??[]:[],showManagers:i,showStudents:a}})}buildScheduleEntries(e){if(!e)return[];const i=[];if(Array.isArray(e.days)&&e.days.forEach(a=>{if(!a)return;const o=this.resolveDayLabel(a),_=(0,D.UR)(a.time);(o||_)&&i.push({day:o,time:_})}),!i.length){const a=this.resolveFallbackDay(e),o=(0,D.UR)(e.startTime??e.time);(a||o)&&i.push({day:a,time:o})}return i}resolveDayLabel(e){return"string"==typeof e.dayName&&e.dayName.trim()?e.dayName.trim():(0,E.Lv)(e.dayId)}resolveFallbackDay(e){const i=[e.dayName??void 0,e.dayNames?.[0]??void 0,e.dayId??void 0,e.dayIds?.[0]??void 0,e.day??void 0];for(const a of i){const o=(0,E.Lv)(a);if(o)return o}return""}buildManagerLabels(e){return this.extractManagerLabels(e)}buildStudentLabels(e){return this.extractStudentLabels(e)}formatSchedule(e){const i=e.day?.trim(),a=e.time?.trim();return i&&a?`${i} \u2022 ${a}`:i||a||"-"}extractManagerLabels(e){if(!Array.isArray(e))return[];const i=e.map(a=>{if(null==a)return"";if("string"==typeof a||"number"==typeof a)return String(a).trim();const o=a.manager;if("string"==typeof o)return o.trim();if(o&&"object"==typeof o){const _=o;if(_.fullName&&_.fullName.trim())return _.fullName.trim();if(_.name&&_.name.trim())return _.name.trim()}return a.managerName&&a.managerName.trim()?a.managerName.trim():null!=a.managerId?`#${a.managerId}`:""}).filter(a=>!!a);return Array.from(new Set(i))}extractStudentLabels(e){if(!Array.isArray(e))return[];const i=e.map(a=>{if(!a)return"";if(a.fullName&&a.fullName.trim())return a.fullName.trim();if(a.student){const o=a.student;if(o.fullName&&o.fullName.trim())return o.fullName.trim();if(o.name&&o.name.trim())return o.name.trim()}return null!=a.studentId?`#${a.studentId}`:null!=a.id?`#${a.id}`:""}).filter(a=>!!a);return Array.from(new Set(i))}trackBySchedule(e,i){return`${i.day??""}-${i.time??""}`}trackByLabel(e,i){return i}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-courses-view"]],viewQuery:function(i,a){1&i&&t.wEZ(a.paginator,d.iy,5),2&i&&t.NyB()},decls:38,vars:16,consts:[["headerOptionsTemplate",""],["input",""],["noSchedule",""],[1,"row","p-t-25"],[1,"col-12"],["padding","0","cardClass","sm-block",3,"cardTitle"],[1,"p-b-15"],[1,"table-containe","table-reponsive"],[1,"table-search","p-t-15","p-x-15"],["appearance","outline",1,"w-100"],["matInput","",3,"keyup","placeholder"],[1,"table-responsive"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","class","p-l-25",4,"matHeaderCellDef"],["mat-cell","","class","p-l-25 text-nowrap",4,"matCellDef"],["matColumnDef","teacher"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-nowrap",4,"matCellDef"],["matColumnDef","schedule"],["mat-cell","","class","multi-value-cell",4,"matCellDef"],["matColumnDef","managers"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","students"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"length","pageSize","pageSizeOptions"],[1,"table-options"],["mat-flat-button","","color","primary",3,"routerLink"],[1,"flex","align-item-center"],[1,"ti","ti-plus","f-18","m-r-5"],["mat-header-cell","",1,"p-l-25"],["mat-cell","",1,"p-l-25","text-nowrap"],["mat-header-cell",""],["mat-cell","",1,"text-nowrap"],["mat-cell","",1,"multi-value-cell"],[4,"ngIf","ngIfElse"],[1,"multi-value-list"],[4,"ngFor","ngForOf","ngForTrackBy"],["mat-header-cell","",1,"text-center"],["mat-cell","",1,"text-center"],["type","button",1,"avatar","avatar-xs","text-muted",3,"click","matTooltip","disabled"],[1,"ti","ti-users","f-18"],[1,"ti","ti-user","f-18"],[1,"text-center","text-nowrap"],[1,"list-inline","p-l-0"],[1,"list-inline-item","m-r-10",3,"matTooltip"],[1,"avatar","avatar-xs","text-muted",3,"routerLink","state"],[1,"ti","ti-eye","f-18"],["class","list-inline-item m-r-10",3,"matTooltip",4,"ngIf"],[1,"avatar","avatar-xs","text-muted",3,"click"],[1,"ti","ti-trash","f-18"],[1,"ti","ti-edit-circle","f-18"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","6",1,"mat-cell"]],template:function(i,a){if(1&i){const o=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"app-card",5),t.nI1(3,"translate"),t.DNE(4,N,6,5,"ng-template",null,0,t.C5r),t.j41(6,"div",6)(7,"div",7)(8,"div",8)(9,"mat-form-field",9)(10,"input",10,1),t.nI1(12,"translate"),t.bIt("keyup",function(pt){return r.eBV(o),r.Njj(a.applyFilter(pt))}),t.k0s()()(),t.j41(13,"div",11)(14,"table",12),t.qex(15,13),t.DNE(16,B,3,3,"th",14)(17,G,2,1,"td",15),t.bVm(),t.qex(18,16),t.DNE(19,A,3,3,"th",17)(20,U,2,1,"td",18),t.bVm(),t.qex(21,19),t.DNE(22,W,3,3,"th",17)(23,z,4,2,"td",20),t.bVm(),t.qex(24,21),t.DNE(25,J,3,3,"th",22)(26,Q,4,4,"td",23),t.bVm(),t.qex(27,24),t.DNE(28,H,3,3,"th",22)(29,Z,4,4,"td",23),t.bVm(),t.qex(30,25),t.DNE(31,q,3,3,"th",22)(32,et,12,13,"td",18),t.bVm(),t.DNE(33,nt,1,0,"tr",26)(34,at,1,0,"tr",27)(35,it,4,6,"tr",28),t.k0s(),t.nrm(36,"mat-paginator",29),t.nI1(37,"translate"),t.k0s()()()()()()}2&i&&(t.R7$(2),t.Y8G("cardTitle",t.bMT(3,9,"Courses")),t.R7$(8),t.Y8G("placeholder",t.bMT(12,11,"Search...")),t.R7$(4),t.Y8G("dataSource",a.dataSource),t.R7$(19),t.Y8G("matHeaderRowDef",a.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",a.displayedColumns),t.R7$(2),t.Y8G("length",a.totalCount)("pageSize",a.filter.maxResultCount)("pageSizeOptions",t.lJ4(15,w)),t.BMQ("aria-label",t.bMT(37,13,"Select page of courses")))},dependencies:[R.G,u.Sq,u.bT,p.$z,P.fg,O.j,d.iy,$.e,m.Zl,m.tL,m.ji,m.cC,m.YV,m.iL,m.KS,m.$R,m.YZ,m.NB,m.ky,F.i,k.D9,g.iI,g.Wk],styles:[".courses-card .courses-image{position:relative;line-height:1}  .courses-card .courses-image .courses-type{position:absolute;top:0;right:0;padding:14px 8px}  .courses-card .courses-image .courses-type span{padding:.45em .8em;font-size:12px;font-weight:500;background:var(--accent-50);border-radius:6px}  .courses-card .list-group{padding-left:0;display:flex;flex-direction:column;margin-top:8px;margin-bottom:8px!important}  .courses-card .list-group .list-group-item{padding:8px 0;border-bottom:1px solid var(--accent-300)}  .courses-card .list-group .list-group-item:last-child{border-bottom:none}.multi-value-cell[_ngcontent-%COMP%]{white-space:normal;vertical-align:top}.multi-value-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px;margin:0;padding:0;list-style:none}.multi-value-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 10px;border-radius:999px;background-color:rgba(var(--accent-500-rgb, 96, 93, 255),.12);color:var(--accent-900, #2c2b6f);font-size:.8125rem;line-height:1.25rem;max-width:100%}.multi-value-fallback[_ngcontent-%COMP%]{display:inline-block;max-width:100%;white-space:normal}"]})}return n})(),T=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-delete-confirm-dialog"]],decls:9,vars:1,consts:[[1,"m-b-0","p-10","f-16","f-w-600"],[1,"p-10"],["mat-dialog-actions",""],["mat-button","","mat-dialog-close",""],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(i,a){1&i&&(t.j41(0,"div",0),t.EFF(1,"Delete course"),t.k0s(),t.j41(2,"div",1),t.EFF(3,"Are you sure you want to delete this course?"),t.k0s(),t.j41(4,"div",2)(5,"button",3),t.EFF(6,"No"),t.k0s(),t.j41(7,"button",4),t.EFF(8,"Yes"),t.k0s()()),2&i&&(t.R7$(7),t.Y8G("mat-dialog-close",!0))},dependencies:[c.M,p.$z,c.a],encapsulation:2})}return n})(),M=(()=>{class n{constructor(){this.data=(0,r.WQX)(c.e)}get dialogTitle(){const e=this.data.name?.trim()||"Course";return this.data.showManagers&&!this.data.showStudents?`${e} managers`:this.data.showStudents&&!this.data.showManagers?`${e} students`:`${e} participants`}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-course-participants-dialog"]],decls:8,vars:3,consts:[["noManagers",""],["noStudents",""],["mat-dialog-title",""],["mat-dialog-content","",1,"participants-dialog"],["class","participants-section",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],[1,"participants-section"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[1,"empty-state"]],template:function(i,a){1&i&&(t.j41(0,"div",2),t.EFF(1),t.k0s(),t.j41(2,"div",3),t.DNE(3,rt,6,2,"section",4)(4,_t,6,2,"section",4),t.k0s(),t.j41(5,"div",5)(6,"button",6),t.EFF(7,"Close"),t.k0s()()),2&i&&(t.R7$(),t.JRh(a.dialogTitle),t.R7$(2),t.Y8G("ngIf",a.data.showManagers),t.R7$(),t.Y8G("ngIf",a.data.showStudents))},dependencies:[c.b,c.c,u.bT,u.Sq,c.M,p.$z,c.a],styles:[".participants-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;max-height:60vh;overflow:auto}.participants-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1rem;font-weight:600}.participants-section[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:1.25rem}.participants-section[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.35rem}.empty-state[_ngcontent-%COMP%]{margin:0;color:#0000008a;font-style:italic}"]})}return n})()},87509:(v,f,l)=>{l.d(f,{f:()=>g});var r=l(48728),h=l(95416);let g=(()=>{class u{constructor(){this.snackBar=(0,r.WQX)(h.UG)}success(d,c="Close",p=3e3){this.snackBar.open(d,c,{duration:p,panelClass:["toast-success"]})}error(d,c="Close",p=3e3){this.snackBar.open(d,c,{duration:p,panelClass:["toast-error"]})}static#t=this.\u0275fac=function(c){return new(c||u)};static#e=this.\u0275prov=r.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);