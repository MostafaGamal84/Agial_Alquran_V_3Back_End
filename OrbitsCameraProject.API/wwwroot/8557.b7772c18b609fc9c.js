"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[8557],{4127:(F,E,n)=>{n.d(E,{v:()=>o});var p=n(48728),m=n(56147),O=n(41890),C=n(87509),g=n(4626),t=n(73664),d=n(72200),e=n(59115),s=n(16735);const v=a=>({"background-color":a}),D=(a,i)=>i.label;function _(a,i){1&a&&(t.j41(0,"div",9),t.EFF(1,"No revenue data available."),t.k0s())}function f(a,i){if(1&a&&(t.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13),t.nrm(4,"span",14),t.k0s(),t.j41(5,"div",15)(6,"p",16),t.EFF(7),t.k0s()()(),t.j41(8,"div",3),t.EFF(9),t.j41(10,"span",17),t.EFF(11),t.k0s()()()()),2&a){const r=i.$implicit,h=i.$index,c=t.XpG(2);t.R7$(4),t.Y8G("ngStyle",t.eq3(4,v,c.getSliceColor(h))),t.R7$(3),t.JRh(r.label),t.R7$(2),t.SpI(" ",c.formatValue(r)," "),t.R7$(2),t.JRh(c.formatPercentage(r.percentage))}}function l(a,i){if(1&a&&t.Z7z(0,f,12,6,"div",10,D),2&a){const r=t.XpG();t.Dyx(r.slices)}}let o=(()=>{class a{constructor(){this.dashboardService=(0,p.WQX)(O.I),this.toast=(0,p.WQX)(C.f),this.slices=[],this.incomeColors=["var(--primary-500)","#F97316","#059669","#6366F1"]}ngOnInit(){this.chartOptions=this.createBaseOptions();const{start:r,end:h}=this.getDefaultRange();this.loadRevenueByCurrency(r,h)}formatValue(r){return this.formatCurrency(r.value,r.currencyCode??r.label)}formatPercentage(r){return`${new Intl.NumberFormat(void 0,{minimumFractionDigits:0,maximumFractionDigits:2}).format(r)}%`}loadRevenueByCurrency(r,h){this.dashboardService.getRevenueByCurrency(r,h).subscribe({next:c=>{c.isSuccess&&c.data?this.applySlices(c.data):this.handleError(c.errors,"Failed to load revenue by currency.")},error:()=>this.handleError(void 0,"Failed to load revenue by currency.")})}applySlices(r){this.slices=r.slices??[];const h=this.slices.map(u=>u.value),c=this.slices.map(u=>u.label);this.chartOptions={...this.chartOptions,series:h,labels:c,colors:this.resolveColors(c.length)}}createBaseOptions(){return{chart:{height:320,type:"donut"},series:[],labels:[],colors:this.incomeColors,fill:{opacity:[1,1,1,.3]},legend:{show:!1},plotOptions:{pie:{donut:{size:"65%",labels:{show:!0,name:{show:!0},value:{show:!0,formatter:r=>{const h=Number(r);return Number.isNaN(h)?r:new Intl.NumberFormat(void 0,{maximumFractionDigits:0}).format(h)}}}}}},dataLabels:{enabled:!1},responsive:[{breakpoint:575,options:{chart:{height:250},plotOptions:{pie:{donut:{size:"65%",labels:{show:!1}}}}}}]}}resolveColors(r){if(r<=this.incomeColors.length)return this.incomeColors.slice(0,r);const h=[];for(let c=0;c<r;c+=1)h.push(this.incomeColors[c%this.incomeColors.length]);return h}getDefaultRange(){const r=new Date,h=new Date(r.getFullYear(),r.getMonth(),1);return{start:this.formatDate(h),end:this.formatDate(r)}}formatDate(r){return`${r.getFullYear()}-${`${r.getMonth()+1}`.padStart(2,"0")}-${`${r.getDate()}`.padStart(2,"0")}`}formatCurrency(r,h){try{return new Intl.NumberFormat(void 0,{style:"currency",currency:h,maximumFractionDigits:0}).format(r)}catch{return`${h} ${new Intl.NumberFormat(void 0,{maximumFractionDigits:0}).format(r)}`}}getSliceColor(r){const h=this.chartOptions.colors??this.incomeColors;return h&&0!==h.length?h[r%h.length]:this.incomeColors[r%this.incomeColors.length]}handleError(r,h){const c=r&&r.length>0?r.map(u=>u.message).join("\n"):h;this.toast.error(c)}static#t=this.\u0275fac=function(h){return new(h||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-total-income-chart"]],decls:18,vars:12,consts:[["menu","matMenu"],[3,"showHeader"],[1,"flex","align-item-center","justify-content-between"],[1,"f-16","f-w-600"],[1,"avatar","avatar-s","hover",3,"matMenuTriggerFor"],[1,"ti","ti-dots-vertical","f-18"],["mat-menu-item",""],[3,"series","chart","colors","labels","plotOptions","fill","legend","responsive","dataLabels"],[1,"row","g-3","m-t-15"],[1,"col-12","text-center","text-muted","mat-caption"],[1,"col-sm-6","m-t-15"],[1,"income-value"],[1,"flex","align-item-center","m-b-10"],[1,"flex-shrink-0"],[1,"p-5","block","border-50",3,"ngStyle"],[1,"flex-grow-1","m-l-10"],[1,"m-b-0","f-w-500"],[1,"text-muted","f-w-500"]],template:function(h,c){if(1&h&&(t.j41(0,"app-card",1)(1,"div",2)(2,"div",3),t.EFF(3,"Total Income"),t.k0s(),t.j41(4,"a",4),t.nrm(5,"i",5),t.k0s(),t.j41(6,"mat-menu",null,0)(8,"a",6),t.EFF(9,"Today"),t.k0s(),t.j41(10,"a",6),t.EFF(11,"Weekly"),t.k0s(),t.j41(12,"a",6),t.EFF(13,"Monthly"),t.k0s()()(),t.nrm(14,"apx-chart",7),t.j41(15,"div",8),t.nVh(16,_,2,0,"div",9)(17,l,2,0),t.k0s()()),2&h){const u=t.sdS(7);t.Y8G("showHeader",!1),t.R7$(4),t.Y8G("matMenuTriggerFor",u),t.R7$(10),t.Y8G("series",c.chartOptions.series)("chart",c.chartOptions.chart)("colors",c.chartOptions.colors)("labels",c.chartOptions.labels)("plotOptions",c.chartOptions.plotOptions)("fill",c.chartOptions.fill)("legend",c.chartOptions.legend)("responsive",c.chartOptions.responsive)("dataLabels",c.chartOptions.dataLabels),t.R7$(2),t.vxM(0===c.slices.length?16:17)}},dependencies:[m.G,d.B3,e.kk,e.fb,e.Cp,s.i,g.J,g.Q],styles:[".income-value[_ngcontent-%COMP%]{background:var(--accent-100);padding:16px;border-radius:8px}"]})}return a})()},22975:(F,E,n)=>{n.d(E,{I:()=>D});var p=n(48728),m=n(17705),O=n(23597),C=n(56147),g=n(39928),t=n(4626),d=n(76045),e=n(73664),s=n(59115),v=n(16735);let D=(()=>{class _{constructor(){this.themeService=(0,p.WQX)(g.z),this.styleInput=(0,m.hFB)(),this.iconImage=(0,m.hFB)(),this.headerTitle=(0,m.hFB)(),this.earningValue=(0,m.hFB)(),this.background=(0,m.hFB)(),this.textColor=(0,m.hFB)(),this.percentageValue=(0,m.hFB)(),this.data=(0,m.hFB)(),this.color=(0,m.hFB)(),this.trendColor=(0,m.hFB)(),this.trendIcon=(0,m.hFB)(),(0,O.QZ)(()=>{this.isDarkTheme(this.themeService.isDarkMode())}),(0,O.QZ)(()=>{const l=this.normalizeData(this.data()),o=this.normalizeColors(this.color());this.chartOptions=this.chartOptions?{...this.chartOptions,series:[{data:l}],colors:o}:this.createChartOptions(l,o)})}ngOnInit(){const l=this.normalizeData(this.data()),o=this.normalizeColors(this.color());this.chartOptions=this.createChartOptions(l,o)}isDarkTheme(l){if(!this.chartOptions?.tooltip)return;const o={...this.chartOptions.tooltip};o.theme=l===d.nd?d.nd:d.T,this.chartOptions={...this.chartOptions,tooltip:o}}createChartOptions(l,o){return{chart:{type:"bar",background:"transparent",height:50,sparkline:{enabled:!0}},plotOptions:{bar:{columnWidth:"80%"}},series:[{data:l}],xaxis:{crosshairs:{width:1}},tooltip:{fixed:{enabled:!1},x:{show:!1},y:{title:{formatter:function(){return""}}},marker:{show:!1},theme:d.T},colors:o,theme:{mode:d.T}}}normalizeData(l){return l&&0!==l.length?l:[0]}normalizeColors(l){return l?Array.isArray(l)?l:[l]:["var(--primary-500)"]}static#t=this.\u0275fac=function(o){return new(o||_)};static#e=this.\u0275cmp=e.VBU({type:_,selectors:[["app-earning-chart"]],inputs:{styleInput:[1,"styleInput"],iconImage:[1,"iconImage"],headerTitle:[1,"headerTitle"],earningValue:[1,"earningValue"],background:[1,"background"],textColor:[1,"textColor"],percentageValue:[1,"percentageValue"],data:[1,"data"],color:[1,"color"],trendColor:[1,"trendColor"],trendIcon:[1,"trendIcon"]},decls:30,vars:23,consts:[["menu","matMenu"],[3,"showHeader"],[1,"flex","align-item-center"],[1,"flex-shrink-0"],[1,"pc-icon"],[1,"flex-grow-1","card-head"],[1,"f-w-500"],[1,"avatar","avatar-s","hover",3,"matMenuTriggerFor"],[1,"ti","ti-dots-vertical","f-18"],["mat-menu-item",""],[1,"chart-body"],[1,"m-t-15","row","align-item-center"],[1,"col-7"],["id","chart"],[3,"series","chart","colors","plotOptions","xaxis","theme","tooltip"],[1,"col-5","text-end"],[1,"m-b-5","f-w-600"]],template:function(o,a){if(1&o&&(e.j41(0,"app-card",1)(1,"div",2)(2,"div",3)(3,"div"),p.qSk(),e.j41(4,"svg",4),e.nrm(5,"use"),e.k0s()()(),p.joV(),e.j41(6,"div",5)(7,"div",6),e.EFF(8),e.k0s()(),e.j41(9,"a",7),e.nrm(10,"i",8),e.k0s(),e.j41(11,"mat-menu",null,0)(13,"a",9),e.EFF(14,"Today"),e.k0s(),e.j41(15,"a",9),e.EFF(16,"Weekly"),e.k0s(),e.j41(17,"a",9),e.EFF(18,"Monthly"),e.k0s()()(),e.j41(19,"div",10)(20,"div",11)(21,"div",12)(22,"div",13),e.nrm(23,"apx-chart",14),e.k0s()(),e.j41(24,"div",15)(25,"div",16),e.EFF(26),e.k0s(),e.j41(27,"div"),e.nrm(28,"i"),e.EFF(29),e.k0s()()()()()),2&o){const i=e.sdS(12);e.Y8G("showHeader",!1),e.R7$(3),e.HbH(e.ai1("avatar avatar-s ",a.background()," ",a.textColor())),e.R7$(2),e.BMQ("href",e.VkB("assets/fonts/custom-icon.svg",a.iconImage()),null,"xlink"),e.R7$(3),e.JRh(a.headerTitle()),e.R7$(),e.Y8G("matMenuTriggerFor",i),e.R7$(14),e.Y8G("series",a.chartOptions.series)("chart",a.chartOptions.chart)("colors",a.chartOptions.colors)("plotOptions",a.chartOptions.plotOptions)("xaxis",a.chartOptions.xaxis)("theme",a.chartOptions.theme)("tooltip",a.chartOptions.tooltip),e.R7$(3),e.JRh(a.earningValue()),e.R7$(),e.HbH(e.VkB("",a.trendColor()??a.textColor()," mat-caption f-w-500")),e.R7$(),e.HbH(a.trendIcon()??"ti ti-arrow-up-right"),e.R7$(),e.SpI(" ",a.percentageValue()," ")}},dependencies:[C.G,s.kk,s.fb,s.Cp,v.i,t.J,t.Q],styles:[".chart-body[_ngcontent-%COMP%]{margin-top:16px;padding:16px;border-radius:8px;background:var(--accent-100)}.card-head[_ngcontent-%COMP%]{margin:0 10px}"]})}return _})()},48137:(F,E,n)=>{n.d(E,{O:()=>_});var p=n(48728),m=n(23597),O=n(56147),C=n(39928),g=n(4626),t=n(76045),d=n(41890),e=n(87509),s=n(73664),v=n(59115),D=n(16735);let _=(()=>{class f{constructor(){this.themeService=(0,p.WQX)(C.z),this.dashboardService=(0,p.WQX)(d.I),this.toast=(0,p.WQX)(e.f),this.currentRate=0,this.previousRate=0,this.percentChange=0,this.months=6,(0,m.QZ)(()=>{this.applyTheme(this.themeService.isDarkMode())})}ngOnInit(){this.chartOptions=this.createBaseOptions(),this.loadRepeatCustomers()}get changeBadgeClass(){return this.percentChange>=0?"user-status bg-success-500 text-white":"user-status bg-warn-500 text-white"}get changeText(){const o=new Intl.NumberFormat(void 0,{minimumFractionDigits:0,maximumFractionDigits:2});return`${this.percentChange>0?"+":this.percentChange<0?"\u2212":""}${o.format(Math.abs(this.percentChange))}%`}get currentRateText(){return this.formatPercent(this.currentRate)}get previousRateText(){return this.formatPercent(this.previousRate)}loadRepeatCustomers(){this.dashboardService.getRepeatCustomers(this.months).subscribe({next:o=>{o.isSuccess&&o.data?this.applyRepeatCustomerData(o.data):this.handleError(o.errors,"Failed to load repeat customer data.")},error:()=>this.handleError(void 0,"Failed to load repeat customer data.")})}applyRepeatCustomerData(o){const a=o.chart?.categories??[],i=this.toApexSeries(o.chart?.series);this.chartOptions={...this.chartOptions,series:i,xaxis:{...this.chartOptions.xaxis??{},categories:a,axisBorder:{show:!1},axisTicks:{show:!1}}},this.currentRate=o.currentRate??0,this.previousRate=o.previousRate??0,this.percentChange=o.percentChange??0}toApexSeries(o){return o?o.map(a=>({name:a.name,type:a.type,data:a.data??[]})):[]}createBaseOptions(){return{chart:{type:"line",height:320,background:"transparent",toolbar:{show:!1}},stroke:{curve:"smooth",width:3},dataLabels:{enabled:!1},fill:{type:"gradient",gradient:{shadeIntensity:1,type:"vertical",opacityFrom:.15,opacityTo:0,inverseColors:!1}},series:[],colors:["var(--primary-500)"],grid:{show:!0,borderColor:"#F3F5F7",strokeDashArray:2},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{formatter:o=>`${o}%`}},tooltip:{theme:t.T,y:{formatter:o=>`${o}%`}},theme:{mode:t.T}}}applyTheme(o){if(!this.chartOptions)return;const a={...this.chartOptions.theme},i={...this.chartOptions.tooltip},r=o===t.nd?t.nd:t.T;a&&(a.mode=r),i&&(i.theme=r),this.chartOptions={...this.chartOptions,theme:a,tooltip:i}}formatPercent(o){return`${new Intl.NumberFormat(void 0,{minimumFractionDigits:0,maximumFractionDigits:2}).format(o)}%`}handleError(o,a){const i=o&&o.length>0?o.map(r=>r.message).join("\n"):a;this.toast.error(i)}static#t=this.\u0275fac=function(a){return new(a||f)};static#e=this.\u0275cmp=s.VBU({type:f,selectors:[["app-project-overview-chart"]],decls:23,vars:19,consts:[["menu","matMenu"],[3,"showHeader","padding"],[1,"flex","align-item-center","justify-content-between"],[1,"customer-report","f-16","f-w-600"],[1,"avatar","avatar-s","hover",3,"matMenuTriggerFor"],[1,"ti","ti-dots","f-18"],["mat-menu-item",""],[1,"text-end","m-t-10"],[1,"f-16","f-w-600"],[1,"text-muted","mat-caption","m-b-0"],["id","repeat-customer-chart",1,"m-t-20"],[3,"series","chart","colors","stroke","dataLabels","fill","grid","xaxis","yaxis","tooltip","theme"]],template:function(a,i){if(1&a&&(s.j41(0,"app-card",1)(1,"div",2)(2,"div",3),s.EFF(3,"Repeat customer rate"),s.k0s(),s.j41(4,"a",4),s.nrm(5,"i",5),s.k0s(),s.j41(6,"mat-menu",null,0)(8,"a",6),s.EFF(9,"Today"),s.k0s(),s.j41(10,"a",6),s.EFF(11,"Weekly"),s.k0s(),s.j41(12,"a",6),s.EFF(13,"Monthly"),s.k0s()()(),s.j41(14,"div",7)(15,"div",8),s.EFF(16),s.j41(17,"span"),s.EFF(18),s.k0s()(),s.j41(19,"p",9),s.EFF(20),s.k0s()(),s.j41(21,"div",10),s.nrm(22,"apx-chart",11),s.k0s()()),2&a){const r=s.sdS(7);s.Y8G("showHeader",!1)("padding",20),s.R7$(4),s.Y8G("matMenuTriggerFor",r),s.R7$(12),s.SpI(" ",i.currentRateText," "),s.R7$(),s.HbH(i.changeBadgeClass),s.R7$(),s.JRh(i.changeText),s.R7$(2),s.SpI("Previous month: ",i.previousRateText),s.R7$(2),s.Y8G("series",i.chartOptions.series)("chart",i.chartOptions.chart)("colors",i.chartOptions.colors)("stroke",i.chartOptions.stroke)("dataLabels",i.chartOptions.dataLabels)("fill",i.chartOptions.fill)("grid",i.chartOptions.grid)("xaxis",i.chartOptions.xaxis)("yaxis",i.chartOptions.yaxis)("tooltip",i.chartOptions.tooltip)("theme",i.chartOptions.theme)}},dependencies:[O.G,v.kk,v.fb,v.Cp,D.i,g.J,g.Q],encapsulation:2})}return f})()}}]);