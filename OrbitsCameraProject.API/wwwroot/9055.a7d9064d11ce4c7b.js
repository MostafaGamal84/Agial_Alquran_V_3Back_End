"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[9055],{9055:(Z,_,a)=>{a.r(_),a.d(_,{StudentAddComponent:()=>w});var m=a(8728),u=a(2200),l=a(9417),p=a(9830),I=a(3243),R=a(6053),g=a(2709),T=a(7509),F=a(6848),O=a(3964),P=a(8937),h=a(8223),D=a(6109),f=a(8018),e=a(3664),k=a(8834),S=a(3746),c=a(4507),$=a(3791),y=a(5079),A=a(6735),G=a(3342),j=a(8863);function B(o,i){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Full name is required")))}function W(o,i){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Email is required")))}function N(o,i){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=i.$implicit;e.Y8G("value",t.dialCode),e.R7$(),e.Lme(" ",t.name," (",t.dialCode,") ")}}function L(o,i){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Mobile is required")))}function U(o,i){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=i.$implicit;e.Y8G("value",t.dialCode),e.R7$(),e.Lme(" ",t.name," (",t.dialCode,") ")}}function J(o,i){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Password is required")))}function K(o,i){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=i.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function Y(o,i){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Nationality is required")))}function X(o,i){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=i.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function V(o,i){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Place of residence is required")))}function Q(o,i){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=i.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function H(o,i){if(1&o&&(e.j41(0,"div",4)(1,"mat-form-field",5)(2,"mat-label"),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"mat-select",20),e.nI1(6,"translate"),e.DNE(7,Q,2,2,"mat-option",9),e.k0s()()()),2&o){const t=e.XpG();e.R7$(3),e.JRh(e.bMT(4,3,"Governorate")),e.R7$(2),e.Y8G("placeholder",e.bMT(6,5,"Select Governorate")),e.R7$(2),e.Y8G("ngForOf",t.governorates)}}function x(o,i){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=i.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.label)}}function z(o,i){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Branch is required")))}let w=(()=>{class o{constructor(){this.fb=(0,m.WQX)(l.ok),this.userService=(0,m.WQX)(g.D),this.toast=(0,m.WQX)(T.f),this.lookupService=(0,m.WQX)(F.s),this.countryService=(0,m.WQX)(O.o),this.translate=(0,m.WQX)(f.c$),this.router=(0,m.WQX)(I.Ix),this.submitted=!1,this.nationalities=[],this.governorates=[],this.countries=[],this.showGovernorateSelect=!1,this.Branch=[{id:h.E.Mens,label:"\u0627\u0644\u0631\u062c\u0627\u0644"},{id:h.E.Women,label:"\u0627\u0644\u0646\u0633\u0627\u0621"}],this.phoneFormats={"+1":{mask:"000-000-0000",placeholder:"123-456-7890"},"+44":{mask:"0000 000000",placeholder:"7123 456789"},"+966":{mask:"0000000000",placeholder:"5XXXXXXXXX"}},this.mobileMask="",this.mobilePlaceholder="",this.secondMobileMask="",this.secondMobilePlaceholder=""}ngOnInit(){this.basicInfoForm=this.fb.group({fullName:["",l.k0.required],email:["",[l.k0.required,l.k0.email]],mobileCountryDialCode:[null,l.k0.required],mobile:["",l.k0.required],secondMobileCountryDialCode:[""],secondMobile:[""],passwordHash:["",[l.k0.required,l.k0.minLength(6)]],nationalityId:[null,l.k0.required],residentId:[null,l.k0.required],governorateId:[null],branchId:[null,l.k0.required]}),this.basicInfoForm.get("residentId")?.valueChanges.subscribe(t=>this.updateGovernorateVisibility(t)),this.lookupService.getAllNationalities().subscribe(t=>{t.isSuccess&&(this.nationalities=t.data,this.updateGovernorateVisibility(this.basicInfoForm.get("residentId")?.value))}),this.lookupService.getAllGovernorates().subscribe(t=>{t.isSuccess&&(this.governorates=t.data)}),this.countryService.getCountries().subscribe(t=>{this.countries=t})}updateGovernorateVisibility(t){const s=this.basicInfoForm.get("governorateId");if(!s)return;const n=this.nationalities.find(r=>r.id===Number(t))??null;this.showGovernorateSelect=(0,D.QO)(n),this.showGovernorateSelect||s.setValue(null)}onCountryCodeChange(t){const s=this.basicInfoForm.get(t)?.value,n=this.phoneFormats[s]||{mask:"",placeholder:""};"mobileCountryDialCode"===t?(this.mobileMask=n.mask,this.mobilePlaceholder=n.placeholder):(this.secondMobileMask=n.mask,this.secondMobilePlaceholder=n.placeholder)}onSubmit(){if(this.submitted=!0,this.basicInfoForm.valid){const t=this.basicInfoForm.value,s=r=>r.replace(/\D/g,""),n={fullName:t.fullName,email:t.email,mobile:`${t.mobileCountryDialCode}${s(t.mobile)}`,secondMobile:t.secondMobile?`${t.secondMobileCountryDialCode}${s(t.secondMobile)}`:void 0,passwordHash:t.passwordHash,nationalityId:t.nationalityId,residentId:t.residentId,governorateId:t.governorateId,branchId:t.branchId,userTypeId:Number(P.m.Student)};this.userService.createUser(n).subscribe({next:r=>{r?.isSuccess?(this.toast.success(r.message||this.translate.instant("\u062a\u0645\u062a \u0627\u0644\u0627\u0636\u0627\u0641\u0629 \u0628\u0646\u062c\u0627\u062d")),this.basicInfoForm.reset(),this.submitted=!1):r?.errors?.length?r.errors.forEach(d=>this.toast.error(d.message)):this.toast.error(this.translate.instant("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0627\u0636\u0627\u0641\u0629"))},error:()=>this.toast.error(this.translate.instant("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0627\u0636\u0627\u0641\u0629"))})}else this.basicInfoForm.markAllAsTouched()}static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-student-add"]],features:[e.Jv_([(0,p.Dw)()])],decls:78,vars:67,consts:[[1,"row"],[1,"col-12"],["cardTitle","Basic Information"],[3,"ngSubmit","formGroup"],[1,"col-md-6"],["appearance","outline",1,"w-100","m-b-10"],["matInput","","type","text","formControlName","fullName",3,"placeholder"],["matInput","","type","email","formControlName","email",3,"placeholder"],["formControlName","mobileCountryDialCode","matPrefix","","appOpenSelectOnType","","placeholder","+1",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","text","formControlName","mobile",3,"click","mask","placeholder","dropSpecialCharacters","validation"],["formControlName","secondMobileCountryDialCode","matPrefix","","appOpenSelectOnType","","placeholder","+1",3,"selectionChange"],["matInput","","type","text","formControlName","secondMobile",3,"click","mask","placeholder","dropSpecialCharacters","validation"],["matInput","","type","password","formControlName","passwordHash",3,"placeholder"],["formControlName","nationalityId","appOpenSelectOnType","",3,"placeholder"],["formControlName","residentId","appOpenSelectOnType","",3,"placeholder"],["formControlName","branchId","appOpenSelectOnType","",3,"placeholder"],[1,"col-md-12","text-end"],["mat-flat-button","","color","primary"],[3,"value"],["formControlName","governorateId","appOpenSelectOnType","",3,"placeholder"]],template:function(s,n){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"app-card",2)(3,"form",3),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(4,"div",0)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),e.EFF(8),e.nI1(9,"translate"),e.k0s(),e.nrm(10,"input",6),e.nI1(11,"translate"),e.nVh(12,B,3,3,"mat-error"),e.k0s()(),e.j41(13,"div",4)(14,"mat-form-field",5)(15,"mat-label"),e.EFF(16),e.nI1(17,"translate"),e.k0s(),e.nrm(18,"input",7),e.nI1(19,"translate"),e.nVh(20,W,3,3,"mat-error"),e.k0s()(),e.j41(21,"div",4)(22,"mat-form-field",5)(23,"mat-label"),e.EFF(24),e.nI1(25,"translate"),e.k0s(),e.j41(26,"mat-select",8),e.bIt("selectionChange",function(){return n.onCountryCodeChange("mobileCountryDialCode")}),e.DNE(27,N,2,3,"mat-option",9),e.k0s(),e.j41(28,"input",10),e.bIt("click",function(d){return d.stopPropagation()}),e.k0s(),e.nVh(29,L,3,3,"mat-error"),e.k0s()(),e.j41(30,"div",4)(31,"mat-form-field",5)(32,"mat-label"),e.EFF(33),e.nI1(34,"translate"),e.k0s(),e.j41(35,"mat-select",11),e.bIt("selectionChange",function(){return n.onCountryCodeChange("secondMobileCountryDialCode")}),e.DNE(36,U,2,3,"mat-option",9),e.k0s(),e.j41(37,"input",12),e.bIt("click",function(d){return d.stopPropagation()}),e.k0s()()(),e.j41(38,"div",4)(39,"mat-form-field",5)(40,"mat-label"),e.EFF(41),e.nI1(42,"translate"),e.k0s(),e.nrm(43,"input",13),e.nI1(44,"translate"),e.nVh(45,J,3,3,"mat-error"),e.k0s()(),e.j41(46,"div",4)(47,"mat-form-field",5)(48,"mat-label"),e.EFF(49),e.nI1(50,"translate"),e.k0s(),e.j41(51,"mat-select",14),e.nI1(52,"translate"),e.DNE(53,K,2,2,"mat-option",9),e.k0s(),e.nVh(54,Y,3,3,"mat-error"),e.k0s()(),e.j41(55,"div",4)(56,"mat-form-field",5)(57,"mat-label"),e.EFF(58),e.nI1(59,"translate"),e.k0s(),e.j41(60,"mat-select",15),e.nI1(61,"translate"),e.DNE(62,X,2,2,"mat-option",9),e.k0s(),e.nVh(63,V,3,3,"mat-error"),e.k0s()(),e.nVh(64,H,8,7,"div",4),e.j41(65,"div",4)(66,"mat-form-field",5)(67,"mat-label"),e.EFF(68),e.nI1(69,"translate"),e.k0s(),e.j41(70,"mat-select",16),e.nI1(71,"translate"),e.DNE(72,x,2,2,"mat-option",9),e.k0s(),e.nVh(73,z,3,3,"mat-error"),e.k0s()(),e.j41(74,"div",17)(75,"button",18),e.EFF(76),e.nI1(77,"translate"),e.k0s()()()()()()()),2&s){let r,d,b,C,M,v,E;e.R7$(3),e.Y8G("formGroup",n.basicInfoForm),e.R7$(5),e.JRh(e.bMT(9,37,"Full Name")),e.R7$(2),e.Y8G("placeholder",e.bMT(11,39,"Enter Full Name")),e.R7$(2),e.vxM(n.submitted&&null!=(r=n.basicInfoForm.get("fullName"))&&r.errors?12:-1),e.R7$(4),e.JRh(e.bMT(17,41,"Email")),e.R7$(2),e.Y8G("placeholder",e.bMT(19,43,"Enter Email")),e.R7$(2),e.vxM(n.submitted&&null!=(d=n.basicInfoForm.get("email"))&&d.errors?20:-1),e.R7$(4),e.JRh(e.bMT(25,45,"Mobile")),e.R7$(3),e.Y8G("ngForOf",n.countries),e.R7$(),e.Y8G("mask",n.mobileMask)("placeholder",n.mobilePlaceholder)("dropSpecialCharacters",!1)("validation",!!n.mobileMask),e.R7$(),e.vxM(n.submitted&&null!=(b=n.basicInfoForm.get("mobile"))&&b.errors?29:-1),e.R7$(4),e.JRh(e.bMT(34,47,"Second Mobile")),e.R7$(3),e.Y8G("ngForOf",n.countries),e.R7$(),e.Y8G("mask",n.secondMobileMask)("placeholder",n.secondMobilePlaceholder)("dropSpecialCharacters",!1)("validation",!!n.secondMobileMask),e.R7$(4),e.JRh(e.bMT(42,49,"Password")),e.R7$(2),e.Y8G("placeholder",e.bMT(44,51,"Enter Password")),e.R7$(2),e.vxM(n.submitted&&null!=(C=n.basicInfoForm.get("passwordHash"))&&C.errors?45:-1),e.R7$(4),e.JRh(e.bMT(50,53,"Nationality")),e.R7$(2),e.Y8G("placeholder",e.bMT(52,55,"Select Nationality")),e.R7$(2),e.Y8G("ngForOf",n.nationalities),e.R7$(),e.vxM(n.submitted&&null!=(M=n.basicInfoForm.get("nationalityId"))&&M.errors?54:-1),e.R7$(4),e.JRh(e.bMT(59,57,"Place of residence")),e.R7$(2),e.Y8G("placeholder",e.bMT(61,59,"Select place of residence")),e.R7$(2),e.Y8G("ngForOf",n.nationalities),e.R7$(),e.vxM(n.submitted&&null!=(v=n.basicInfoForm.get("residentId"))&&v.errors?63:-1),e.R7$(),e.vxM(n.showGovernorateSelect?64:-1),e.R7$(4),e.JRh(e.bMT(69,61,"Branch")),e.R7$(2),e.Y8G("placeholder",e.bMT(71,63,"Select Branch")),e.R7$(2),e.Y8G("ngForOf",n.Branch),e.R7$(),e.vxM(n.submitted&&null!=(E=n.basicInfoForm.get("branchId"))&&E.errors?73:-1),e.R7$(3),e.JRh(e.bMT(77,65,"Submit"))}},dependencies:[u.MD,u.Sq,R.G,k.$z,S.fg,c.j,c.M,c.b,c.e,$.g,y.M,l.qT,l.me,l.BC,l.cb,l.j4,l.JD,A.i,G.f,j.m,f.D9,p.Zr],styles:["form[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}form[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-floating-label[_ngcontent-%COMP%]{font-weight:500}.file-upload[_ngcontent-%COMP%]{display:block;border:1px solid var(--accent-300);width:100%;margin-bottom:24px;border-radius:4px;overflow:hidden}.file-upload[_ngcontent-%COMP%]:not(:disabled):not([readonly]){cursor:pointer}.file-upload[_ngcontent-%COMP%]::file-selector-button{padding:.8rem .75rem;margin-right:8px;color:var(--accent-800);pointer-events:none;border-color:var(--accent-300);border-style:solid;border-width:0px;border-inline-end-width:1px;border-radius:0;background:var(--accent-100)}.file-upload[_ngcontent-%COMP%]:hover:not(:disabled):not([readonly])::file-selector-button{background:var(--accent-200)}"]})}return o})()}}]);