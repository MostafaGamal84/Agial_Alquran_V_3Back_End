"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[604,8223,9492],{2709:(W,v,u)=>{u.d(v,{D:()=>A});var d=u(9330),p=u(8728),g=u(8810),_=u(9437),I=u(2525);let A=(()=>{class f{constructor(){this.http=(0,p.WQX)(d.Qq)}createUser(o){return this.http.post(`${I.c.apiUrl}/api/User/Create`,o)}updateUser(o){return this.http.post(`${I.c.apiUrl}/api/User/Update`,o)}disableUser(o,c){const C=(new d.Nl).set("id",o.toString()).set("statue",c.toString());return this.http.get(`${I.c.apiUrl}/api/User/DisableUser`,{params:C})}getProfile(){const c=`${I.c.apiUrl}/api/User/GetProfile`;return this.http.get(`${I.c.apiUrl}/api/User/Profile`).pipe((0,_.W)(C=>{const r=C?.status;return 404===r||405===r?this.http.get(c):(0,g.$)(()=>C)}))}updateProfile(o){return this.http.put(`${I.c.apiUrl}/api/User/Profile`,o)}static#t=this.\u0275fac=function(c){return new(c||f)};static#e=this.\u0275prov=p.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},2754:(W,v,u)=>{u.d(v,{a:()=>p,w:()=>d});const d=[{value:"all",translationKey:"\u0643\u0644 \u0627\u0645\u0627\u0643\u0646 \u0627\u0644\u0627\u0642\u0627\u0645\u0629"},{value:"egyptian",translationKey:"\u0645\u0635\u0631\u064a\u064a\u0646"},{value:"arab",translationKey:"\u0639\u0631\u0628"},{value:"foreign",translationKey:"\u0627\u062c\u0627\u0646\u0628"}];function p(g){return!(!g||"all"===g)}},2986:(W,v,u)=>{u.d(v,{K:()=>A});var d=u(9330),p=u(8728),g=u(6354),_=u(2525),I=u(6848);let A=(()=>{class f{constructor(){this.http=(0,p.WQX)(d.Qq)}create(o){return this.http.post(`${_.c.apiUrl}/api/Circle/Create`,o)}update(o){return this.http.post(`${_.c.apiUrl}/api/Circle/Update`,o)}delete(o){const c=(new d.Nl).set("id",o.toString());return this.http.post(`${_.c.apiUrl}/api/Circle/Delete`,null,{params:c})}get(o){const c=(new d.Nl).set("id",o.toString());return this.http.get(`${_.c.apiUrl}/api/Circle/Get`,{params:c})}getAll(o,c,C){let r=new d.Nl;return void 0!==o.skipCount&&(r=r.set("SkipCount",o.skipCount.toString())),void 0!==o.maxResultCount&&(r=r.set("MaxResultCount",o.maxResultCount.toString())),o.searchTerm&&(r=r.set("SearchTerm",o.searchTerm)),o.filter&&(r=r.set("Filter",o.filter)),o.lang&&(r=r.set("Lang",o.lang)),o.sortingDirection&&(r=r.set("SortingDirection",o.sortingDirection)),o.sortBy&&(r=r.set("SortBy",o.sortBy)),null!=c&&(r=r.set("managerId",c.toString())),null!=C&&(r=r.set("teacherId",C.toString())),this.http.get(`${_.c.apiUrl}/api/Circle/GetResultsByFilter`,{params:r}).pipe((0,g.T)(E=>(0,I._)(E,{skipCount:o.skipCount})))}getUpcoming(o,c,C){let r=new d.Nl;return null!=o&&(r=r.set("managerId",o.toString())),null!=c&&(r=r.set("teacherId",c.toString())),null!=C&&(r=r.set("take",C.toString())),this.http.get(`${_.c.apiUrl}/api/Circle/Upcoming`,{params:r})}static#t=this.\u0275fac=function(c){return new(c||f)};static#e=this.\u0275prov=p.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},6848:(W,v,u)=>{u.d(v,{_:()=>x,s:()=>o});var d=u(9330),p=u(8728),g=u(6354),_=u(2525),I=u(5366),A=u(8937),f=u(2754);function x(c,C={}){const r=c.data,E=Array.isArray(r)?r:null,h=r&&!Array.isArray(r)?r:{totalCount:E?.length??0,items:E??[]},j=h.items,B=Array.isArray(j)?j:E??[],t=T=>{const z=Number(T);return Number.isFinite(z)?z:void 0},G=[C.skipCount,h.skipCount].map(t).filter(T=>void 0!==T),U=Math.max(0,Math.trunc(G.length>0?G[0]:0))+B.length,L=[h.totalCount,h.total,h.count,h.totalItems,h.totalRecords,c.totalCount,c.total,c.count].map(t).find(T=>void 0!==T),S=void 0!==L?Math.max(Math.trunc(L),U):U;return{...c,data:{...h,items:B,totalCount:S}}}let o=(()=>{class c{constructor(){this.http=(0,p.WQX)(d.Qq),this.auth=(0,p.WQX)(I.k)}getUsersForSelects(r,E,h=0,j=0,B=0,t,$=!1){const V=this.auth.getRole()===A.m.Admin?0:B,N=this.resolveLookupMode(r),U=!N;let m=(new d.Nl).set("UserTypeId",E.toString()).set("managerId",h.toString()).set("teacherId",j.toString()).set("branchId",V.toString());U&&void 0!==r.skipCount&&(m=m.set("SkipCount",r.skipCount.toString())),U&&void 0!==r.maxResultCount&&(m=m.set("MaxResultCount",r.maxResultCount.toString()));const L=r.searchWord??r.searchTerm;r.searchTerm&&(m=m.set("SearchTerm",r.searchTerm)),L&&(m=m.set("SearchWord",L));const S=[];return r.filter&&S.push(r.filter),N&&S.push(`${N}=true`),S.length&&(m=m.set("Filter",S.join("&"))),r.lang&&(m=m.set("Lang",r.lang)),r.sortingDirection&&(m=m.set("SortingDirection",r.sortingDirection)),r.sortBy&&(m=m.set("SortBy",r.sortBy)),t&&t>0&&(m=m.set("residentId",t.toString())),(0,f.a)(r.residentGroup)&&(m=m.set("residentGroup",r.residentGroup)),$&&(m=m.set("includeRelations","true")),this.http.get(`${_.c.apiUrl}/api/UsersForGroups/GetUsersForSelects`,{params:m}).pipe((0,g.T)(T=>x(T,{skipCount:r.skipCount})))}getUserDetails(r){const E=(new d.Nl).set("id",r.toString());return this.http.get(`${_.c.apiUrl}/api/UsersForGroups/GetUserDetails`,{params:E})}resolveLookupMode(r){return r.lookupOnly?"lookupOnly":r.lookup?"lookup":r.idsOnly?"idsOnly":null}getAllNationalities(){return this.http.get(`${_.c.apiUrl}/api/LookUp/GetAllNationality`)}getAllGovernorates(){return this.http.get(`${_.c.apiUrl}/api/LookUp/GetAllGovernorate`)}getSubscribesByTypeId(r,E){let h=new d.Nl;return null!=r&&(h=h.set("id",r.toString())),null!=E&&E>0&&(h=h.set("studentId",E.toString())),this.http.get(`${_.c.apiUrl}/api/LookUp/GetAllSubscribesByTypeId`,{params:h})}static#t=this.\u0275fac=function(E){return new(E||c)};static#e=this.\u0275prov=p.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},7509:(W,v,u)=>{u.d(v,{f:()=>g});var d=u(8728),p=u(5416);let g=(()=>{class _{constructor(){this.snackBar=(0,d.WQX)(p.UG)}success(A,f="Close",x=3e3){this.snackBar.open(A,f,{duration:x,panelClass:["toast-success"]})}error(A,f="Close",x=3e3){this.snackBar.open(A,f,{duration:x,panelClass:["toast-error"]})}static#t=this.\u0275fac=function(f){return new(f||_)};static#e=this.\u0275prov=d.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},8223:(W,v,u)=>{u.d(v,{E:()=>d});var d=function(p){return p[p.Mens=1]="Mens",p[p.Women=2]="Women",p}(d||{})},9492:(W,v,u)=>{u.r(v),u.d(v,{CoursesUpdateComponent:()=>Z});var d=u(8728),p=u(2200),g=u(9417),_=u(3243),I=u(6053),A=u(6848),f=u(2986),x=u(7509),o=u(8937),c=u(5366),C=u(5972),r=u(1227),E=u(1413),h=u(6977),j=u(2709),B=u(8223),t=u(3664),$=u(8834),G=u(9010),V=u(1074),N=u(3746),U=u(4507),m=u(5747),L=u(2510),S=u(6735);function T(b,R){1&b&&(t.j41(0,"mat-error"),t.EFF(1," \u0627\u0633\u0645 \u0627\u0644\u062d\u0644\u0642\u0629 \u0645\u0637\u0644\u0648\u0628 "),t.k0s())}function z(b,R){1&b&&(t.j41(0,"div",35),t.EFF(1," \u0627\u0644\u0641\u0631\u0639 \u0645\u0637\u0644\u0648\u0628 "),t.k0s())}function Q(b,R){if(1&b){const e=t.RV6();t.j41(0,"button",45),t.bIt("click",function(){d.eBV(e);const s=t.XpG().index,a=t.XpG();return d.Njj(a.removeDay(s))}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s()()}}function w(b,R){if(1&b){const e=t.RV6();t.j41(0,"button",46),t.bIt("click",function(){d.eBV(e);const s=t.XpG(2);return d.Njj(s.addDay())}),t.j41(1,"mat-icon"),t.EFF(2,"add"),t.k0s()()}}function X(b,R){1&b&&(t.j41(0,"div",35),t.EFF(1," \u0627\u0644\u064a\u0648\u0645 \u0645\u0637\u0644\u0648\u0628 "),t.k0s())}function Y(b,R){1&b&&(t.j41(0,"mat-error"),t.EFF(1," \u0627\u0644\u0648\u0642\u062a \u0645\u0637\u0644\u0648\u0628 "),t.k0s())}function H(b,R){if(1&b&&(t.qex(0),t.j41(1,"div",36)(2,"div",37)(3,"span",38),t.EFF(4),t.k0s(),t.j41(5,"div",39),t.DNE(6,Q,3,0,"button",40)(7,w,3,0,"button",41),t.k0s()(),t.j41(8,"div",42)(9,"div",14)(10,"label",18),t.EFF(11,"\u0627\u0644\u064a\u0648\u0645"),t.k0s(),t.nrm(12,"ng-select",43),t.DNE(13,X,2,0,"div",20),t.k0s(),t.j41(14,"div",14)(15,"mat-form-field",15)(16,"mat-label"),t.EFF(17,"\u0648\u0642\u062a \u0627\u0644\u062d\u0644\u0642\u0629"),t.k0s(),t.nrm(18,"input",44),t.DNE(19,Y,2,0,"mat-error",17),t.k0s()()()(),t.bVm()),2&b){let e,n;const s=R.index,a=t.XpG();t.R7$(),t.Y8G("formGroupName",s),t.R7$(3),t.SpI("\u0645\u0648\u0639\u062f \u0631\u0642\u0645 ",s+1),t.R7$(2),t.Y8G("ngIf",a.daysArray.length>1),t.R7$(),t.Y8G("ngIf",s===a.daysArray.length-1),t.R7$(5),t.Y8G("items",a.days)("searchable",!1)("clearable",!0),t.R7$(),t.Y8G("ngIf",a.submitted&&(null==(e=a.daysArray.at(s).get("dayId"))?null:e.errors)),t.R7$(6),t.Y8G("ngIf",a.submitted&&(null==(n=a.daysArray.at(s).get("startTime"))?null:n.errors))}}function J(b,R){1&b&&(t.j41(0,"div",35),t.EFF(1," \u0627\u0644\u0645\u0639\u0644\u0645 \u0645\u0637\u0644\u0648\u0628 "),t.k0s())}let Z=(()=>{class b{constructor(){this.fb=(0,d.WQX)(g.ok),this.lookup=(0,d.WQX)(A.s),this.circle=(0,d.WQX)(f.K),this.toast=(0,d.WQX)(x.f),this.route=(0,d.WQX)(_.nX),this.auth=(0,d.WQX)(c.k),this.userService=(0,d.WQX)(j.D),this.router=(0,d.WQX)(_.Ix),this.destroy$=new E.B,this.userFilter={lookupOnly:!0},this.teachers=[],this.managers=[],this.students=[],this.isManager=!1,this.currentManagerId=null,this.lastLoadedManagerId=null,this.managerFallback=null,this.days=C.Ep,this.branchOptions=[{id:B.E.Mens,label:"\u0627\u0644\u0631\u062c\u0627\u0644"},{id:B.E.Women,label:"\u0627\u0644\u0646\u0633\u0627\u0621"}],this.submitted=!1}ngOnInit(){this.isManager=this.auth.getRole()===o.m.Manager,this.currentManagerId=this.isManager?this.resolveCurrentManagerId():null,this.circleForm=this.fb.group({name:["",g.k0.required],branchId:[null,g.k0.required],teacherId:[{value:null,disabled:!0},g.k0.required],days:this.fb.array([this.createDayGroup()]),managers:[{value:null!==this.currentManagerId?[this.currentManagerId]:[],disabled:!1}],studentsIds:[{value:[],disabled:!0}]});const e=this.circleForm.get("teacherId"),n=this.circleForm.get("managers");this.managers=this.ensureCurrentManagerPresence([]),null!==this.currentManagerId&&this.applyManagerSelection(n,this.currentManagerId),this.isManager&&this.resolveManagerFromProfile(),n?.valueChanges.pipe((0,h.Q)(this.destroy$)).subscribe(i=>{const l=this.resolvePrimaryId(i);this.loadTeachers(l)}),e?.valueChanges.pipe((0,h.Q)(this.destroy$)).subscribe(i=>{this.loadStudents("number"==typeof i?i:null)});const s=history.state.course;this.lookup.getUsersForSelects(this.userFilter,Number(o.m.Manager)).pipe((0,h.Q)(this.destroy$)).subscribe(i=>{if(i.isSuccess){const l=new Map(this.managers.map(k=>[k.id,k]));(i.data.items??[]).forEach(k=>l.set(k.id,k));const P=Array.from(l.values()),O=this.tryResolveManagerIdentity(P);null!==O&&(this.currentManagerId=O),this.managers=this.ensureCurrentManagerPresence(P),null!==this.currentManagerId&&this.applyManagerSelection(n,this.currentManagerId)}});const a=this.resolvePrimaryId(n?.value);null!==a&&this.lastLoadedManagerId!==a&&this.loadTeachers(a),s?(this.initializeFromCourse(s),this.requiresSupplementalData(s)&&this.circle.get(s.id).pipe((0,h.Q)(this.destroy$)).subscribe(i=>{i.isSuccess&&this.initializeFromCourse(i.data)})):(this.id=Number(this.route.snapshot.paramMap.get("id")),this.id&&this.circle.get(this.id).pipe((0,h.Q)(this.destroy$)).subscribe(i=>{i.isSuccess&&this.initializeFromCourse(i.data)}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}get daysArray(){return this.circleForm.get("days")}addDay(){this.daysArray.push(this.createDayGroup()),this.daysArray.markAsDirty(),this.daysArray.markAsTouched(),this.daysArray.updateValueAndValidity()}removeDay(e){if(this.daysArray.length<=1)return this.daysArray.at(0).reset({dayId:null,startTime:""}),this.daysArray.markAsDirty(),this.daysArray.markAsTouched(),void this.daysArray.updateValueAndValidity();this.daysArray.removeAt(e),this.daysArray.markAsDirty(),this.daysArray.markAsTouched(),this.daysArray.updateValueAndValidity()}trackByIndex(e){return e}initializeFromCourse(e){if(!e)return;this.id=e.id;const n=e.managers?.map(M=>M.manager?M.manager:M)??[];if(n.length){const M=new Map(this.managers.map(D=>[D.id,D]));n.forEach(D=>M.set(D.id,D)),this.managers=this.ensureCurrentManagerPresence(Array.from(M.values()))}else this.managers=this.ensureCurrentManagerPresence(this.managers);const s=this.circleForm.get("managers"),a=this.tryResolveManagerIdentity(this.managers);null!==a&&(this.currentManagerId=a,this.applyManagerSelection(s,this.currentManagerId));const i=e.managers?.map(M=>"number"==typeof M?M:M.managerId).filter(M=>null!=M)??[],l=this.isManager&&null!==this.currentManagerId?[this.currentManagerId]:i,y=this.extractStudentIds(e),P=this.mapStudentsToLookups(e);if(P.length){const M=new Map(this.students.map(D=>[D.id,D]));P.forEach(D=>M.set(D.id,D)),this.students=Array.from(M.values())}const O=e.teacher??null;this.circleForm.patchValue({name:e.name??"",branchId:e.branchId??null},{emitEvent:!1}),this.circleForm.get("managers")?.setValue(l,{emitEvent:!1});const k=this.extractSchedule(e);this.setDays(k);const K=this.resolvePrimaryId(l),F="number"==typeof e.teacherId?e.teacherId:null;this.loadTeachers(K,F,y,O,P),null===K&&null!==F&&this.loadStudents(F,y,P)}requiresSupplementalData(e){if(!e)return!1;if(!this.extractStudentIds(e).length)return!0;const s=this.extractSchedule(e),a=s.some(l=>null!=l.dayId),i=s.some(l=>"string"==typeof l.startTime&&l.startTime.trim().length>0);return!a||!i}loadTeachers(e,n=null,s=[],a,i=[]){const l=this.circleForm.get("teacherId"),y=this.circleForm.get("studentsIds");this.lastLoadedManagerId=e??null;const P=Array.isArray(s)?s:[],O=Array.isArray(i)?i:[],k=a&&"number"==typeof a.id?[a]:[];this.teachers=this.mergeUnique([],k),l?.reset(n??null,{emitEvent:!1}),l?.disable({emitEvent:!1}),this.students=this.mergeUnique([],O);const K=P.filter(F=>this.students.some(M=>M.id===F));y?.reset(K,{emitEvent:!1}),y?.disable({emitEvent:!1}),e&&this.lookup.getUsersForSelects(this.userFilter,Number(o.m.Teacher),e).pipe((0,h.Q)(this.destroy$)).subscribe({next:F=>{F.isSuccess&&(this.teachers=this.mergeUnique(F.data.items??[],k),l?.enable({emitEvent:!1}),null!==n&&(l?.setValue(n,{emitEvent:!1}),this.loadStudents(n,P,O)))},error:()=>{l?.disable({emitEvent:!1})}})}loadStudents(e,n=[],s=[]){const a=this.circleForm.get("studentsIds"),i=Array.isArray(n)?n:[],l=Array.isArray(s)?s:[];this.students=this.mergeUnique([],l);const y=i.filter(P=>this.students.some(O=>O.id===P));a?.reset(y,{emitEvent:!1}),a?.disable({emitEvent:!1}),null!==e&&this.lookup.getUsersForSelects(this.userFilter,Number(o.m.Student),0,e).pipe((0,h.Q)(this.destroy$)).subscribe({next:P=>{if(P.isSuccess){this.students=this.mergeUnique(P.data.items??[],l),a?.enable({emitEvent:!1});const k=i.filter(K=>this.students.some(F=>F.id===K));a?.setValue(k,{emitEvent:!1})}},error:()=>{a?.disable({emitEvent:!1})}})}resolvePrimaryId(e){if(!Array.isArray(e)||!e.length)return null;const n=Number(e[0]);return Number.isFinite(n)?n:null}resolveCurrentManagerId(){const n=this.auth.currentUserValue?.user?.id,s=Number(n);return Number.isFinite(s)&&s>0?s:null}ensureCurrentManagerPresence(e){if(Array.isArray(e)||(e=[]),!this.isManager)return e;const n=this.currentManagerId??this.managerFallback?.id??null;if(null===n||e.some(i=>i?.id===n))return e;const a=this.managerFallback??this.buildManagerFallback(n);return a?[...e,a]:e}buildManagerFallback(e){const n=this.auth.currentUserValue;return n?{id:e,fullName:n.user?.name??"",email:n.user?.email??"",mobile:"",secondMobile:"",nationality:"",nationalityId:0,governorate:"",governorateId:0,branchId:0}:null}tryResolveManagerIdentity(e){if(!this.isManager)return this.currentManagerId;if(null!==this.currentManagerId&&e.some(l=>l?.id===this.currentManagerId))return this.currentManagerId;const n=this.auth.currentUserValue,s=this.normalizeIdentity(n?.user?.email);if(s){const i=e.find(l=>this.normalizeIdentity(l?.email)===s);if(i?.id)return i.id}const a=this.normalizeIdentity(n?.user?.name);if(a){const i=e.find(l=>this.normalizeIdentity(l?.fullName)===a);if(i?.id)return i.id}return this.currentManagerId}normalizeIdentity(e){if("string"!=typeof e)return null;const n=e.trim().toLowerCase();return n.length?n:null}applyManagerSelection(e,n){!e||null===n||(e.setValue([n],{emitEvent:!1}),this.isManager&&e.disable({emitEvent:!1}))}resolveManagerFromProfile(){this.userService.getProfile().pipe((0,h.Q)(this.destroy$)).subscribe(e=>{if(!e.isSuccess||!e.data)return;const n=this.mapProfileToLookup(e.data);if(!n)return;this.managerFallback=n,this.currentManagerId=n.id,this.managers=this.ensureCurrentManagerPresence(this.managers);const s=this.circleForm.get("managers");this.applyManagerSelection(s,this.currentManagerId);const a=this.circleForm.get("teacherId")?.value,i=this.circleForm.get("studentsIds")?.value,l=Array.isArray(i)?i:[],y="number"==typeof a?this.teachers.find(O=>O.id===a)??null:null,P=this.students.filter(O=>l.includes(O.id));this.lastLoadedManagerId!==this.currentManagerId&&this.loadTeachers(this.currentManagerId,"number"==typeof a?a:null,l,y,P)})}mapProfileToLookup(e){if(!e)return null;const n=Number(e.id);return!Number.isFinite(n)||n<=0?null:{id:n,fullName:e.fullName??"",email:e.email??"",mobile:e.mobile??"",secondMobile:e.secondMobile??"",nationality:"",nationalityId:e.nationalityId??0,governorate:"",governorateId:e.governorateId??0,branchId:e.branchId??0}}mergeUnique(e,n){const s=new Map;return e.filter(a=>!!a&&"number"==typeof a.id).forEach(a=>s.set(a.id,a)),n.filter(a=>!!a&&"number"==typeof a.id).forEach(a=>s.set(a.id,a)),Array.from(s.values())}extractStudentIds(e){return e?.students?.map(n=>n.id??n.studentId??n.student?.id).filter(n=>null!=n)??[]}mapStudentsToLookups(e){return e?.students?.length?e.students.map(n=>n.student?n.student:n).filter(n=>!!n&&"number"==typeof n.id):[]}createDayGroup(e){return this.fb.group({dayId:[e?.dayId??null,g.k0.required],startTime:[e?.startTime??"",g.k0.required]})}setDays(e){const n=this.daysArray;for(;n.length;)n.removeAt(n.length-1);e.length?e.forEach(s=>n.push(this.createDayGroup(s))):n.push(this.createDayGroup()),n.markAsPristine(),n.markAsUntouched(),n.updateValueAndValidity()}extractSchedule(e){if(!e)return[];const n=Array.isArray(e.days)&&e.days.length?e.days.map(y=>({dayId:(0,C.lX)(y?.dayId??y?.dayName??void 0)??null,startTime:(0,r.UR)(y?.time)||""})).filter(y=>null!==y.dayId||"string"==typeof y.startTime&&y.startTime.trim().length>0):[];if(n.length)return n;const s=this.resolvePrimaryDay(e),a=(0,C.lX)(s?.dayId??e.dayIds?.[0]??e.dayNames?.[0]??e.dayId??e.day)??null,l=(0,r.UR)(s?.time??e.startTime??e.time).trim();return null!==a||l?[{dayId:a,startTime:l||""}]:[]}resolvePrimaryDay(e){if(e&&Array.isArray(e.days))return e.days.find(n=>!!n)??void 0}onSubmit(){if(this.submitted=!0,this.circleForm.invalid)return void this.circleForm.markAllAsTouched();const e=this.circleForm.getRawValue(),n=Array.isArray(e.days)?e.days.reduce((a,i)=>{const l=(0,C.lX)(i?.dayId??void 0);if(void 0===l)return a;const y=(0,r.C8)(i?.startTime??void 0);return a.push({dayId:l,time:y??null}),a},[]):[];this.circle.update({id:this.id,name:e.name,branchId:e.branchId,teacherId:e.teacherId,days:n.length?n:null,managers:e.managers,studentsIds:e.studentsIds}).subscribe({next:a=>{a.isSuccess?(this.toast.success("\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0628\u0646\u062c\u0627\u062d "),this.router.navigate(["/online-course/courses/view"])):a.errors?.length?a.errors.forEach(i=>this.toast.error(i.message)):this.toast.error("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u062d\u0641\u0638")},error:()=>this.toast.error("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u062d\u0641\u0638")})}static#t=this.\u0275fac=function(n){return new(n||b)};static#e=this.\u0275cmp=t.VBU({type:b,selectors:[["app-courses-update"]],decls:86,vars:21,consts:[[1,"row","justify-content-center"],[1,"col-xl-10","col-lg-11","col-12"],["cardTitle","\u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062d\u0644\u0642\u0629"],[1,"courses-header"],[1,"page-title"],[1,"page-subtitle"],[1,"row","g-3","course-form",3,"ngSubmit","formGroup"],[1,"col-12"],[1,"section-card"],[1,"section-header"],[1,"section-icon"],[1,"section-title"],[1,"section-subtitle"],[1,"row","g-3"],[1,"col-md-6"],["appearance","outline",1,"w-100","course-input"],["matInput","","formControlName","name","placeholder","\u0627\u062f\u062e\u0644 \u0627\u0633\u0645 \u0627\u0644\u062d\u0644\u0642\u0629"],[4,"ngIf"],[1,"form-label","form-label-sm"],["formControlName","branchId","bindLabel","label","bindValue","id","placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u0641\u0631\u0639",1,"w-100",3,"items","searchable","clearable"],["class","text-danger small mt-1",4,"ngIf"],[1,"section-icon","section-icon-blue"],[1,"flex-spacer"],["mat-stroked-button","","type","button",1,"add-day-btn","d-none","d-md-inline-flex",3,"click"],["formArrayName","days",1,"days-wrapper"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-md-none","text-center","mt-2"],["mat-stroked-button","","type","button",1,"add-day-btn",3,"click"],[1,"section-icon","section-icon-green"],[1,"col-md-4"],["formControlName","managers","bindLabel","fullName","bindValue","id","placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u0645\u0634\u0631\u0641\u064a\u0646",1,"w-100",3,"items","multiple","searchable","clearable","disabled"],["formControlName","teacherId","bindLabel","fullName","bindValue","id","placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u0645\u0639\u0644\u0645",1,"w-100",3,"items","searchable","clearable"],["formControlName","studentsIds","bindLabel","fullName","bindValue","id","placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u0637\u0644\u0627\u0628",1,"w-100",3,"items","multiple","searchable","clearable"],[1,"form-actions"],["mat-flat-button","","color","primary","type","submit",1,"submit-btn"],[1,"text-danger","small","mt-1"],[1,"day-card",3,"formGroupName"],[1,"day-card-header"],[1,"day-chip"],[1,"day-actions"],["mat-icon-button","","color","warn","type","button","class","m-r-6","aria-label","\u062d\u0630\u0641 \u0627\u0644\u064a\u0648\u0645","matTooltip","\u062d\u0630\u0641 \u0627\u0644\u064a\u0648\u0645",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","type","button","aria-label","\u0625\u0636\u0627\u0641\u0629 \u064a\u0648\u0645 \u062c\u062f\u064a\u062f","matTooltip","\u0625\u0636\u0627\u0641\u0629 \u064a\u0648\u0645",3,"click",4,"ngIf"],[1,"row","g-3","align-items-center"],["formControlName","dayId","bindLabel","label","bindValue","value","placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u064a\u0648\u0645",1,"w-100",3,"items","searchable","clearable"],["matInput","","type","time","formControlName","startTime","placeholder","\u0627\u062f\u062e\u0644 \u0627\u0644\u0633\u0627\u0639\u0629"],["mat-icon-button","","color","warn","type","button","aria-label","\u062d\u0630\u0641 \u0627\u0644\u064a\u0648\u0645","matTooltip","\u062d\u0630\u0641 \u0627\u0644\u064a\u0648\u0645",1,"m-r-6",3,"click"],["mat-icon-button","","color","primary","type","button","aria-label","\u0625\u0636\u0627\u0641\u0629 \u064a\u0648\u0645 \u062c\u062f\u064a\u062f","matTooltip","\u0625\u0636\u0627\u0641\u0629 \u064a\u0648\u0645",3,"click"]],template:function(n,s){if(1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"app-card",2)(3,"div",3)(4,"h2",4),t.EFF(5,"\u062a\u062d\u062f\u064a\u062b \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062d\u0644\u0642\u0629"),t.k0s(),t.j41(6,"p",5),t.EFF(7," \u0639\u062f\u0651\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062d\u0644\u0642\u0629 \u0648\u062c\u062f\u0648\u0644\u0647\u0627 \u0648\u0627\u0644\u0645\u0634\u0631\u0641 \u0648\u0627\u0644\u0645\u0639\u0644\u0645 \u0648\u0627\u0644\u0637\u0644\u0627\u0628 \u0627\u0644\u0645\u0631\u062a\u0628\u0637\u064a\u0646 \u0628\u0647\u0627. "),t.k0s()(),t.j41(8,"form",6),t.bIt("ngSubmit",function(){return s.onSubmit()}),t.j41(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"mat-icon"),t.EFF(14,"info"),t.k0s()(),t.j41(15,"div")(16,"h5",11),t.EFF(17,"\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062d\u0644\u0642\u0629 \u0627\u0644\u0623\u0633\u0627\u0633\u064a\u0629"),t.k0s(),t.j41(18,"p",12),t.EFF(19," \u0627\u0633\u0645 \u0627\u0644\u062d\u0644\u0642\u0629 \u0648\u0627\u0644\u0641\u0631\u0639 \u0627\u0644\u0630\u064a \u062a\u0646\u062a\u0645\u064a \u0625\u0644\u064a\u0647. "),t.k0s()()(),t.j41(20,"div",13)(21,"div",14)(22,"mat-form-field",15)(23,"mat-label"),t.EFF(24,"\u0627\u0633\u0645 \u0627\u0644\u062d\u0644\u0642\u0629"),t.k0s(),t.nrm(25,"input",16),t.DNE(26,T,2,0,"mat-error",17),t.k0s()(),t.j41(27,"div",14)(28,"label",18),t.EFF(29,"\u0627\u0644\u0641\u0631\u0639"),t.k0s(),t.nrm(30,"ng-select",19),t.DNE(31,z,2,0,"div",20),t.k0s()()()(),t.j41(32,"div",7)(33,"div",8)(34,"div",9)(35,"div",21)(36,"mat-icon"),t.EFF(37,"calendar_today"),t.k0s()(),t.j41(38,"div")(39,"h5",11),t.EFF(40,"\u062c\u062f\u0648\u0644 \u0627\u0644\u062d\u0644\u0642\u0629"),t.k0s(),t.j41(41,"p",12),t.EFF(42," \u062d\u062f\u0651\u062f \u0627\u0644\u0623\u064a\u0627\u0645 \u0648\u0627\u0644\u0623\u0648\u0642\u0627\u062a \u0627\u0644\u062a\u064a \u062a\u064f\u0642\u0627\u0645 \u0641\u064a\u0647\u0627 \u0627\u0644\u062d\u0644\u0642\u0629. "),t.k0s()(),t.nrm(43,"div",22),t.j41(44,"button",23),t.bIt("click",function(){return s.addDay()}),t.j41(45,"mat-icon"),t.EFF(46,"add"),t.k0s(),t.j41(47,"span"),t.EFF(48,"\u0625\u0636\u0627\u0641\u0629 \u064a\u0648\u0645"),t.k0s()()(),t.j41(49,"div",24),t.DNE(50,H,20,9,"ng-container",25),t.j41(51,"div",26)(52,"button",27),t.bIt("click",function(){return s.addDay()}),t.j41(53,"mat-icon"),t.EFF(54,"add"),t.k0s(),t.j41(55,"span"),t.EFF(56,"\u0625\u0636\u0627\u0641\u0629 \u064a\u0648\u0645"),t.k0s()()()()()(),t.j41(57,"div",7)(58,"div",8)(59,"div",9)(60,"div",28)(61,"mat-icon"),t.EFF(62,"groups"),t.k0s()(),t.j41(63,"div")(64,"h5",11),t.EFF(65,"\u0627\u0644\u0645\u0634\u0631\u0641\u060c \u0627\u0644\u0645\u0639\u0644\u0645 \u0648\u0627\u0644\u0637\u0644\u0627\u0628"),t.k0s(),t.j41(66,"p",12),t.EFF(67," \u062d\u062f\u0651\u062f \u0627\u0644\u0645\u0634\u0631\u0641\u064a\u0646 \u0648\u0627\u0644\u0645\u0639\u0644\u0645 \u0627\u0644\u0645\u0633\u0624\u0648\u0644 \u0639\u0646 \u0627\u0644\u062d\u0644\u0642\u0629 \u0648\u0627\u0644\u0637\u0644\u0627\u0628 \u0627\u0644\u0645\u0646\u0636\u0645\u064a\u0646 \u0625\u0644\u064a\u0647\u0627. "),t.k0s()()(),t.j41(68,"div",13)(69,"div",29)(70,"label",18),t.EFF(71,"\u0627\u0644\u0645\u0634\u0631\u0641"),t.k0s(),t.nrm(72,"ng-select",30),t.k0s(),t.j41(73,"div",29)(74,"label",18),t.EFF(75,"\u0627\u0644\u0645\u0639\u0644\u0645"),t.k0s(),t.nrm(76,"ng-select",31),t.DNE(77,J,2,0,"div",20),t.k0s(),t.j41(78,"div",29)(79,"label",18),t.EFF(80,"\u0627\u0644\u0637\u0644\u0627\u0628"),t.k0s(),t.nrm(81,"ng-select",32),t.k0s()()()(),t.j41(82,"div",7)(83,"div",33)(84,"button",34),t.EFF(85," \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062d\u0644\u0642\u0629 "),t.k0s()()()()()()()),2&n){let a,i,l;t.R7$(8),t.Y8G("formGroup",s.circleForm),t.R7$(18),t.Y8G("ngIf",s.submitted&&(null==(a=s.circleForm.get("name"))?null:a.errors)),t.R7$(4),t.Y8G("items",s.branchOptions)("searchable",!1)("clearable",!0),t.R7$(),t.Y8G("ngIf",s.submitted&&(null==(i=s.circleForm.get("branchId"))?null:i.errors)),t.R7$(19),t.Y8G("ngForOf",s.daysArray.controls)("ngForTrackBy",s.trackByIndex),t.R7$(22),t.Y8G("items",s.managers)("multiple",!0)("searchable",!0)("clearable",!0)("disabled",s.isManager),t.R7$(4),t.Y8G("items",s.teachers)("searchable",!0)("clearable",!0),t.R7$(),t.Y8G("ngIf",s.submitted&&(null==(l=s.circleForm.get("teacherId"))?null:l.errors)),t.R7$(4),t.Y8G("items",s.students)("multiple",!0)("searchable",!0)("clearable",!0)}},dependencies:[I.G,p.Sq,p.bT,$.$z,G.M,V.An,N.fg,U.j,U.M,U.b,m.e,g.qT,g.me,g.BC,g.cb,g.j4,g.JD,g.$R,g.v8,L.vr,S.i,p.MD],styles:['@charset "UTF-8";.courses-header[_ngcontent-%COMP%]{padding-bottom:.75rem;margin-bottom:1.25rem;border-bottom:1px solid rgba(15,23,42,.06)}.page-title[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;color:#0f172a;margin-bottom:.35rem}.page-subtitle[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#64748b}[dir=rtl][_ngcontent-%COMP%]   .courses-header[_ngcontent-%COMP%]{text-align:right}.section-card[_ngcontent-%COMP%]{border-radius:18px;background:linear-gradient(135deg,#fff,#f9fafb 40%,#fff);border:1px solid rgba(148,163,184,.25);padding:1.25rem 1.4rem;margin-bottom:.75rem;box-shadow:0 12px 24px #0f172a0f}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1rem}.section-icon[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;background:#3b82f614;color:#2563eb;flex-shrink:0}.section-icon-blue[_ngcontent-%COMP%]{background:#3b82f61a;color:#1d4ed8}.section-icon-green[_ngcontent-%COMP%]{background:#22c55e1a;color:#15803d}.section-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#0f172a;margin:0}.section-subtitle[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;margin:.1rem 0 0}.flex-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.form-label-sm[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#0f172a;margin-bottom:.35rem}.course-form[_ngcontent-%COMP%]{row-gap:1rem}.days-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.day-card[_ngcontent-%COMP%]{border-radius:14px;border:1px dashed rgba(148,163,184,.7);background:#f9fafb;padding:.9rem 1rem;transition:all .2s ease}.day-card[_ngcontent-%COMP%]:hover{border-style:solid;border-color:#3b82f699;box-shadow:0 8px 18px #2563eb1f;transform:translateY(-1px)}.day-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem;gap:.5rem}.day-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.15rem .55rem;border-radius:999px;background:#2563eb0f;color:#1d4ed8;font-size:.8rem;font-weight:600}.day-actions[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.35rem}.add-day-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.35rem;font-size:.85rem;border-radius:999px!important;padding-inline:.9rem!important;padding-block:.2rem!important}.form-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:flex-end;gap:.5rem;margin-top:.25rem}.submit-btn[_ngcontent-%COMP%]{border-radius:999px!important;padding-inline:1.4rem!important;padding-block:.55rem!important;font-weight:600;font-size:.95rem}.text-danger.small[_ngcontent-%COMP%]{font-size:.78rem}[_nghost-%COMP%]     .course-form .ng-select .ng-select-container{min-height:44px;border-radius:8px;border:1px solid rgba(15,23,42,.18);background:#fff;color:#0f172a}[_nghost-%COMP%]     .course-form .ng-select .ng-placeholder{color:#0f172a99}[_nghost-%COMP%]     .course-form .ng-select.ng-select-multiple .ng-select-container{padding:4px 6px}[_nghost-%COMP%]     .course-form .ng-dropdown-panel{border-radius:10px;background:#fff;border:1px solid rgba(15,23,42,.18);color:#0f172a;box-shadow:0 16px 32px #0f172a1f}[_nghost-%COMP%]     .course-form .ng-option{color:#0f172a}[_nghost-%COMP%]     .course-form .ng-option:hover, [_nghost-%COMP%]     .course-form .ng-option.ng-option-marked{background:#3b82f61f}[_nghost-%COMP%]     .course-form .course-input .mdc-text-field--outlined{background:#fff;border-radius:8px}[_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__leading, [_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__notch, [_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__trailing{border-color:#0f172a38}[_nghost-%COMP%]     .course-form .course-input .mat-mdc-input-element{color:#0f172a}.dark[_nghost-%COMP%]   .page-title[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .page-title[_ngcontent-%COMP%]{color:#e5e7eb}.dark[_nghost-%COMP%]   .page-subtitle[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{color:#9ca3af}.dark[_nghost-%COMP%]   .form-label-sm[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .form-label-sm[_ngcontent-%COMP%]{color:#e5e7eb}.dark[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{background:radial-gradient(circle at top,#020617 0% 40%,#020617);border-color:#94a3b873;box-shadow:0 16px 32px #0f172ab3}.dark[_nghost-%COMP%]   .section-title[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .section-title[_ngcontent-%COMP%]{color:#e5e7eb}.dark[_nghost-%COMP%]   .section-subtitle[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#9ca3af}.dark[_nghost-%COMP%]   .day-card[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .day-card[_ngcontent-%COMP%]{background:#0f172ae6;border-color:#94a3b899}.dark[_nghost-%COMP%]   .day-chip[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .day-chip[_ngcontent-%COMP%]{background:#3b82f62e;color:#bfdbfe}.dark[_nghost-%COMP%]     .course-form .ng-select .ng-select-container, .dark   [_nghost-%COMP%]     .course-form .ng-select .ng-select-container{background:#0f172ad9;border-color:#94a3b873;color:#f9fafb}.dark[_nghost-%COMP%]     .course-form .ng-select .ng-placeholder, .dark   [_nghost-%COMP%]     .course-form .ng-select .ng-placeholder{color:#f8fafca6}.dark[_nghost-%COMP%]     .course-form .ng-dropdown-panel, .dark   [_nghost-%COMP%]     .course-form .ng-dropdown-panel{background:#020617;border-color:#94a3b873;color:#f9fafb;box-shadow:0 24px 48px #020617d9}.dark[_nghost-%COMP%]     .course-form .ng-option, .dark   [_nghost-%COMP%]     .course-form .ng-option{color:#f9fafb}.dark[_nghost-%COMP%]     .course-form .ng-option:hover, .dark   [_nghost-%COMP%]     .course-form .ng-option:hover, .dark[_nghost-%COMP%]     .course-form .ng-option.ng-option-marked, .dark   [_nghost-%COMP%]     .course-form .ng-option.ng-option-marked{background:#3b82f640}.dark[_nghost-%COMP%]     .course-form .course-input .mdc-text-field--outlined, .dark   [_nghost-%COMP%]     .course-form .course-input .mdc-text-field--outlined{background:#0f172ad9}.dark[_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__leading, .dark   [_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__leading, .dark[_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__notch, .dark   [_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__notch, .dark[_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__trailing, .dark   [_nghost-%COMP%]     .course-form .course-input .mdc-notched-outline__trailing{border-color:#94a3b88c}.dark[_nghost-%COMP%]     .course-form .course-input .mat-mdc-input-element, .dark   [_nghost-%COMP%]     .course-form .course-input .mat-mdc-input-element, .dark[_nghost-%COMP%]     .course-form .course-input .mdc-floating-label, .dark   [_nghost-%COMP%]     .course-form .course-input .mdc-floating-label{color:#f9fafb}@media (max-width: 768px){.section-card[_ngcontent-%COMP%]{padding:1rem}.section-header[_ngcontent-%COMP%]{align-items:flex-start;flex-direction:row;gap:.6rem}.page-title[_ngcontent-%COMP%]{font-size:1.25rem}.page-subtitle[_ngcontent-%COMP%]{font-size:.85rem}.day-card[_ngcontent-%COMP%]{padding:.8rem .85rem}.form-actions[_ngcontent-%COMP%]{justify-content:center}}']})}return b})()}}]);