"use strict";(self.webpackChunkable_pro=self.webpackChunkable_pro||[]).push([[972],{972:(z,_,n)=>{n.r(_),n.d(_,{BranchManagerAddComponent:()=>x});var d=n(8728),p=n(2200),i=n(9417),h=n(9830),E=n(6053),I=n(2709),F=n(7509),O=n(6848),P=n(8937),D=n(3964),u=n(8223),k=n(6109),f=n(8018),e=n(3664),R=n(8834),T=n(3746),c=n(4507),B=n(3791),y=n(5079),A=n(6735),$=n(3342),S=n(8863);function j(o,r){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Full name is required")))}function N(o,r){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Email is required")))}function G(o,r){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t.dialCode),e.R7$(),e.Lme("",t.name," (",t.dialCode,")")}}function W(o,r){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Mobile is required")))}function L(o,r){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t.dialCode),e.R7$(),e.Lme("",t.name," (",t.dialCode,")")}}function U(o,r){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Password is required")))}function K(o,r){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function X(o,r){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Nationality is required")))}function Y(o,r){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function V(o,r){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Place of residence is required")))}function J(o,r){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function Q(o,r){if(1&o&&(e.j41(0,"div",4)(1,"mat-form-field",5)(2,"mat-label"),e.EFF(3,"Governorate"),e.k0s(),e.j41(4,"mat-select",20),e.DNE(5,J,2,2,"mat-option",9),e.k0s()()()),2&o){const t=e.XpG();e.R7$(5),e.Y8G("ngForOf",t.governorates)}}function H(o,r){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.label)}}function w(o,r){1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"Branch is required")))}let x=(()=>{class o{constructor(){this.fb=(0,d.WQX)(i.ok),this.userService=(0,d.WQX)(I.D),this.toast=(0,d.WQX)(F.f),this.lookupService=(0,d.WQX)(O.s),this.countryService=(0,d.WQX)(D.o),this.translate=(0,d.WQX)(f.c$),this.submitted=!1,this.nationalities=[],this.governorates=[],this.countries=[],this.showGovernorateSelect=!1,this.Branch=[{id:u.E.Mens,label:"\u0627\u0644\u0631\u062c\u0627\u0644"},{id:u.E.Women,label:"\u0627\u0644\u0646\u0633\u0627\u0621"}],this.phoneFormats={"+1":{mask:"000-000-0000",placeholder:"123-456-7890"},"+44":{mask:"0000 000000",placeholder:"7123 456789"},"+966":{mask:"0000000000",placeholder:"5XXXXXXXXX"}},this.mobileMask="",this.mobilePlaceholder="",this.secondMobileMask="",this.secondMobilePlaceholder=""}ngOnInit(){this.basicInfoForm=this.fb.group({fullName:["",i.k0.required],email:["",[i.k0.required,i.k0.email]],mobileCountryDialCode:[null,i.k0.required],mobile:["",i.k0.required],secondMobileCountryDialCode:[""],secondMobile:[""],passwordHash:["",[i.k0.required,i.k0.minLength(6)]],nationalityId:[null,i.k0.required],residentId:[null,i.k0.required],governorateId:[null],branchId:[null,i.k0.required]}),this.basicInfoForm.get("residentId")?.valueChanges.subscribe(t=>this.updateGovernorateVisibility(t)),this.lookupService.getAllNationalities().subscribe(t=>{t.isSuccess&&(this.nationalities=t.data,this.updateGovernorateVisibility(this.basicInfoForm.get("residentId")?.value))}),this.lookupService.getAllGovernorates().subscribe(t=>{t.isSuccess&&(this.governorates=t.data)}),this.countryService.getCountries().subscribe(t=>{this.countries=t})}updateGovernorateVisibility(t){const s=this.basicInfoForm.get("governorateId");if(!s)return;const a=this.nationalities.find(l=>l.id===Number(t))??null;this.showGovernorateSelect=(0,k.QO)(a),this.showGovernorateSelect||s.setValue(null)}onCountryCodeChange(t){const s=this.basicInfoForm.get(t)?.value,a=this.phoneFormats[s]||{mask:"",placeholder:""};"mobileCountryDialCode"===t?(this.mobileMask=a.mask,this.mobilePlaceholder=a.placeholder):(this.secondMobileMask=a.mask,this.secondMobilePlaceholder=a.placeholder)}onSubmit(){if(this.submitted=!0,this.basicInfoForm.valid){const t=this.basicInfoForm.value,s=l=>l.replace(/\D/g,""),a={fullName:t.fullName,email:t.email,mobile:`${t.mobileCountryDialCode}${s(t.mobile)}`,secondMobile:t.secondMobile?`${t.secondMobileCountryDialCode}${s(t.secondMobile)}`:void 0,passwordHash:t.passwordHash,nationalityId:t.nationalityId,residentId:t.residentId,governorateId:t.governorateId,branchId:t.branchId,userTypeId:Number(P.m.BranchLeader)};this.userService.createUser(a).subscribe({next:l=>{l?.isSuccess?(this.toast.success(l.message||this.translate.instant("\u062a\u0645\u062a \u0627\u0644\u0627\u0636\u0627\u0641\u0629 \u0628\u0646\u062c\u0627\u062d")),this.basicInfoForm.reset(),this.submitted=!1):l?.errors?.length?l.errors.forEach(m=>this.toast.error(m.message)):this.toast.error(this.translate.instant("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0627\u0636\u0627\u0641\u0629"))},error:()=>this.toast.error(this.translate.instant("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0627\u0636\u0627\u0641\u0629"))})}else this.basicInfoForm.markAllAsTouched()}static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-branch-manager-add"]],features:[e.Jv_([(0,h.Dw)()])],decls:63,vars:22,consts:[[1,"row"],[1,"col-12"],["cardTitle","Basic Information"],[3,"ngSubmit","formGroup"],[1,"col-md-6"],["appearance","outline",1,"w-100","m-b-10"],["matInput","","type","text","placeholder","Enter Full Name","formControlName","fullName"],["matInput","","type","email","placeholder","Enter Email","formControlName","email"],["formControlName","mobileCountryDialCode","matPrefix","","appOpenSelectOnType","","placeholder","+1",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","text","formControlName","mobile",3,"click","mask","placeholder","dropSpecialCharacters","validation"],["formControlName","secondMobileCountryDialCode","matPrefix","","appOpenSelectOnType","","placeholder","+1",3,"selectionChange"],["matInput","","type","text","formControlName","secondMobile",3,"click","mask","placeholder","dropSpecialCharacters","validation"],["matInput","","type","password","placeholder","Enter Password","formControlName","passwordHash"],["formControlName","nationalityId","placeholder","Select Nationality","appOpenSelectOnType",""],["formControlName","residentId","placeholder","Select place of residence","appOpenSelectOnType",""],["formControlName","branchId","placeholder","Select Branch","appOpenSelectOnType",""],[1,"col-md-12","text-end"],["mat-flat-button","","color","primary"],[3,"value"],["formControlName","governorateId","placeholder","Select Governorate","appOpenSelectOnType",""]],template:function(s,a){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"app-card",2)(3,"form",3),e.bIt("ngSubmit",function(){return a.onSubmit()}),e.j41(4,"div",0)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),e.EFF(8,"Full Name"),e.k0s(),e.nrm(9,"input",6),e.nVh(10,j,3,3,"mat-error"),e.k0s()(),e.j41(11,"div",4)(12,"mat-form-field",5)(13,"mat-label"),e.EFF(14,"Email"),e.k0s(),e.nrm(15,"input",7),e.nVh(16,N,3,3,"mat-error"),e.k0s()(),e.j41(17,"div",4)(18,"mat-form-field",5)(19,"mat-label"),e.EFF(20,"Mobile"),e.k0s(),e.j41(21,"mat-select",8),e.bIt("selectionChange",function(){return a.onCountryCodeChange("mobileCountryDialCode")}),e.DNE(22,G,2,3,"mat-option",9),e.k0s(),e.j41(23,"input",10),e.bIt("click",function(m){return m.stopPropagation()}),e.k0s(),e.nVh(24,W,3,3,"mat-error"),e.k0s()(),e.j41(25,"div",4)(26,"mat-form-field",5)(27,"mat-label"),e.EFF(28,"Second Mobile"),e.k0s(),e.j41(29,"mat-select",11),e.bIt("selectionChange",function(){return a.onCountryCodeChange("secondMobileCountryDialCode")}),e.DNE(30,L,2,3,"mat-option",9),e.k0s(),e.j41(31,"input",12),e.bIt("click",function(m){return m.stopPropagation()}),e.k0s()()(),e.j41(32,"div",4)(33,"mat-form-field",5)(34,"mat-label"),e.EFF(35,"Password"),e.k0s(),e.nrm(36,"input",13),e.nVh(37,U,3,3,"mat-error"),e.k0s()(),e.j41(38,"div",4)(39,"mat-form-field",5)(40,"mat-label"),e.EFF(41,"Nationality"),e.k0s(),e.j41(42,"mat-select",14),e.DNE(43,K,2,2,"mat-option",9),e.k0s(),e.nVh(44,X,3,3,"mat-error"),e.k0s()(),e.j41(45,"div",4)(46,"mat-form-field",5)(47,"mat-label"),e.EFF(48,"Place of residence"),e.k0s(),e.j41(49,"mat-select",15),e.DNE(50,Y,2,2,"mat-option",9),e.k0s(),e.nVh(51,V,3,3,"mat-error"),e.k0s()(),e.nVh(52,Q,6,1,"div",4),e.j41(53,"div",4)(54,"mat-form-field",5)(55,"mat-label"),e.EFF(56,"Branch"),e.k0s(),e.j41(57,"mat-select",16),e.DNE(58,H,2,2,"mat-option",9),e.k0s(),e.nVh(59,w,3,3,"mat-error"),e.k0s()(),e.j41(60,"div",17)(61,"button",18),e.EFF(62,"Submit"),e.k0s()()()()()()()),2&s){let l,m,b,M,C,v,g;e.R7$(3),e.Y8G("formGroup",a.basicInfoForm),e.R7$(7),e.vxM(a.submitted&&null!=(l=a.basicInfoForm.get("fullName"))&&l.errors?10:-1),e.R7$(6),e.vxM(a.submitted&&null!=(m=a.basicInfoForm.get("email"))&&m.errors?16:-1),e.R7$(6),e.Y8G("ngForOf",a.countries),e.R7$(),e.Y8G("mask",a.mobileMask)("placeholder",a.mobilePlaceholder)("dropSpecialCharacters",!1)("validation",!!a.mobileMask),e.R7$(),e.vxM(a.submitted&&null!=(b=a.basicInfoForm.get("mobile"))&&b.errors?24:-1),e.R7$(6),e.Y8G("ngForOf",a.countries),e.R7$(),e.Y8G("mask",a.secondMobileMask)("placeholder",a.secondMobilePlaceholder)("dropSpecialCharacters",!1)("validation",!!a.secondMobileMask),e.R7$(6),e.vxM(a.submitted&&null!=(M=a.basicInfoForm.get("passwordHash"))&&M.errors?37:-1),e.R7$(6),e.Y8G("ngForOf",a.nationalities),e.R7$(),e.vxM(a.submitted&&null!=(C=a.basicInfoForm.get("nationalityId"))&&C.errors?44:-1),e.R7$(6),e.Y8G("ngForOf",a.nationalities),e.R7$(),e.vxM(a.submitted&&null!=(v=a.basicInfoForm.get("residentId"))&&v.errors?51:-1),e.R7$(),e.vxM(a.showGovernorateSelect?52:-1),e.R7$(6),e.Y8G("ngForOf",a.Branch),e.R7$(),e.vxM(a.submitted&&null!=(g=a.basicInfoForm.get("branchId"))&&g.errors?59:-1)}},dependencies:[p.MD,p.Sq,E.G,R.$z,T.fg,c.j,c.M,c.b,c.e,B.g,y.M,i.qT,i.me,i.BC,i.cb,i.j4,i.JD,A.i,$.f,S.m,f.D9,h.Zr],styles:["form[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}form[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-floating-label[_ngcontent-%COMP%]{font-weight:500}.file-upload[_ngcontent-%COMP%]{display:block;border:1px solid var(--accent-300);width:100%;margin-bottom:24px;border-radius:4px;overflow:hidden}.file-upload[_ngcontent-%COMP%]:not(:disabled):not([readonly]){cursor:pointer}.file-upload[_ngcontent-%COMP%]::file-selector-button{padding:.8rem .75rem;margin-right:8px;color:var(--accent-800);pointer-events:none;border-color:var(--accent-300);border-style:solid;border-width:0px;border-inline-end-width:1px;border-radius:0;background:var(--accent-100)}.file-upload[_ngcontent-%COMP%]:hover:not(:disabled):not([readonly])::file-selector-button{background:var(--accent-200)}"]})}return o})()}}]);